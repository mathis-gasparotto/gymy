import{ad as l,ae as m,af as v,ag as e,ah as d,ai as A,aj as i,ak as u,al as S,am as f,an as c,ao as w,ap as h,aq as y,ar as p,as as P,at as D,au as L,av as O,aw as R,ax as _,ay as G,az as E,aA as T}from"./index.1d7fae07.js";async function b(r,s,a,n,U,o={}){await l(a),await m(e,E),await v(e,r.trim(),s.trim()).then(async t=>(d(t.user),o={...o,email:t.user.email,defaultNumberOfSeries:n,restTime:U,lastLoginAt:new Date().toISOString(),active:!1},A(t.user.uid,o,a.trim()).catch(g=>{throw I(t.user.uid),new Error(g.message)}))).catch(t=>{throw new Error(t.message)})}function j(){return i.set(u,S)}async function k(r,s){return await m(e,E),f(e,r,s).then(async a=>{if(a.user.emailVerified)c(w(h,"users/"+a.user.uid),{active:!0});else{try{await d(a.user)}catch{throw new Error("Votre email n'a pas encore \xE9t\xE9 v\xE9rifi\xE9e. Un email de v\xE9rification vous a \xE9t\xE9 d\xE9j\xE0 \xE9t\xE9 envoy\xE9.")}throw new Error("Votre email n'a pas encore \xE9t\xE9 v\xE9rifi\xE9e. Un email de v\xE9rification vous a de nouveau \xE9t\xE9 envoy\xE9.")}return await i.set(u,a.user),await y(),await c(w(h,"users/"+a.user.uid),{lastLoginAt:new Date().toISOString()}).catch(n=>{throw new Error(n.message)}),!0}).catch(a=>{throw new Error(a.message)})}async function x(){return p().uid===P?i.remove(u):D(L).signOut().then(()=>(O.forEach(s=>{i.remove(s)}),!0)).catch(s=>{throw new Error(s.message)})}async function I(){!e.currentUser||(R("users/"+e.currentUser.uid),await _(e.currentUser).catch(r=>{throw new Error(r.message)}))}async function B(r,s){if(!e.currentUser)return;const a=e.currentUser;await f(e,a.email,r),await e.currentUser.reload(),T(a,s)}async function W(r){return await G(e,r)}export{j as a,b,x as c,I as d,k as l,W as s,B as u};
