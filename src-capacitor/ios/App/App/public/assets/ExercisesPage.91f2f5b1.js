import{d as N,f as y,h as U,g as H,d9 as J,da as K,S as k,F as Y,db as X,a as B,o as l,c as x,w as n,b3 as L,$ as d,O as I,K as f,b as s,L as F,Y as _,aP as M,V as h,aN as g,U as Q,a0 as C,R as Z,M as j,a2 as $,a3 as ee,dc as te,aU as oe,b0 as re,dd as se,J as ie,de as le,r as A,a1 as z,N as O,df as ae}from"./index.1d7fae07.js";import{Q as ne}from"./QPageSticky.9d568b4d.js";import{C as T}from"./ClosePopup.e58e1c04.js";import{G as de}from"./GymyHeader.dde444e5.js";import{e as V,s as W}from"./notifyHelper.ce085942.js";import{Q as ue}from"./QForm.aefa9904.js";import{d as ce}from"./vuedraggable.umd.56e4a49c.js";import"./_commonjsHelpers.2cf1d77b.js";var me=N({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,square:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:o}){const t=y(()=>{const v=["unelevated","outline","flat","rounded","square","push","stretch","glossy"].filter(r=>e[r]===!0).map(r=>`q-btn-group--${r}`).join(" ");return`q-btn-group row no-wrap${v.length!==0?" "+v:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>U("div",{class:t.value},H(o.default))}}),fe=N({name:"QBtnToggle",props:{...J,modelValue:{required:!0},options:{type:Array,required:!0,validator:e=>e.every(o=>("label"in o||"icon"in o||"slot"in o)&&"value"in o)},color:String,textColor:String,toggleColor:{type:String,default:"primary"},toggleTextColor:String,outline:Boolean,flat:Boolean,unelevated:Boolean,rounded:Boolean,push:Boolean,glossy:Boolean,size:String,padding:String,noCaps:Boolean,noWrap:Boolean,dense:Boolean,readonly:Boolean,disable:Boolean,stack:Boolean,stretch:Boolean,spread:Boolean,clearable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","clear","click"],setup(e,{slots:o,emit:t}){const v=y(()=>e.options.find(c=>c.value===e.modelValue)!==void 0),r=y(()=>({type:"hidden",name:e.name,value:e.modelValue})),u=X(r),i=y(()=>K(e)),S=y(()=>({rounded:e.rounded,dense:e.dense,...i.value})),q=y(()=>e.options.map((c,b)=>{const{attrs:D,value:w,slot:P,...m}=c;return{slot:P,props:{key:b,"aria-pressed":w===e.modelValue?"true":"false",...D,...m,...S.value,disable:e.disable===!0||m.disable===!0,color:w===e.modelValue?a(m,"toggleColor"):a(m,"color"),textColor:w===e.modelValue?a(m,"toggleTextColor"):a(m,"textColor"),noCaps:a(m,"noCaps")===!0,noWrap:a(m,"noWrap")===!0,size:a(m,"size"),padding:a(m,"padding"),ripple:a(m,"ripple"),stack:a(m,"stack")===!0,stretch:a(m,"stretch")===!0,onClick(G){p(w,c,G)}}}}));function p(c,b,D){e.readonly!==!0&&(e.modelValue===c?e.clearable===!0&&(t("update:modelValue",null,null),t("clear")):t("update:modelValue",c,b),t("click",D))}function a(c,b){return c[b]===void 0?e[b]:c[b]}function E(){const c=q.value.map(b=>U(k,b.props,b.slot!==void 0?o[b.slot]:void 0));return e.name!==void 0&&e.disable!==!0&&v.value===!0&&u(c,"push"),Y(o.default,c)}return()=>U(me,{class:"q-btn-toggle",...i.value,rounded:e.rounded,stretch:e.stretch,glossy:e.glossy,spread:e.spread},E)}});const be={name:"ExerciseForm",emits:["submit"],props:{initData:{type:Object,required:!1},buttonLabel:{type:String,required:!1,default:"Valider"},buttonIcon:{type:String,required:!1,default:void 0},loading:{type:Boolean,required:!1,default:!1},forAbsWorkout:{type:Boolean,required:!1,default:!1}},data(){return{addLoading:!1,exerciseForm:{label:"",config:"",duration:"",forLastSeries:!1,abs:!1,restAbs:!1,isReverse:!1}}},created(){this.initData&&(this.exerciseForm={...this.exerciseForm,...this.initData})},watch:{exerciseForm:{handler(e){this.exerciseForm.duration=parseInt(e.duration)},deep:!0,immediate:!0}},computed:{formValid(){return this.exerciseForm.abs?!0:this.forAbsWorkout?this.exerciseForm.restAbs?this.exerciseForm.duration!=="":this.exerciseForm.label.trim().length>2&&this.exerciseForm.duration:this.exerciseForm.label.trim().length>2}},methods:{onsubmit(){if(!this.formValid)return;const e={...this.exerciseForm,duration:this.exerciseForm.duration?parseInt(this.exerciseForm.duration):null,label:this.exerciseForm.label.trim(),config:this.exerciseForm.config&&this.exerciseForm.config.trim().length>0?this.exerciseForm.config.trim():null};this.$emit("submit",e)}}},xe={key:6,class:"q-mb-xl text-center"},ge=_("div",{class:"q-mb-sm"},"Valeur de progression :",-1);function he(e,o,t,v,r,u){return l(),x(ue,{onSubmit:o[7]||(o[7]=F(i=>u.onsubmit(),["prevent"])),class:"flex-center column"},{default:n(()=>[t.forAbsWorkout?d("",!0):(l(),x(L,{key:0,modelValue:r.exerciseForm.abs,"onUpdate:modelValue":o[0]||(o[0]=i=>r.exerciseForm.abs=i),label:"Abs","checked-icon":"task_alt","unchecked-icon":"highlight_off",class:"q-mb-md"},null,8,["modelValue"])),t.forAbsWorkout?(l(),x(L,{key:1,modelValue:r.exerciseForm.restAbs,"onUpdate:modelValue":o[1]||(o[1]=i=>r.exerciseForm.restAbs=i),label:"Repos","checked-icon":"task_alt","unchecked-icon":"highlight_off",class:"q-mb-md"},null,8,["modelValue"])):d("",!0),(!t.forAbsWorkout||!r.exerciseForm.restAbs)&&!r.exerciseForm.abs?(l(),x(I,{key:2,name:"label",rounded:"",outlined:"",label:"Nom de l'exercice",class:"q-mb-md",type:"text",modelValue:r.exerciseForm.label,"onUpdate:modelValue":o[2]||(o[2]=i=>r.exerciseForm.label=i),"lazy-rules":"",rules:[i=>i.trim().length>2||"Veuillez renseigner minimum 3 caract\xE8res"],"hide-bottom-space":""},null,8,["modelValue","rules"])):d("",!0),r.exerciseForm.restAbs?d("",!0):(l(),x(I,{key:3,name:"config",rounded:"",outlined:"",label:t.forAbsWorkout||r.exerciseForm.abs?"Commentaire":"Config de l'exercice",class:"q-mb-md",type:"text",modelValue:r.exerciseForm.config,"onUpdate:modelValue":o[3]||(o[3]=i=>r.exerciseForm.config=i),"hide-bottom-space":""},null,8,["label","modelValue"])),t.forAbsWorkout?(l(),x(I,{key:4,name:"duration",rounded:"",outlined:"",label:!t.forAbsWorkout||!r.exerciseForm.restAbs?"Dur\xE9e de l'exercice":"Temps de repos",class:"q-mb-md",type:"number",inputmode:"numeric",rules:[i=>i!==""||"Veuillez renseigner une dur\xE9e"],modelValue:r.exerciseForm.duration,"onUpdate:modelValue":o[4]||(o[4]=i=>r.exerciseForm.duration=i),"hide-bottom-space":"",suffix:"s"},null,8,["label","rules","modelValue"])):d("",!0),t.forAbsWorkout?(l(),x(L,{key:5,modelValue:r.exerciseForm.forLastSeries,"onUpdate:modelValue":o[5]||(o[5]=i=>r.exerciseForm.forLastSeries=i),label:"Juste pour la derni\xE8re s\xE9rie","checked-icon":"task_alt","unchecked-icon":"highlight_off",class:"q-mb-md"},null,8,["modelValue"])):d("",!0),!t.forAbsWorkout&&!r.exerciseForm.abs?(l(),f("div",xe,[ge,s(fe,{modelValue:r.exerciseForm.isReverse,"onUpdate:modelValue":o[6]||(o[6]=i=>r.exerciseForm.isReverse=i),"toggle-color":"primary",name:"isReverse","no-caps":"",options:[{label:"Croissante",value:!1},{label:"D\xE9croissante",value:!0}]},null,8,["modelValue"])])):d("",!0),s(k,{color:"primary",label:t.buttonLabel,icon:t.buttonIcon,type:"submit",disable:!u.formValid,loading:t.loading},null,8,["label","icon","disable","loading"])]),_:1})}var ke=B(be,[["render",he]]);const ve={name:"ExerciseCard",emits:["edit","showDeleteModal"],props:{exercise:{type:Object,required:!0},draggable:{type:Boolean,default:!1},drag:{type:Boolean,default:!1},forAbs:{type:Boolean,default:!1}}},R=e=>($("data-v-33cd2883"),e=e(),ee(),e),_e=R(()=>_("div",{class:"text-h6 text-center"}," Abs ",-1)),ye={key:0,class:"text-center"},Fe=R(()=>_("div",{class:"text-h6 text-center"}," Abs ",-1)),Ae={key:0,class:"text-center"},Ve={class:"text-h6 text-center"},pe={key:0,class:"text-center"},Ee={key:1,class:"text-h6 text-center"},we={class:"text-h6 text-center"},Ce={key:1,class:"text-center"},Be={class:"text-h6 text-center"},Se={key:3,class:"draggable-btn-container"};function qe(e,o,t,v,r,u){return l(),x(j,{class:Q(["q-mb-md flex-center column q-px-md",{"cursor-pointer":!t.forAbs}])},{default:n(()=>[t.exercise.abs&&!t.forAbs?(l(),f(M,{key:0},[s(h,{class:"gt-xs"},{default:n(()=>[_e,t.exercise.config?(l(),f("div",ye," ("+g(t.exercise.config)+") ",1)):d("",!0)]),_:1}),s(h,{class:"q-pb-none lt-sm"},{default:n(()=>[Fe,t.exercise.config?(l(),f("div",Ae," ("+g(t.exercise.config)+") ",1)):d("",!0)]),_:1})],64)):(l(),f(M,{key:1},[s(h,{class:"gt-xs"},{default:n(()=>[_("div",Ve,g(t.forAbs&&t.exercise.restAbs?"Repos \u{1F634}":t.exercise.label),1),t.exercise.config&&(!t.forAbs||!t.exercise.restAbs)?(l(),f("div",pe," ("+g(t.exercise.config)+") ",1)):d("",!0),t.exercise.duration&&t.forAbs?(l(),f("div",Ee,g(t.exercise.duration)+"s ",1)):d("",!0)]),_:1}),s(h,{class:"q-pb-none lt-sm"},{default:n(()=>[_("div",we,g(t.forAbs&&t.exercise.restAbs?"Repos \u{1F634}":t.exercise.label),1),t.exercise.config&&(!t.forAbs||!t.exercise.restAbs)?(l(),f("div",{key:0,class:Q(["text-center",{"q-mr-lg":t.exercise.duration&&t.forAbs}])}," ("+g(t.exercise.config)+") ",3)):d("",!0),t.exercise.forLastSeries&&t.forAbs?(l(),f("div",Ce," Finisher ! ")):d("",!0)]),_:1})],64)),t.exercise.duration&&t.forAbs?(l(),x(h,{key:2,class:"lt-sm duration-section q-pa-xs"},{default:n(()=>[_("div",Be,g(t.exercise.duration)+"s ",1)]),_:1})):d("",!0),s(C,{horizontal:"",class:"absolute-right gt-xs no-wrap"},{default:n(()=>[s(k,{flat:"",round:"",color:"primary",icon:"edit",onClick:o[0]||(o[0]=F(i=>e.$emit("edit"),["stop"]))}),s(k,{flat:"",round:"",color:"negative",icon:"delete",onClick:o[1]||(o[1]=F(i=>e.$emit("showDeleteModal"),["stop"]))})]),_:1}),s(C,{horizontal:"",class:"lt-sm no-wrap q-pa-none"},{default:n(()=>[s(k,{flat:"",round:"",color:"primary",icon:"edit",onClick:o[2]||(o[2]=F(i=>e.$emit("edit"),["stop"]))}),s(k,{flat:"",round:"",color:"negative",icon:"delete",onClick:o[3]||(o[3]=F(i=>e.$emit("showDeleteModal"),["stop"]))})]),_:1}),t.draggable?(l(),f("div",Se,[s(Z,{class:Q("draggable-btn "+(t.drag?"cursor-grabbing":"cursor-grab")),size:"sm",name:"menu"},null,8,["class"])])):d("",!0)]),_:1},8,["class"])}var De=B(ve,[["render",qe],["__scopeId","data-v-33cd2883"]]);const Le={name:"ChoiceExercise",emits:["selectExercise"],components:{GymyHeader:de,ExerciseForm:ke,draggable:ce,ExerciseCard:De},props:{workout:{type:Object,required:!0}},data(){return{exercises:[],addForm:!1,addLoading:!1,editForm:!1,editLoading:!1,exerciseToEdit:{},drag:!1}},created(){this.loadExercises()},methods:{onClickExercise(e){!this.workout.isAbs&&!e.abs?this.$emit("selectExercise",e):!this.workout.isAbs&&e.abs&&this.$router.push({name:"abs"})},onDragEnd(e){this.drag=!1;const o=e.newIndex+1;te(this.workout.id,e.item._underlying_vm_.id,o).catch(t=>{V("Une erreur est survenue lors du d\xE9placement de votre exercice"),this.loadExercises()})},loadExercises(){this.exercises=oe(this.workout.id)},onAddSubmit(e){this.addLoading=!0,re(this.workout.id,e).then(()=>{this.loadExercises(),W("Votre exercice a bien \xE9t\xE9 ajout\xE9"),this.addForm=!1,this.addLoading=!1}).catch(o=>{this.addLoading=!1,V("Une erreur est survenue lors de l'ajout de votre exercice")})},onEditSubmit(e){this.editLoading=!0,se(this.workout.id,e.id,e).then(()=>{this.loadExercises(),W("Votre exercice a bien \xE9t\xE9 modifi\xE9"),this.editForm=!1,this.editLoading=!1}).catch(o=>{this.editLoading=!1,V("Une erreur est survenue lors de l'\xE9dition de votre exercice")})},edit(e){this.exerciseToEdit=e,this.editForm=!0},showDeleteModal(e){let o=!1;ie.create({title:"Suppression d'exercice",message:"\xCAtes-vous s\xFBr de vouloir supprimer votre exercice "+e.label+" ?",ok:{label:"Supprimer",color:"negative",loading:o},cancel:{label:"Annuler",color:"primary"}}).onOk(()=>{o=!0,le(this.workout.id,e.id).then(()=>{this.loadExercises(),W("Votre exercice a bien \xE9t\xE9 supprim\xE9")}).catch(t=>{o=!1,V("Une erreur est survenue lors de la suppression de votre exercice")})}).onCancel(()=>{})}}},Ie={class:"flex column"},Qe={key:0},We={key:1,class:"text-center"},Ue={class:"text-h6 text-center"},je=_("div",{class:"text-h6 text-center"},"Ajouter un exercice",-1);function Me(e,o,t,v,r,u){const i=A("GymyHeader"),S=A("ExerciseCard"),q=A("draggable"),p=A("ExerciseForm");return l(),f("div",Ie,[s(i,{text:(t.workout.isAbs?"Abs - ":"Exercices - ")+t.workout.label},null,8,["text"]),r.exercises&&r.exercises.length>0?(l(),f("div",Qe,[s(q,{list:r.exercises,class:"list-group","ghost-class":"ghost",itemKey:"id",handle:".draggable-btn",onEnd:u.onDragEnd,onStart:o[0]||(o[0]=a=>r.drag=!0)},{item:n(({element:a})=>[s(S,{forAbs:t.workout.isAbs,exercise:a,draggable:"",drag:r.drag,onEdit:E=>u.edit(a),onShowDeleteModal:E=>u.showDeleteModal(a),onClick:E=>u.onClickExercise(a)},null,8,["forAbs","exercise","drag","onEdit","onShowDeleteModal","onClick"])]),_:1},8,["list","onEnd"])])):(l(),f("span",We,"Aucun exercice de disponible dans cet entra\xEEnement")),s(O,{modelValue:r.editForm,"onUpdate:modelValue":o[1]||(o[1]=a=>r.editForm=a)},{default:n(()=>[s(j,{class:"q-px-xs q-py-xs"},{default:n(()=>[s(h,null,{default:n(()=>[_("div",Ue,"Modifier l'exercice "+g(r.exerciseToEdit.label),1)]),_:1}),s(h,null,{default:n(()=>[s(p,{initData:r.exerciseToEdit,buttonLabel:"Confirmer",loading:r.editLoading,onSubmit:u.onEditSubmit,"for-abs-workout":t.workout.isAbs},null,8,["initData","loading","onSubmit","for-abs-workout"])]),_:1}),s(C,{align:"center"},{default:n(()=>[z(s(k,{label:"Annuler",color:"negative"},null,512),[[T]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(O,{modelValue:r.addForm,"onUpdate:modelValue":o[2]||(o[2]=a=>r.addForm=a)},{default:n(()=>[s(j,{class:"q-px-xs q-py-xs"},{default:n(()=>[s(h,null,{default:n(()=>[je]),_:1}),s(h,null,{default:n(()=>[s(p,{buttonLabel:"Ajouter",buttonIcon:"add",loading:r.addLoading,onSubmit:u.onAddSubmit,"for-abs-workout":t.workout.isAbs},null,8,["loading","onSubmit","for-abs-workout"])]),_:1}),s(C,{align:"center"},{default:n(()=>[z(s(k,{label:"Annuler",color:"negative"},null,512),[[T]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),s(ne,{position:"bottom-right",offset:[18,18]},{default:n(()=>[s(k,{fab:"",icon:"add",color:"primary",onClick:o[3]||(o[3]=a=>r.addForm=!0)})]),_:1})])}var ze=B(Le,[["render",Me]]);const Oe={name:"ExercisesPage",components:{ChoiceExercise:ze},data(){return{workout:null}},created(){this.loadWorkout()},methods:{loadWorkout(){this.workout=ae(this.$route.params.workoutId),this.workout||(V("Impossible de charger l'entra\xEEnement"),this.$router.push({name:"workouts"}))},selectExercise(e){this.$router.push({name:"performances",params:{workoutId:this.$route.params.workoutId,exerciseId:e.id}})}}};function Te(e,o,t,v,r,u){const i=A("ChoiceExercise");return l(),x(i,{workout:r.workout,onSelectExercise:u.selectExercise},null,8,["workout","onSelectExercise"])}var Xe=B(Oe,[["render",Te]]);export{Xe as default};
