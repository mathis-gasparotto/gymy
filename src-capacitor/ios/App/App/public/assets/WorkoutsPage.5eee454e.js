import{a as F,o as d,c as m,w as a,b as o,O as C,b3 as U,$ as h,S as u,L as f,ar as A,as as P,V as c,Y as b,K as k,U as W,aN as v,a0 as _,R as Q,M as S,a2 as G,a3 as M,b4 as B,b5 as N,aM as z,_ as j,b6 as H,b7 as O,a$ as R,b8 as K,b9 as J,ba as Y,J as X,bb as Z,r as y,aP as $,a1 as V,N as L}from"./index.1d7fae07.js";import{Q as ee}from"./QPageSticky.9d568b4d.js";import{C as T}from"./ClosePopup.e58e1c04.js";import{G as te}from"./GymyHeader.dde444e5.js";import{e as p,s as w}from"./notifyHelper.ce085942.js";import{Q as oe}from"./QForm.aefa9904.js";import{d as re}from"./vuedraggable.umd.56e4a49c.js";import"./_commonjsHelpers.2cf1d77b.js";const ne={name:"WorkoutForm",emits:["submit"],props:{initData:{type:Object,required:!1},buttonLabel:{type:String,required:!1,default:"Valider"},buttonIcon:{type:String,required:!1,default:null},loading:{type:Boolean,required:!1,default:!1}},data(){return{addLoading:!1,workoutForm:{label:"",comment:"",isAbs:!1,restTime:""}}},created(){this.initData&&(this.workoutForm={...this.workoutForm,...this.initData})},watch:{workoutForm:{handler(t){this.workoutForm.restTime=parseInt(t.restTime)},deep:!0,immediate:!0}},computed:{formValid(){return this.workoutForm.label.trim().length>2&&(!this.workoutForm.isAbs||this.workoutForm.restTime)}},methods:{onsubmit(){if(!this.formValid)return;const t={...this.workoutForm,restTime:this.workoutForm.restTime?parseInt(this.workoutForm.restTime):null,label:this.workoutForm.label.trim(),comment:this.workoutForm.comment&&this.workoutForm.comment.trim()!==""?this.workoutForm.comment.trim():null};this.$emit("submit",t)}}};function ae(t,e,n,g,r,s){return d(),m(oe,{onSubmit:e[4]||(e[4]=f(l=>s.onsubmit(),["prevent"])),class:"flex-center column"},{default:a(()=>[o(C,{name:"label",rounded:"",outlined:"",label:"Nom de l'entra\xEEnement",class:"q-mb-md",type:"text",modelValue:r.workoutForm.label,"onUpdate:modelValue":e[0]||(e[0]=l=>r.workoutForm.label=l),"lazy-rules":"",rules:[l=>l.trim().length>2||"Veuillez renseigner minimum 3 caract\xE8res"],"hide-bottom-space":""},null,8,["modelValue","rules"]),o(C,{name:"comment",rounded:"",outlined:"",label:"Commentaire",class:"q-mb-sm",type:"text",modelValue:r.workoutForm.comment,"onUpdate:modelValue":e[1]||(e[1]=l=>r.workoutForm.comment=l),"hide-bottom-space":""},null,8,["modelValue"]),o(U,{modelValue:r.workoutForm.isAbs,"onUpdate:modelValue":e[2]||(e[2]=l=>r.workoutForm.isAbs=l),label:"Entra\xEEnement Abs","checked-icon":"task_alt","unchecked-icon":"highlight_off",class:"q-mb-md"},null,8,["modelValue"]),r.workoutForm.isAbs?(d(),m(C,{key:0,name:"restTime",rounded:"",outlined:"",label:"Temps de repos entre chaque s\xE9rie",class:"q-mb-md",type:"number",inputmode:"numeric",rules:[l=>l!==""||"Veuillez renseigner un temps de repos"],modelValue:r.workoutForm.restTime,"onUpdate:modelValue":e[3]||(e[3]=l=>r.workoutForm.restTime=l),"hide-bottom-space":"",suffix:"s"},null,8,["rules","modelValue"])):h("",!0),n.buttonIcon?(d(),m(u,{key:1,color:"primary",label:n.buttonLabel,icon:n.buttonIcon,type:"submit",disable:!s.formValid,loading:n.loading},null,8,["label","icon","disable","loading"])):(d(),m(u,{key:2,color:"primary",label:n.buttonLabel,type:"submit",disable:!s.formValid,loading:n.loading},null,8,["label","disable","loading"]))]),_:1})}var le=F(ne,[["render",ae]]),E="assets/picto-abs.4dd0af4a.png";const se={name:"WorkoutCard",emits:["share","edit","showDeleteModal"],props:{workout:{type:Object,required:!0},draggable:{type:Boolean,default:!1},drag:{type:Boolean,default:!1}},computed:{isGuestUser(){return A().uid===P}}},ie=t=>(G("data-v-78032800"),t=t(),M(),t),de={class:"q-mr-lg flex flex-cente"},ue={key:0,src:E,width:"40px"},me={class:"text-h6 text-center flex flex-center"},ce={key:0,class:"text-center"},ge={class:"text-h6 text-center"},he=ie(()=>b("img",{src:E,width:"50px"},null,-1)),be={key:1,class:"draggable-btn-container"};function ke(t,e,n,g,r,s){return d(),m(S,{class:"cursor-pointer q-mb-md flex-center column q-px-md"},{default:a(()=>[o(c,{class:"gt-sm flex flex-center"},{default:a(()=>[b("div",de,[n.workout.isAbs?(d(),k("img",ue)):h("",!0)]),b("div",{class:W({"title-container":n.workout.isAbs})},[b("div",me,v(n.workout.label),1),n.workout.comment?(d(),k("div",ce,v(n.workout.comment),1)):h("",!0)],2)]),_:1}),o(c,{class:"q-pb-none lt-md"},{default:a(()=>[b("div",ge,v(n.workout.label),1),n.workout.comment?(d(),k("div",{key:0,class:W(["text-center",{"q-mr-lg":n.workout.isAbs}])},v(n.workout.comment),3)):h("",!0)]),_:1}),n.workout.isAbs?(d(),m(c,{key:0,class:"lt-md abs-indicator-section q-pa-none"},{default:a(()=>[he]),_:1})):h("",!0),o(_,{horizontal:"",class:"absolute-right gt-sm no-wrap"},{default:a(()=>[s.isGuestUser?h("",!0):(d(),m(u,{key:0,flat:"",round:"",color:"secondary",icon:"share",onClick:e[0]||(e[0]=f(l=>t.$emit("share"),["stop"]))})),o(u,{flat:"",round:"",color:"primary",icon:"edit",onClick:e[1]||(e[1]=f(l=>t.$emit("edit"),["stop"]))}),o(u,{flat:"",round:"",color:"negative",icon:"delete",onClick:e[2]||(e[2]=f(l=>t.$emit("showDeleteModal"),["stop"]))})]),_:1}),o(_,{horizontal:"",class:"lt-md no-wrap q-pa-none"},{default:a(()=>[s.isGuestUser?h("",!0):(d(),m(u,{key:0,flat:"",round:"",color:"secondary",icon:"share",onClick:e[3]||(e[3]=f(l=>t.$emit("share"),["stop"]))})),o(u,{flat:"",round:"",color:"primary",icon:"edit",onClick:e[4]||(e[4]=f(l=>t.$emit("edit"),["stop"]))}),o(u,{flat:"",round:"",color:"negative",icon:"delete",onClick:e[5]||(e[5]=f(l=>t.$emit("showDeleteModal"),["stop"]))})]),_:1}),n.draggable?(d(),k("div",be,[o(Q,{class:W("draggable-btn "+(n.drag?"cursor-grabbing":"cursor-grab")),size:"sm",name:"menu"},null,8,["class"])])):h("",!0)]),_:1})}var fe=F(se,[["render",ke],["__scopeId","data-v-78032800"]]);function pe(t){const e=document.createElement("textarea");e.value=t,e.contentEditable="true",e.style.position="fixed";const n=()=>{};B(n),document.body.appendChild(e),e.focus(),e.select();const g=document.execCommand("copy");return e.remove(),N(n),g}function ve(t){return navigator.clipboard!==void 0?navigator.clipboard.writeText(t):new Promise((e,n)=>{const g=pe(t);g?e(!0):n(g)})}const we=z("Share",{web:()=>j(()=>import("./web.3b6411ad.js"),["assets/web.3b6411ad.js","assets/index.1d7fae07.js","assets/index.b9072372.css"]).then(t=>new t.ShareWeb)}),ye={name:"ChoiceWorkout",emits:["selectWorkout"],components:{GymyHeader:te,WorkoutForm:le,draggable:re,WorkoutCard:fe},data(){return{drag:!1,workouts:{},addForm:!1,addLoading:!1,editForm:!1,editLoading:!1,workoutToEdit:{},workoutToShare:{},shareForm:!1,generatingShareLoading:!1,cancelShareLoading:!1}},created(){this.loadWorkouts()},methods:{onDragEnd(t){this.drag=!1;const e=t.newIndex+1;H(t.item._underlying_vm_.id,e).catch(n=>{p("Une erreur est survenue lors du d\xE9placement de votre entra\xEEnement"),this.loadWorkouts()})},loadWorkouts(){this.workouts=O()},onAddSubmit(t){this.addLoading=!0,R(t).then(()=>{this.loadWorkouts(),w("Votre entra\xEEnement a bien \xE9t\xE9 ajout\xE9"),this.addForm=!1,this.addLoading=!1}).catch(e=>{this.addLoading=!1,p("Une erreur est survenue lors de l'ajout de votre entra\xEEnement")})},onEditSubmit(t){this.editLoading=!0,K(t.id,t).then(()=>{this.loadWorkouts(),w("Votre entra\xEEnement a bien \xE9t\xE9 modifi\xE9"),this.editForm=!1,this.editLoading=!1,this.workoutToEdit={}}).catch(e=>{this.editLoading=!1,p("Une erreur est survenue lors de l'\xE9dition de votre entra\xEEnement")})},shareBtn(t){we.share({title:"Partage d'un entra\xEEnement sur Gymy",text:'Essaie mon entra\xEEnement "'+t.label.trim()+'" sur Gymy !',url:"https://gymy-f709a.web.app/share/"+t.shareId,dialogTitle:"Partage de l'entra\xEEnement"})},cancelShare(t){this.cancelShareLoading=!0,J(t.id).then(()=>{t.shareId=null,this.loadWorkouts(),w("Le partage de votre entra\xEEnement a bien \xE9t\xE9 d\xE9sactiv\xE9"),this.cancelShareLoading=!1}).catch(e=>{this.cancelShareLoading=!1,p("Une erreur est survenue lors de la d\xE9sactivation du partage de votre entra\xEEnement")})},generateShareId(t){this.generatingShareLoading=!0,Y(t.id).then(({shareId:e})=>{t.shareId=e,this.loadWorkouts(),ve("https://gymy-f709a.web.app/share/"+e).then(()=>{w("Le lien de partage a \xE9t\xE9 copi\xE9"),this.generatingShareLoading=!1})}).catch(e=>{this.generatingShareLoading=!1,p("Une erreur est survenue lors de la g\xE9n\xE9ration du code de partage")})},edit(t){this.workoutToEdit={...t},this.editForm=!0},share(t){this.workoutToShare={...t},this.shareForm=!0},showDeleteModal(t){let e=!1;X.create({title:"Suppression d'entra\xEEnement",message:"\xCAtes-vous s\xFBr de vouloir supprimer votre entra\xEEnement "+t.label+" ?",ok:{label:"Supprimer",color:"negative",loading:e},cancel:{label:"Annuler",color:"primary"}}).onOk(()=>{e=!0,Z(t.id).then(()=>{this.loadWorkouts(),w("Votre entra\xEEnement a bien \xE9t\xE9 supprim\xE9")}).catch(n=>{e=!1,p("Une erreur est survenue lors de la suppression de votre entra\xEEnement")})}).onCancel(()=>{})}}},_e={class:"flex column"},Se={key:0},Fe={key:1,class:"text-center"},xe={class:"text-h6 text-center"},Ce={class:"text-h6 text-center"},We=b("div",{class:"text-h6 text-center"},"Ajouter un entra\xEEnement",-1);function Ve(t,e,n,g,r,s){const l=y("GymyHeader"),D=y("WorkoutCard"),I=y("draggable"),q=y("WorkoutForm");return d(),k("div",_e,[o(l,{text:"Entra\xEEnements"}),r.workouts&&r.workouts.length>0?(d(),k("div",Se,[o(I,{list:r.workouts,class:"list-group","ghost-class":"ghost",itemKey:"id",handle:".draggable-btn",onEnd:s.onDragEnd,onStart:e[0]||(e[0]=i=>r.drag=!0)},{item:a(({element:i})=>[o(D,{workout:i,draggable:"",drag:r.drag,onShare:x=>s.share(i),onEdit:x=>s.edit(i),onShowDeleteModal:x=>s.showDeleteModal(i),onClick:x=>t.$emit("selectWorkout",i)},null,8,["workout","drag","onShare","onEdit","onShowDeleteModal","onClick"])]),_:1},8,["list","onEnd"])])):(d(),k("span",Fe,"Aucun entra\xEEnement de disponible")),o(L,{modelValue:r.shareForm,"onUpdate:modelValue":e[4]||(e[4]=i=>r.shareForm=i),onHide:e[5]||(e[5]=i=>r.workoutToShare={})},{default:a(()=>[o(S,{class:"q-px-xs q-py-xs"},{default:a(()=>[o(c,null,{default:a(()=>[b("div",xe,"Partager l'entra\xEEnement "+v(r.workoutToShare.label),1)]),_:1}),o(c,{class:"column flex-center"},{default:a(()=>[r.workoutToShare.shareId?(d(),k($,{key:1},[o(u,{label:"Partager",color:"primary",class:"q-mb-lg",onClick:e[2]||(e[2]=i=>s.shareBtn(r.workoutToShare))}),o(u,{label:"D\xE9sactiver le paratage",color:"negative",onClick:e[3]||(e[3]=i=>s.cancelShare(r.workoutToShare)),loading:r.cancelShareLoading},null,8,["loading"])],64)):(d(),m(u,{key:0,label:"G\xE9n\xE9rer un lien de partage",color:"primary",onClick:e[1]||(e[1]=i=>s.generateShareId(r.workoutToShare)),loading:r.generatingShareLoading},null,8,["loading"]))]),_:1}),o(_,{align:"center"},{default:a(()=>[V(o(u,{label:"Fermer",color:"negative"},null,512),[[T]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(L,{modelValue:r.editForm,"onUpdate:modelValue":e[6]||(e[6]=i=>r.editForm=i),onHide:e[7]||(e[7]=i=>r.workoutToEdit={})},{default:a(()=>[o(S,{class:"q-px-xs q-py-xs"},{default:a(()=>[o(c,null,{default:a(()=>[b("div",Ce,"Modifier l'entra\xEEnement "+v(r.workoutToEdit.label),1)]),_:1}),o(c,null,{default:a(()=>[o(q,{initData:r.workoutToEdit,buttonLabel:"Confirmer",loading:r.editLoading,onSubmit:s.onEditSubmit},null,8,["initData","loading","onSubmit"])]),_:1}),o(_,{align:"center"},{default:a(()=>[V(o(u,{label:"Annuler",color:"negative"},null,512),[[T]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(L,{modelValue:r.addForm,"onUpdate:modelValue":e[8]||(e[8]=i=>r.addForm=i)},{default:a(()=>[o(S,{class:"q-px-xs q-py-xs"},{default:a(()=>[o(c,null,{default:a(()=>[We]),_:1}),o(c,null,{default:a(()=>[o(q,{buttonLabel:"Ajouter",buttonIcon:"add",loading:r.addLoading,onSubmit:s.onAddSubmit},null,8,["loading","onSubmit"])]),_:1}),o(_,{align:"center"},{default:a(()=>[V(o(u,{label:"Annuler",color:"negative"},null,512),[[T]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(ee,{position:"bottom-right",offset:[18,18]},{default:a(()=>[o(u,{fab:"",icon:"add",color:"primary",onClick:e[9]||(e[9]=i=>r.addForm=!0)})]),_:1})])}var Le=F(ye,[["render",Ve]]);const Te={name:"WorkoutsPage",components:{ChoiceWorkout:Le},methods:{selectWorkout(t){this.$router.push({name:"exercises",params:{workoutId:t.id}})}}};function qe(t,e,n,g,r,s){const l=y("ChoiceWorkout");return d(),m(l,{onSelectWorkout:s.selectWorkout},null,8,["onSelectWorkout"])}var Me=F(Te,[["render",qe]]);export{Me as default};
