import{a as C,o as u,c as h,w as n,b as e,O as q,S as r,L as m,dT as w,dU as I,dV as E,dW as Q,J as A,dX as U,r as _,K as v,M as P,V as c,Y as p,aN as y,a0 as b,R as N,U as z,a1 as V,N as k,a2 as B,a3 as M}from"./index.1d7fae07.js";import{Q as j}from"./QPageSticky.9d568b4d.js";import{C as L}from"./ClosePopup.e58e1c04.js";import{G as T}from"./GymyHeader.dde444e5.js";import{e as g,s as x}from"./notifyHelper.ce085942.js";import{Q as G}from"./QForm.aefa9904.js";import{d as H}from"./vuedraggable.umd.56e4a49c.js";import"./_commonjsHelpers.2cf1d77b.js";const O={name:"PlanForm",emits:["submit"],props:{initData:{type:Object,required:!1},buttonLabel:{type:String,required:!1,default:"Valider"},buttonIcon:{type:String,required:!1,default:null},loading:{type:Boolean,required:!1,default:!1}},data(){return{addLoading:!1,planForm:{label:""}}},created(){this.initData&&(this.planForm={...this.planForm,...this.initData})},computed:{formValid(){return this.planForm.label.trim().length>2}},methods:{onsubmit(){!this.formValid||this.$emit("submit",this.planForm)}}};function K(a,t,s,S,l,o){return u(),h(G,{onSubmit:t[1]||(t[1]=m(d=>o.onsubmit(),["prevent"])),class:"flex-center column"},{default:n(()=>[e(q,{name:"label",rounded:"",outlined:"",label:"Nom de la planification",class:"q-mb-md",type:"text",modelValue:l.planForm.label,"onUpdate:modelValue":t[0]||(t[0]=d=>l.planForm.label=d),"lazy-rules":"",rules:[d=>d.trim().length>2||"Veuillez renseigner minimum 3 caract\xE8res"],"hide-bottom-space":""},null,8,["modelValue","rules"]),s.buttonIcon?(u(),h(r,{key:0,color:"primary",label:s.buttonLabel,icon:s.buttonIcon,type:"submit",disable:!o.formValid,loading:s.loading},null,8,["label","icon","disable","loading"])):(u(),h(r,{key:1,color:"primary",label:s.buttonLabel,type:"submit",disable:!o.formValid,loading:s.loading},null,8,["label","disable","loading"]))]),_:1})}var J=C(O,[["render",K]]);const R={name:"ChoicePlan",emits:["selectPlan"],components:{GymyHeader:T,PlanForm:J,draggable:H},data(){return{drag:!1,plans:{},addForm:!1,addLoading:!1,editForm:!1,editLoading:!1,planToEdit:{}}},created(){this.loadPlans()},methods:{onDragEnd(a){this.drag=!1;const t=a.newIndex+1;w(a.item._underlying_vm_.id,t).catch(s=>{g("Une erreur est survenue lors du d\xE9placement de votre planification"),this.loadPlans()})},loadPlans(){this.plans=I()},onAddSubmit(a){this.addLoading=!0,E(a).then(()=>{this.loadPlans(),x("Votre planification a bien \xE9t\xE9 ajout\xE9e"),this.addForm=!1,this.addLoading=!1}).catch(t=>{this.addLoading=!1,g("Une erreur est survenue lors de l'ajout de votre planification")})},onEditSubmit(a){this.editLoading=!0,Q(a.id,{label:a.label}).then(()=>{this.loadPlans(),x("Votre planification a bien \xE9t\xE9 modifi\xE9e"),this.editForm=!1,this.editLoading=!1}).catch(t=>{this.editLoading=!1,g("Une erreur est survenue lors de l'\xE9dition de votre planification")})},edit(a){this.planToEdit=a,this.editForm=!0},showDeleteModal(a){let t=!1;A.create({title:"Suppression d'entra\xEEnement",message:"\xCAtes-vous s\xFBr de vouloir supprimer votre planification "+a.label+" ?",ok:{label:"Supprimer",color:"negative",loading:t},cancel:{label:"Annuler",color:"primary"}}).onOk(()=>{t=!0,U(a.id).then(()=>{this.loadPlans(),x("Votre planification a bien \xE9t\xE9 supprim\xE9e")}).catch(s=>{t=!1,g("Une erreur est survenue lors de la suppression de votre planification")})}).onCancel(()=>{})}}},W=a=>(B("data-v-0e35923f"),a=a(),M(),a),X={class:"flex column"},Y={key:0},Z={class:"text-h6 text-center"},$={class:"text-h6 text-center"},ee={class:"draggable-btn-container"},ae={key:1,class:"text-center"},te={class:"text-h6 text-center"},le=W(()=>p("div",{class:"text-h6 text-center"},"Ajouter une planification",-1));function ne(a,t,s,S,l,o){const d=_("GymyHeader"),D=_("draggable"),F=_("PlanForm");return u(),v("div",X,[e(d,{text:"Planifications"}),l.plans&&l.plans.length>0?(u(),v("div",Y,[e(D,{list:l.plans,class:"list-group","ghost-class":"ghost",itemKey:"id",handle:".draggable-btn",onEnd:o.onDragEnd,onStart:t[0]||(t[0]=i=>l.drag=!0)},{item:n(({element:i})=>[e(P,{onClick:f=>a.$emit("selectPlan",i),class:"cursor-pointer q-mb-md flex-center column q-px-md"},{default:n(()=>[e(c,{class:"gt-xs"},{default:n(()=>[p("div",Z,y(i.label),1)]),_:2},1024),e(c,{class:"q-pb-none lt-sm"},{default:n(()=>[p("div",$,y(i.label),1)]),_:2},1024),e(b,{horizontal:"",class:"absolute-right gt-xs no-wrap"},{default:n(()=>[e(r,{flat:"",round:"",color:"primary",icon:"edit",onClick:m(f=>o.edit(i),["stop"])},null,8,["onClick"]),e(r,{flat:"",round:"",color:"negative",icon:"delete",onClick:m(f=>o.showDeleteModal(i),["stop"])},null,8,["onClick"])]),_:2},1024),e(b,{horizontal:"",class:"lt-sm no-wrap q-pa-none"},{default:n(()=>[e(r,{flat:"",round:"",color:"primary",icon:"edit",onClick:m(f=>o.edit(i),["stop"])},null,8,["onClick"]),e(r,{flat:"",round:"",color:"negative",icon:"delete",onClick:m(f=>o.showDeleteModal(i),["stop"])},null,8,["onClick"])]),_:2},1024),p("div",ee,[e(N,{class:z("draggable-btn "+(l.drag?"cursor-grabbing":"cursor-grab")),size:"sm",name:"menu"},null,8,["class"])])]),_:2},1032,["onClick"])]),_:1},8,["list","onEnd"])])):(u(),v("span",ae,"Aucune planification de disponible")),e(k,{modelValue:l.editForm,"onUpdate:modelValue":t[1]||(t[1]=i=>l.editForm=i)},{default:n(()=>[e(P,{class:"q-px-xs q-py-xs"},{default:n(()=>[e(c,null,{default:n(()=>[p("div",te,"Modifier la planification "+y(l.planToEdit.label),1)]),_:1}),e(c,null,{default:n(()=>[e(F,{initData:l.planToEdit,buttonLabel:"Confirmer",loading:l.editLoading,onSubmit:o.onEditSubmit},null,8,["initData","loading","onSubmit"])]),_:1}),e(b,{align:"center"},{default:n(()=>[V(e(r,{label:"Annuler",color:"negative"},null,512),[[L]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(k,{modelValue:l.addForm,"onUpdate:modelValue":t[2]||(t[2]=i=>l.addForm=i)},{default:n(()=>[e(P,{class:"q-px-xs q-py-xs"},{default:n(()=>[e(c,null,{default:n(()=>[le]),_:1}),e(c,null,{default:n(()=>[e(F,{buttonLabel:"Ajouter",buttonIcon:"add",loading:l.addLoading,onSubmit:o.onAddSubmit},null,8,["loading","onSubmit"])]),_:1}),e(b,{align:"center"},{default:n(()=>[V(e(r,{label:"Annuler",color:"negative"},null,512),[[L]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(j,{position:"bottom-right",offset:[18,18]},{default:n(()=>[e(r,{fab:"",icon:"add",color:"primary",onClick:t[3]||(t[3]=i=>l.addForm=!0)})]),_:1})])}var oe=C(R,[["render",ne],["__scopeId","data-v-0e35923f"]]);const ie={name:"PlansPage",components:{ChoicePlan:oe},methods:{selectPlan(a){this.$router.push({name:"plan",params:{planId:a.id}})}}};function se(a,t,s,S,l,o){const d=_("ChoicePlan");return u(),h(d,{onSelectPlan:o.selectPlan},null,8,["onSelectPlan"])}var ge=C(ie,[["render",se]]);export{ge as default};
