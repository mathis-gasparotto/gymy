import{d as createComponent,dg as useFieldProps,dh as useFieldEmits,di as useField,dj as useFieldState,aS as useDarkProps,b1 as useSizeProps,aT as useDark,b2 as useSize,f as computed,dk as hDir,j as getCurrentInstance,h,R as QIcon,dl as hMergeSlotSafely,aF as Ripple,a6 as stopAndPrevent,P as Platform,z as ref,ac as isKeyCode,dm as prevent,B as nextTick,dn as addEvt,m as watch,n as onMounted,q as onBeforeUnmount,dp as cleanEvt,v as listenOpts,dq as portalProxyList,dr as client,C as getScrollbarWidth,ds as useModelToggleProps,dt as useTransitionProps,s as scrollTargetProp,du as useModelToggleEmits,aL as useTick,H as useTimeout,dv as useTransition,dw as useModelToggle,dx as usePortal,b4 as addFocusout,dy as position,b5 as removeFocusout,dz as removeEscapeKey,u as getScrollTarget,dA as closePortalMenus,g as hSlot,T as Transition,dB as addEscapeKey,a7 as addFocusFn,dC as childHasFocus,t as noop,dD as debounce,ck as onBeforeMount,a4 as onDeactivated,a5 as onActivated,d9 as useFormProps,dE as useFormInputNameAttr,dF as fieldValueIsFilled,aH as isDeepEqual,cl as onBeforeUpdate,cq as onUpdated,dG as useKeyComposition,dH as stop,aG as shouldIgnoreKey,N as QDialog,F as hMergeSlot,aj as Plugin,ak as LOCALSTORAGE_DB_USER,dI as PERFORMANCE_TYPE_DEFAULT,dJ as PERFORMANCE_TYPE_BAR,aI as uid,ar as getUser,as as USER_GUEST_UID,dK as createData,ag as auth,dL as updateData,aw as removeData,a as _export_sfc,dM as PERFORMANCE_TYPE_ARM,o as openBlock,K as createElementBlock,b as createVNode,w as withCtx,V as QCardSection,Y as createBaseVNode,aN as toDisplayString,$ as createCommentVNode,X as QSeparator,aP as Fragment,aQ as renderList,S as QBtn,O as QInput,M as QCard,c as createBlock,J as Dialog,a0 as QCardActions,a1 as withDirectives,Z as createTextVNode,L as withModifiers,c1 as defineComponent,D as reactive,k as provide,E as onUnmounted,i as inject,U as normalizeClass,r as resolveComponent,ct as renderSlot,cj as mergeProps,bF as normalizeStyle,df as getWorkout,dN as getExercise}from"./index.1d7fae07.js";import{Q as QItemSection,a as QItem}from"./QItemSection.74797b3c.js";import{Q as QItemLabel}from"./QItemLabel.3064b917.js";import{r as rtlHasScrollBug}from"./rtl.276c3f1b.js";import{s as successNotify,e as errorNotify}from"./notifyHelper.ce085942.js";import{t as translatting}from"./translatting.6793a7ea.js";import{C as ClosePopup}from"./ClosePopup.e58e1c04.js";import{f as formatting}from"./formatting.660d74af.js";var QField=createComponent({name:"QField",inheritAttrs:!1,props:{...useFieldProps,tag:{type:String,default:"label"}},emits:useFieldEmits,setup(){return useField(useFieldState({tagProp:!0}))}});const defaultSizes={xs:8,sm:10,md:14,lg:20,xl:24};var QChip=createComponent({name:"QChip",props:{...useDarkProps,...useSizeProps,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(e,{slots:t,emit:n}){const{proxy:{$q:r}}=getCurrentInstance(),i=useDark(e,r),o=useSize(e,defaultSizes),a=computed(()=>e.selected===!0||e.icon!==void 0),l=computed(()=>e.selected===!0?e.iconSelected||r.iconSet.chip.selected:e.icon),u=computed(()=>e.iconRemove||r.iconSet.chip.remove),s=computed(()=>e.disable===!1&&(e.clickable===!0||e.selected!==null)),c=computed(()=>{const v=e.outline===!0&&e.color||e.textColor;return"q-chip row inline no-wrap items-center"+(e.outline===!1&&e.color!==void 0?` bg-${e.color}`:"")+(v?` text-${v} q-chip--colored`:"")+(e.disable===!0?" disabled":"")+(e.dense===!0?" q-chip--dense":"")+(e.outline===!0?" q-chip--outline":"")+(e.selected===!0?" q-chip--selected":"")+(s.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(e.square===!0?" q-chip--square":"")+(i.value===!0?" q-chip--dark q-dark":"")}),d=computed(()=>{const v=e.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:e.tabindex||0},_={...v,role:"button","aria-hidden":"false","aria-label":e.removeAriaLabel||r.lang.label.remove};return{chip:v,remove:_}});function f(v){v.keyCode===13&&m(v)}function m(v){e.disable||(n("update:selected",!e.selected),n("click",v))}function g(v){(v.keyCode===void 0||v.keyCode===13)&&(stopAndPrevent(v),e.disable===!1&&(n("update:modelValue",!1),n("remove")))}function b(){const v=[];s.value===!0&&v.push(h("div",{class:"q-focus-helper"})),a.value===!0&&v.push(h(QIcon,{class:"q-chip__icon q-chip__icon--left",name:l.value}));const _=e.label!==void 0?[h("div",{class:"ellipsis"},[e.label])]:void 0;return v.push(h("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},hMergeSlotSafely(t.default,_))),e.iconRight&&v.push(h(QIcon,{class:"q-chip__icon q-chip__icon--right",name:e.iconRight})),e.removable===!0&&v.push(h(QIcon,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:u.value,...d.value.remove,onClick:g,onKeyup:g})),v}return()=>{if(e.modelValue===!1)return;const v={class:c.value,style:o.value};return s.value===!0&&Object.assign(v,d.value.chip,{onClick:m,onKeyup:f}),hDir("div",v,b(),"ripple",e.ripple!==!1&&e.disable!==!0,()=>[[Ripple,e.ripple]])}}});function clearSelection(){if(window.getSelection!==void 0){const e=window.getSelection();e.empty!==void 0?e.empty():e.removeAllRanges!==void 0&&(e.removeAllRanges(),Platform.is.mobile!==!0&&e.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}const useAnchorStaticProps={target:{type:[Boolean,String,Element],default:!0},noParentEvent:Boolean},useAnchorProps={...useAnchorStaticProps,contextMenu:Boolean};function useAnchor({showing:e,avoidEmit:t,configureAnchorEl:n}){const{props:r,proxy:i,emit:o}=getCurrentInstance(),a=ref(null);let l=null;function u(m){return a.value===null?!1:m===void 0||m.touches===void 0||m.touches.length<=1}const s={};n===void 0&&(Object.assign(s,{hide(m){i.hide(m)},toggle(m){i.toggle(m),m.qAnchorHandled=!0},toggleKey(m){isKeyCode(m,13)===!0&&s.toggle(m)},contextClick(m){i.hide(m),prevent(m),nextTick(()=>{i.show(m),m.qAnchorHandled=!0})},prevent,mobileTouch(m){if(s.mobileCleanup(m),u(m)!==!0)return;i.hide(m),a.value.classList.add("non-selectable");const g=m.target;addEvt(s,"anchor",[[g,"touchmove","mobileCleanup","passive"],[g,"touchend","mobileCleanup","passive"],[g,"touchcancel","mobileCleanup","passive"],[a.value,"contextmenu","prevent","notPassive"]]),l=setTimeout(()=>{l=null,i.show(m),m.qAnchorHandled=!0},300)},mobileCleanup(m){a.value.classList.remove("non-selectable"),l!==null&&(clearTimeout(l),l=null),e.value===!0&&m!==void 0&&clearSelection()}}),n=function(m=r.contextMenu){if(r.noParentEvent===!0||a.value===null)return;let g;m===!0?i.$q.platform.is.mobile===!0?g=[[a.value,"touchstart","mobileTouch","passive"]]:g=[[a.value,"mousedown","hide","passive"],[a.value,"contextmenu","contextClick","notPassive"]]:g=[[a.value,"click","toggle","passive"],[a.value,"keyup","toggleKey","passive"]],addEvt(s,"anchor",g)});function c(){cleanEvt(s,"anchor")}function d(m){for(a.value=m;a.value.classList.contains("q-anchor--skip");)a.value=a.value.parentNode;n()}function f(){if(r.target===!1||r.target===""||i.$el.parentNode===null)a.value=null;else if(r.target===!0)d(i.$el.parentNode);else{let m=r.target;if(typeof r.target=="string")try{m=document.querySelector(r.target)}catch{m=void 0}m!=null?(a.value=m.$el||m,n()):(a.value=null,console.error(`Anchor: target "${r.target}" not found`))}}return watch(()=>r.contextMenu,m=>{a.value!==null&&(c(),n(m))}),watch(()=>r.target,()=>{a.value!==null&&c(),f()}),watch(()=>r.noParentEvent,m=>{a.value!==null&&(m===!0?c():n())}),onMounted(()=>{f(),t!==!0&&r.modelValue===!0&&a.value===null&&o("update:modelValue",!1)}),onBeforeUnmount(()=>{l!==null&&clearTimeout(l),c()}),{anchorEl:a,canShow:u,anchorEvents:s}}function useScrollTarget(e,t){const n=ref(null);let r;function i(l,u){const s=`${u!==void 0?"add":"remove"}EventListener`,c=u!==void 0?u:r;l!==window&&l[s]("scroll",c,listenOpts.passive),window[s]("scroll",c,listenOpts.passive),r=u}function o(){n.value!==null&&(i(n.value),n.value=null)}const a=watch(()=>e.noParentEvent,()=>{n.value!==null&&(o(),t())});return onBeforeUnmount(a),{localScrollTarget:n,unconfigureScrollTarget:o,changeScrollEvent:i}}const{notPassiveCapture}=listenOpts,registeredList=[];function globalHandler(e){const t=e.target;if(t===void 0||t.nodeType===8||t.classList.contains("no-pointer-events")===!0)return;let n=portalProxyList.length-1;for(;n>=0;){const r=portalProxyList[n].$;if(r.type.name==="QTooltip"){n--;continue}if(r.type.name!=="QDialog")break;if(r.props.seamless!==!0)return;n--}for(let r=registeredList.length-1;r>=0;r--){const i=registeredList[r];if((i.anchorEl.value===null||i.anchorEl.value.contains(t)===!1)&&(t===document.body||i.innerRef.value!==null&&i.innerRef.value.contains(t)===!1))e.qClickOutside=!0,i.onClickOutside(e);else return}}function addClickOutside(e){registeredList.push(e),registeredList.length===1&&(document.addEventListener("mousedown",globalHandler,notPassiveCapture),document.addEventListener("touchstart",globalHandler,notPassiveCapture))}function removeClickOutside(e){const t=registeredList.findIndex(n=>n===e);t!==-1&&(registeredList.splice(t,1),registeredList.length===0&&(document.removeEventListener("mousedown",globalHandler,notPassiveCapture),document.removeEventListener("touchstart",globalHandler,notPassiveCapture)))}let vpLeft,vpTop;function validatePosition(e){const t=e.split(" ");return t.length!==2?!1:["top","center","bottom"].includes(t[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(t[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function validateOffset(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const horizontalPos={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{horizontalPos[`${e}#ltr`]=e,horizontalPos[`${e}#rtl`]=e});function parsePosition(e,t){const n=e.split(" ");return{vertical:n[0],horizontal:horizontalPos[`${n[1]}#${t===!0?"rtl":"ltr"}`]}}function getAnchorProps(e,t){let{top:n,left:r,right:i,bottom:o,width:a,height:l}=e.getBoundingClientRect();return t!==void 0&&(n-=t[1],r-=t[0],o+=t[1],i+=t[0],a+=t[0],l+=t[1]),{top:n,bottom:o,height:l,left:r,right:i,width:a,middle:r+(i-r)/2,center:n+(o-n)/2}}function getAbsoluteAnchorProps(e,t,n){let{top:r,left:i}=e.getBoundingClientRect();return r+=t.top,i+=t.left,n!==void 0&&(r+=n[1],i+=n[0]),{top:r,bottom:r+1,height:1,left:i,right:i+1,width:1,middle:i,center:r}}function getTargetProps(e,t){return{top:0,center:t/2,bottom:t,left:0,middle:e/2,right:e}}function getTopLeftProps(e,t,n,r){return{top:e[n.vertical]-t[r.vertical],left:e[n.horizontal]-t[r.horizontal]}}function setPosition(e,t=0){if(e.targetEl===null||e.anchorEl===null||t>5)return;if(e.targetEl.offsetHeight===0||e.targetEl.offsetWidth===0){setTimeout(()=>{setPosition(e,t+1)},10);return}const{targetEl:n,offset:r,anchorEl:i,anchorOrigin:o,selfOrigin:a,absoluteOffset:l,fit:u,cover:s,maxHeight:c,maxWidth:d}=e;if(client.is.ios===!0&&window.visualViewport!==void 0){const B=document.body.style,{offsetLeft:T,offsetTop:D}=window.visualViewport;T!==vpLeft&&(B.setProperty("--q-pe-left",T+"px"),vpLeft=T),D!==vpTop&&(B.setProperty("--q-pe-top",D+"px"),vpTop=D)}const{scrollLeft:f,scrollTop:m}=n,g=l===void 0?getAnchorProps(i,s===!0?[0,0]:r):getAbsoluteAnchorProps(i,l,r);Object.assign(n.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:d||"100vw",maxHeight:c||"100vh",visibility:"visible"});const{offsetWidth:b,offsetHeight:v}=n,{elWidth:_,elHeight:$}=u===!0||s===!0?{elWidth:Math.max(g.width,b),elHeight:s===!0?Math.max(g.height,v):v}:{elWidth:b,elHeight:v};let k={maxWidth:d,maxHeight:c};(u===!0||s===!0)&&(k.minWidth=g.width+"px",s===!0&&(k.minHeight=g.height+"px")),Object.assign(n.style,k);const S=getTargetProps(_,$);let C=getTopLeftProps(g,S,o,a);if(l===void 0||r===void 0)applyBoundaries(C,g,S,o,a);else{const{top:B,left:T}=C;applyBoundaries(C,g,S,o,a);let D=!1;if(C.top!==B){D=!0;const j=2*r[1];g.center=g.top-=j,g.bottom-=j+2}if(C.left!==T){D=!0;const j=2*r[0];g.middle=g.left-=j,g.right-=j+2}D===!0&&(C=getTopLeftProps(g,S,o,a),applyBoundaries(C,g,S,o,a))}k={top:C.top+"px",left:C.left+"px"},C.maxHeight!==void 0&&(k.maxHeight=C.maxHeight+"px",g.height>C.maxHeight&&(k.minHeight=k.maxHeight)),C.maxWidth!==void 0&&(k.maxWidth=C.maxWidth+"px",g.width>C.maxWidth&&(k.minWidth=k.maxWidth)),Object.assign(n.style,k),n.scrollTop!==m&&(n.scrollTop=m),n.scrollLeft!==f&&(n.scrollLeft=f)}function applyBoundaries(e,t,n,r,i){const o=n.bottom,a=n.right,l=getScrollbarWidth(),u=window.innerHeight-l,s=document.body.clientWidth;if(e.top<0||e.top+o>u)if(i.vertical==="center")e.top=t[r.vertical]>u/2?Math.max(0,u-o):0,e.maxHeight=Math.min(o,u);else if(t[r.vertical]>u/2){const c=Math.min(u,r.vertical==="center"?t.center:r.vertical===i.vertical?t.bottom:t.top);e.maxHeight=Math.min(o,c),e.top=Math.max(0,c-o)}else e.top=Math.max(0,r.vertical==="center"?t.center:r.vertical===i.vertical?t.top:t.bottom),e.maxHeight=Math.min(o,u-e.top);if(e.left<0||e.left+a>s)if(e.maxWidth=Math.min(a,s),i.horizontal==="middle")e.left=t[r.horizontal]>s/2?Math.max(0,s-a):0;else if(t[r.horizontal]>s/2){const c=Math.min(s,r.horizontal==="middle"?t.middle:r.horizontal===i.horizontal?t.right:t.left);e.maxWidth=Math.min(a,c),e.left=Math.max(0,c-e.maxWidth)}else e.left=Math.max(0,r.horizontal==="middle"?t.middle:r.horizontal===i.horizontal?t.left:t.right),e.maxWidth=Math.min(a,s-e.left)}var QMenu=createComponent({name:"QMenu",inheritAttrs:!1,props:{...useAnchorProps,...useModelToggleProps,...useDarkProps,...useTransitionProps,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:validatePosition},self:{type:String,validator:validatePosition},offset:{type:Array,validator:validateOffset},scrollTarget:scrollTargetProp,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...useModelToggleEmits,"click","escapeKey"],setup(e,{slots:t,emit:n,attrs:r}){let i=null,o,a,l;const u=getCurrentInstance(),{proxy:s}=u,{$q:c}=s,d=ref(null),f=ref(!1),m=computed(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),g=useDark(e,c),{registerTick:b,removeTick:v}=useTick(),{registerTimeout:_}=useTimeout(),{transitionProps:$,transitionStyle:k}=useTransition(e),{localScrollTarget:S,changeScrollEvent:C,unconfigureScrollTarget:B}=useScrollTarget(e,L),{anchorEl:T,canShow:D}=useAnchor({showing:f}),{hide:j}=useModelToggle({showing:f,canShow:D,handleShow:le,handleHide:w,hideOnRouteChange:m,processOnMount:!0}),{showPortal:U,hidePortal:V,renderPortal:R}=usePortal(u,d,X,"menu"),P={anchorEl:T,innerRef:d,onClickOutside(A){if(e.persistent!==!0&&f.value===!0)return j(A),(A.type==="touchstart"||A.target.classList.contains("q-dialog__backdrop"))&&stopAndPrevent(A),!0}},z=computed(()=>parsePosition(e.anchor||(e.cover===!0?"center middle":"bottom start"),c.lang.rtl)),te=computed(()=>e.cover===!0?z.value:parsePosition(e.self||"top start",c.lang.rtl)),G=computed(()=>(e.square===!0?" q-menu--square":"")+(g.value===!0?" q-menu--dark q-dark":"")),ne=computed(()=>e.autoClose===!0?{onClick:H}:{}),J=computed(()=>f.value===!0&&e.persistent!==!0);watch(J,A=>{A===!0?(addEscapeKey(q),addClickOutside(P)):(removeEscapeKey(q),removeClickOutside(P))});function Y(){addFocusFn(()=>{let A=d.value;A&&A.contains(document.activeElement)!==!0&&(A=A.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||A.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||A.querySelector("[autofocus], [data-autofocus]")||A,A.focus({preventScroll:!0}))})}function le(A){if(i=e.noRefocus===!1?document.activeElement:null,addFocusout(I),U(),L(),o=void 0,A!==void 0&&(e.touchPosition||e.contextMenu)){const ee=position(A);if(ee.left!==void 0){const{top:oe,left:me}=T.value.getBoundingClientRect();o={left:ee.left-me,top:ee.top-oe}}}a===void 0&&(a=watch(()=>c.screen.width+"|"+c.screen.height+"|"+e.self+"|"+e.anchor+"|"+c.lang.rtl,O)),e.noFocus!==!0&&document.activeElement.blur(),b(()=>{O(),e.noFocus!==!0&&Y()}),_(()=>{c.platform.is.ios===!0&&(l=e.autoClose,d.value.click()),O(),U(!0),n("show",A)},e.transitionDuration)}function w(A){v(),V(),E(!0),i!==null&&(A===void 0||A.qClickOutside!==!0)&&(((A&&A.type.indexOf("key")===0?i.closest('[tabindex]:not([tabindex^="-"])'):void 0)||i).focus(),i=null),_(()=>{V(!0),n("hide",A)},e.transitionDuration)}function E(A){o=void 0,a!==void 0&&(a(),a=void 0),(A===!0||f.value===!0)&&(removeFocusout(I),B(),removeClickOutside(P),removeEscapeKey(q)),A!==!0&&(i=null)}function L(){(T.value!==null||e.scrollTarget!==void 0)&&(S.value=getScrollTarget(T.value,e.scrollTarget),C(S.value,O))}function H(A){l!==!0?(closePortalMenus(s,A),n("click",A)):l=!1}function I(A){J.value===!0&&e.noFocus!==!0&&childHasFocus(d.value,A.target)!==!0&&Y()}function q(A){n("escapeKey"),j(A)}function O(){setPosition({targetEl:d.value,offset:e.offset,anchorEl:T.value,anchorOrigin:z.value,selfOrigin:te.value,absoluteOffset:o,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function X(){return h(Transition,$.value,()=>f.value===!0?h("div",{role:"menu",...r,ref:d,tabindex:-1,class:["q-menu q-position-engine scroll"+G.value,r.class],style:[r.style,k.value],...ne.value},hSlot(t.default)):null)}return onBeforeUnmount(E),Object.assign(s,{focus:Y,updatePosition:O}),R}});const aggBucketSize=1e3,scrollToEdges=["start","center","end","start-force","center-force","end-force"],filterProto=Array.prototype.filter,setOverflowAnchor=window.getComputedStyle(document.body).overflowAnchor===void 0?noop:function(e,t){e!==null&&(e._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(e===null)return;e._qOverflowAnimationFrame=void 0;const n=e.children||[];filterProto.call(n,i=>i.dataset&&i.dataset.qVsAnchor!==void 0).forEach(i=>{delete i.dataset.qVsAnchor});const r=n[t];r&&r.dataset&&(r.dataset.qVsAnchor="")}))};function sumFn(e,t){return e+t}function getScrollDetails(e,t,n,r,i,o,a,l){const u=e===window?document.scrollingElement||document.documentElement:e,s=i===!0?"offsetWidth":"offsetHeight",c={scrollStart:0,scrollViewSize:-a-l,scrollMaxSize:0,offsetStart:-a,offsetEnd:-l};if(i===!0?(e===window?(c.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,c.scrollViewSize+=document.documentElement.clientWidth):(c.scrollStart=u.scrollLeft,c.scrollViewSize+=u.clientWidth),c.scrollMaxSize=u.scrollWidth,o===!0&&(c.scrollStart=(rtlHasScrollBug===!0?c.scrollMaxSize-c.scrollViewSize:0)-c.scrollStart)):(e===window?(c.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,c.scrollViewSize+=document.documentElement.clientHeight):(c.scrollStart=u.scrollTop,c.scrollViewSize+=u.clientHeight),c.scrollMaxSize=u.scrollHeight),n!==null)for(let d=n.previousElementSibling;d!==null;d=d.previousElementSibling)d.classList.contains("q-virtual-scroll--skip")===!1&&(c.offsetStart+=d[s]);if(r!==null)for(let d=r.nextElementSibling;d!==null;d=d.nextElementSibling)d.classList.contains("q-virtual-scroll--skip")===!1&&(c.offsetEnd+=d[s]);if(t!==e){const d=u.getBoundingClientRect(),f=t.getBoundingClientRect();i===!0?(c.offsetStart+=f.left-d.left,c.offsetEnd-=f.width):(c.offsetStart+=f.top-d.top,c.offsetEnd-=f.height),e!==window&&(c.offsetStart+=c.scrollStart),c.offsetEnd+=c.scrollMaxSize-c.offsetStart}return c}function setScroll(e,t,n,r){t==="end"&&(t=(e===window?document.body:e)[n===!0?"scrollWidth":"scrollHeight"]),e===window?n===!0?(r===!0&&(t=(rtlHasScrollBug===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-t),window.scrollTo(t,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,t):n===!0?(r===!0&&(t=(rtlHasScrollBug===!0?e.scrollWidth-e.offsetWidth:0)-t),e.scrollLeft=t):e.scrollTop=t}function sumSize(e,t,n,r){if(n>=r)return 0;const i=t.length,o=Math.floor(n/aggBucketSize),a=Math.floor((r-1)/aggBucketSize)+1;let l=e.slice(o,a).reduce(sumFn,0);return n%aggBucketSize!==0&&(l-=t.slice(o*aggBucketSize,n).reduce(sumFn,0)),r%aggBucketSize!==0&&r!==i&&(l-=t.slice(r,a*aggBucketSize).reduce(sumFn,0)),l}const commonVirtScrollProps={virtualScrollSliceSize:{type:[Number,String],default:10},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},useVirtualScrollProps={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...commonVirtScrollProps};function useVirtualScroll({virtualScrollLength:e,getVirtualScrollTarget:t,getVirtualScrollEl:n,virtualScrollItemSizeComputed:r}){const i=getCurrentInstance(),{props:o,emit:a,proxy:l}=i,{$q:u}=l;let s,c,d,f=[],m;const g=ref(0),b=ref(0),v=ref({}),_=ref(null),$=ref(null),k=ref(null),S=ref({from:0,to:0}),C=computed(()=>o.tableColspan!==void 0?o.tableColspan:100);r===void 0&&(r=computed(()=>o.virtualScrollItemSize));const B=computed(()=>r.value+";"+o.virtualScrollHorizontal),T=computed(()=>B.value+";"+o.virtualScrollSliceRatioBefore+";"+o.virtualScrollSliceRatioAfter);watch(T,()=>{G()}),watch(B,D);function D(){te(c,!0)}function j(w){te(w===void 0?c:w)}function U(w,E){const L=t();if(L==null||L.nodeType===8)return;const H=getScrollDetails(L,n(),_.value,$.value,o.virtualScrollHorizontal,u.lang.rtl,o.virtualScrollStickySizeStart,o.virtualScrollStickySizeEnd);d!==H.scrollViewSize&&G(H.scrollViewSize),R(L,H,Math.min(e.value-1,Math.max(0,parseInt(w,10)||0)),0,scrollToEdges.indexOf(E)!==-1?E:c!==-1&&w>c?"end":"start")}function V(){const w=t();if(w==null||w.nodeType===8)return;const E=getScrollDetails(w,n(),_.value,$.value,o.virtualScrollHorizontal,u.lang.rtl,o.virtualScrollStickySizeStart,o.virtualScrollStickySizeEnd),L=e.value-1,H=E.scrollMaxSize-E.offsetStart-E.offsetEnd-b.value;if(s===E.scrollStart)return;if(E.scrollMaxSize<=0){R(w,E,0,0);return}d!==E.scrollViewSize&&G(E.scrollViewSize),P(S.value.from);const I=Math.floor(E.scrollMaxSize-Math.max(E.scrollViewSize,E.offsetEnd)-Math.min(m[L],E.scrollViewSize/2));if(I>0&&Math.ceil(E.scrollStart)>=I){R(w,E,L,E.scrollMaxSize-E.offsetEnd-f.reduce(sumFn,0));return}let q=0,O=E.scrollStart-E.offsetStart,X=O;if(O<=H&&O+E.scrollViewSize>=g.value)O-=g.value,q=S.value.from,X=O;else for(let A=0;O>=f[A]&&q<L;A++)O-=f[A],q+=aggBucketSize;for(;O>0&&q<L;)O-=m[q],O>-E.scrollViewSize?(q++,X=O):X=m[q]+O;R(w,E,q,X)}function R(w,E,L,H,I){const q=typeof I=="string"&&I.indexOf("-force")!==-1,O=q===!0?I.replace("-force",""):I,X=O!==void 0?O:"start";let A=Math.max(0,L-v.value[X]),ee=A+v.value.total;ee>e.value&&(ee=e.value,A=Math.max(0,ee-v.value.total)),s=E.scrollStart;const oe=A!==S.value.from||ee!==S.value.to;if(oe===!1&&O===void 0){J(L);return}const{activeElement:me}=document,se=k.value;oe===!0&&se!==null&&se!==me&&se.contains(me)===!0&&(se.addEventListener("focusout",z),setTimeout(()=>{se!==null&&se.removeEventListener("focusout",z)})),setOverflowAnchor(se,L-A);const ke=O!==void 0?m.slice(A,L).reduce(sumFn,0):0;if(oe===!0){const ce=ee>=S.value.from&&A<=S.value.to?S.value.to:ee;S.value={from:A,to:ce},g.value=sumSize(f,m,0,A),b.value=sumSize(f,m,ee,e.value),requestAnimationFrame(()=>{S.value.to!==ee&&s===E.scrollStart&&(S.value={from:S.value.from,to:ee},b.value=sumSize(f,m,ee,e.value))})}requestAnimationFrame(()=>{if(s!==E.scrollStart)return;oe===!0&&P(A);const ce=m.slice(A,L).reduce(sumFn,0),fe=ce+E.offsetStart+g.value,$e=fe+m[L];let xe=fe+H;if(O!==void 0){const Me=ce-ke,we=E.scrollStart+Me;xe=q!==!0&&we<fe&&$e<we+E.scrollViewSize?we:O==="end"?$e-E.scrollViewSize:fe-(O==="start"?0:Math.round((E.scrollViewSize-m[L])/2))}s=xe,setScroll(w,xe,o.virtualScrollHorizontal,u.lang.rtl),J(L)})}function P(w){const E=k.value;if(E){const L=filterProto.call(E.children,A=>A.classList&&A.classList.contains("q-virtual-scroll--skip")===!1),H=L.length,I=o.virtualScrollHorizontal===!0?A=>A.getBoundingClientRect().width:A=>A.offsetHeight;let q=w,O,X;for(let A=0;A<H;){for(O=I(L[A]),A++;A<H&&L[A].classList.contains("q-virtual-scroll--with-prev")===!0;)O+=I(L[A]),A++;X=O-m[q],X!==0&&(m[q]+=X,f[Math.floor(q/aggBucketSize)]+=X),q++}}}function z(){k.value!==null&&k.value!==void 0&&k.value.focus()}function te(w,E){const L=1*r.value;(E===!0||Array.isArray(m)===!1)&&(m=[]);const H=m.length;m.length=e.value;for(let q=e.value-1;q>=H;q--)m[q]=L;const I=Math.floor((e.value-1)/aggBucketSize);f=[];for(let q=0;q<=I;q++){let O=0;const X=Math.min((q+1)*aggBucketSize,e.value);for(let A=q*aggBucketSize;A<X;A++)O+=m[A];f.push(O)}c=-1,s=void 0,g.value=sumSize(f,m,0,S.value.from),b.value=sumSize(f,m,S.value.to,e.value),w>=0?(P(S.value.from),nextTick(()=>{U(w)})):Y()}function G(w){if(w===void 0&&typeof window!="undefined"){const O=t();O!=null&&O.nodeType!==8&&(w=getScrollDetails(O,n(),_.value,$.value,o.virtualScrollHorizontal,u.lang.rtl,o.virtualScrollStickySizeStart,o.virtualScrollStickySizeEnd).scrollViewSize)}d=w;const E=parseFloat(o.virtualScrollSliceRatioBefore)||0,L=parseFloat(o.virtualScrollSliceRatioAfter)||0,H=1+E+L,I=w===void 0||w<=0?1:Math.ceil(w/r.value),q=Math.max(1,I,Math.ceil((o.virtualScrollSliceSize>0?o.virtualScrollSliceSize:10)/H));v.value={total:Math.ceil(q*H),start:Math.ceil(q*E),center:Math.ceil(q*(.5+E)),end:Math.ceil(q*(1+E)),view:I}}function ne(w,E){const L=o.virtualScrollHorizontal===!0?"width":"height",H={["--q-virtual-scroll-item-"+L]:r.value+"px"};return[w==="tbody"?h(w,{class:"q-virtual-scroll__padding",key:"before",ref:_},[h("tr",[h("td",{style:{[L]:`${g.value}px`,...H},colspan:C.value})])]):h(w,{class:"q-virtual-scroll__padding",key:"before",ref:_,style:{[L]:`${g.value}px`,...H}}),h(w,{class:"q-virtual-scroll__content",key:"content",ref:k,tabindex:-1},E.flat()),w==="tbody"?h(w,{class:"q-virtual-scroll__padding",key:"after",ref:$},[h("tr",[h("td",{style:{[L]:`${b.value}px`,...H},colspan:C.value})])]):h(w,{class:"q-virtual-scroll__padding",key:"after",ref:$,style:{[L]:`${b.value}px`,...H}})]}function J(w){c!==w&&(o.onVirtualScroll!==void 0&&a("virtualScroll",{index:w,from:S.value.from,to:S.value.to-1,direction:w<c?"decrease":"increase",ref:l}),c=w)}G();const Y=debounce(V,u.platform.is.ios===!0?120:35);onBeforeMount(()=>{G()});let le=!1;return onDeactivated(()=>{le=!0}),onActivated(()=>{if(le!==!0)return;const w=t();s!==void 0&&w!==void 0&&w!==null&&w.nodeType!==8?setScroll(w,s,o.virtualScrollHorizontal,u.lang.rtl):U(c)}),onBeforeUnmount(()=>{Y.cancel()}),Object.assign(l,{scrollTo:U,reset:D,refresh:j}),{virtualScrollSliceRange:S,virtualScrollSliceSizeComputed:v,setVirtualScrollSize:G,onVirtualScrollEvt:Y,localResetVirtualScroll:te,padVirtualScroll:ne,scrollTo:U,reset:D,refresh:j}}function normalizeToInterval(e,t,n){if(n<=t)return t;const r=n-t+1;let i=t+(e-t)%r;return i<t&&(i=r+i),i===0?0:i}const validateNewValueMode=e=>["add","add-unique","toggle"].includes(e),reEscapeList=".*+?^${}()|[]\\",fieldPropsList=Object.keys(useFieldProps);var QSelect=createComponent({name:"QSelect",inheritAttrs:!1,props:{...useVirtualScrollProps,...useFormProps,...useFieldProps,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],popupNoRouteDismiss:Boolean,useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:validateNewValueMode},mapOptions:Boolean,emitValue:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:{},transitionHide:{},transitionDuration:{},behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:useVirtualScrollProps.virtualScrollItemSize.type,onNewValue:Function,onFilter:Function},emits:[...useFieldEmits,"add","remove","inputValue","keyup","keypress","keydown","popupShow","popupHide","filterAbort"],setup(e,{slots:t,emit:n}){const{proxy:r}=getCurrentInstance(),{$q:i}=r,o=ref(!1),a=ref(!1),l=ref(-1),u=ref(""),s=ref(!1),c=ref(!1);let d=null,f=null,m,g,b,v=null,_,$,k,S;const C=ref(null),B=ref(null),T=ref(null),D=ref(null),j=ref(null),U=useFormInputNameAttr(e),V=useKeyComposition(je),R=computed(()=>Array.isArray(e.options)?e.options.length:0),P=computed(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:z,virtualScrollSliceSizeComputed:te,localResetVirtualScroll:G,padVirtualScroll:ne,onVirtualScrollEvt:J,scrollTo:Y,setVirtualScrollSize:le}=useVirtualScroll({virtualScrollLength:R,getVirtualScrollTarget:Ze,getVirtualScrollEl:Ie,virtualScrollItemSizeComputed:P}),w=useFieldState(),E=computed(()=>{const p=e.mapOptions===!0&&e.multiple!==!0,N=e.modelValue!==void 0&&(e.modelValue!==null||p===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const M=e.mapOptions===!0&&m!==void 0?m:[],F=N.map(Q=>Ge(Q,M));return e.modelValue===null&&p===!0?F.filter(Q=>Q!==null):F}return N}),L=computed(()=>{const p={};return fieldPropsList.forEach(N=>{const M=e[N];M!==void 0&&(p[N]=M)}),p}),H=computed(()=>e.optionsDark===null?w.isDark.value:e.optionsDark),I=computed(()=>fieldValueIsFilled(E.value)),q=computed(()=>{let p="q-field__input q-placeholder col";return e.hideSelected===!0||E.value.length===0?[p,e.inputClass]:(p+=" q-field__input--padding",e.inputClass===void 0?p:[p,e.inputClass])}),O=computed(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),X=computed(()=>R.value===0),A=computed(()=>E.value.map(p=>ae.value(p)).join(", ")),ee=computed(()=>e.displayValue!==void 0?e.displayValue:A.value),oe=computed(()=>e.optionsHtml===!0?()=>!0:p=>p!=null&&p.html===!0),me=computed(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||E.value.some(oe.value))),se=computed(()=>w.focused.value===!0?e.tabindex:-1),ke=computed(()=>{const p={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-readonly":e.readonly===!0?"true":"false","aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":o.value===!0?"true":"false","aria-controls":`${w.targetUid.value}_lb`};return l.value>=0&&(p["aria-activedescendant"]=`${w.targetUid.value}_${l.value}`),p}),ce=computed(()=>({id:`${w.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"})),fe=computed(()=>E.value.map((p,N)=>({index:N,opt:p,html:oe.value(p),selected:!0,removeAtIndex:Xe,toggleOption:de,tabindex:se.value}))),$e=computed(()=>{if(R.value===0)return[];const{from:p,to:N}=z.value;return e.options.slice(p,N).map((M,F)=>{const Q=pe.value(M)===!0,W=Be(M)===!0,ie=p+F,Z={clickable:!0,active:W,activeClass:we.value,manualFocus:!0,focused:!1,disable:Q,tabindex:-1,dense:e.optionsDense,dark:H.value,role:"option","aria-selected":W===!0?"true":"false",id:`${w.targetUid.value}_${ie}`,onClick:()=>{de(M)}};return Q!==!0&&(l.value===ie&&(Z.focused=!0),i.platform.is.desktop===!0&&(Z.onMousemove=()=>{o.value===!0&&ge(ie)})),{index:ie,opt:M,html:oe.value(M),label:ae.value(M),selected:Z.active,focused:Z.focused,toggleOption:de,setOptionIndex:ge,itemProps:Z}})}),xe=computed(()=>e.dropdownIcon!==void 0?e.dropdownIcon:i.iconSet.arrow.dropdown),Me=computed(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),we=computed(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),ue=computed(()=>Ne(e.optionValue,"value")),ae=computed(()=>Ne(e.optionLabel,"label")),pe=computed(()=>Ne(e.optionDisable,"disable")),Ce=computed(()=>E.value.map(p=>ue.value(p))),Ye=computed(()=>{const p={onInput:je,onChange:V,onKeydown:De,onKeyup:Fe,onKeypress:qe,onFocus:ze,onClick(N){g===!0&&stop(N)}};return p.onCompositionstart=p.onCompositionupdate=p.onCompositionend=V,p});watch(E,p=>{m=p,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&w.innerLoading.value!==!0&&(a.value!==!0&&o.value!==!0||I.value!==!0)&&(b!==!0&&be(),(a.value===!0||o.value===!0)&&ve(""))},{immediate:!0}),watch(()=>e.fillInput,be),watch(o,Ve),watch(R,ct);function Re(p){return e.emitValue===!0?ue.value(p):p}function Pe(p){if(p!==-1&&p<E.value.length)if(e.multiple===!0){const N=e.modelValue.slice();n("remove",{index:p,value:N.splice(p,1)[0]}),n("update:modelValue",N)}else n("update:modelValue",null)}function Xe(p){Pe(p),w.focus()}function Oe(p,N){const M=Re(p);if(e.multiple!==!0){e.fillInput===!0&&Se(ae.value(p),!0,!0),n("update:modelValue",M);return}if(E.value.length===0){n("add",{index:0,value:M}),n("update:modelValue",e.multiple===!0?[M]:M);return}if(N===!0&&Be(p)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const F=e.modelValue.slice();n("add",{index:F.length,value:M}),F.push(M),n("update:modelValue",F)}function de(p,N){if(w.editable.value!==!0||p===void 0||pe.value(p)===!0)return;const M=ue.value(p);if(e.multiple!==!0){N!==!0&&(Se(e.fillInput===!0?ae.value(p):"",!0,!0),he()),B.value!==null&&B.value.focus(),(E.value.length===0||isDeepEqual(ue.value(E.value[0]),M)!==!0)&&n("update:modelValue",e.emitValue===!0?M:p);return}if((g!==!0||s.value===!0)&&w.focus(),ze(),E.value.length===0){const W=e.emitValue===!0?M:p;n("add",{index:0,value:W}),n("update:modelValue",e.multiple===!0?[W]:W);return}const F=e.modelValue.slice(),Q=Ce.value.findIndex(W=>isDeepEqual(W,M));if(Q!==-1)n("remove",{index:Q,value:F.splice(Q,1)[0]});else{if(e.maxValues!==void 0&&F.length>=e.maxValues)return;const W=e.emitValue===!0?M:p;n("add",{index:F.length,value:W}),F.push(W)}n("update:modelValue",F)}function ge(p){if(i.platform.is.desktop!==!0)return;const N=p!==-1&&p<R.value?p:-1;l.value!==N&&(l.value=N)}function Ae(p=1,N){if(o.value===!0){let M=l.value;do M=normalizeToInterval(M+p,-1,R.value-1);while(M!==-1&&M!==l.value&&pe.value(e.options[M])===!0);l.value!==M&&(ge(M),Y(M),N!==!0&&e.useInput===!0&&e.fillInput===!0&&Ee(M>=0?ae.value(e.options[M]):_,!0))}}function Ge(p,N){const M=F=>isDeepEqual(ue.value(F),p);return e.options.find(M)||N.find(M)||p}function Ne(p,N){const M=p!==void 0?p:N;return typeof M=="function"?M:F=>F!==null&&typeof F=="object"&&M in F?F[M]:F}function Be(p){const N=ue.value(p);return Ce.value.find(M=>isDeepEqual(M,N))!==void 0}function ze(p){e.useInput===!0&&B.value!==null&&(p===void 0||B.value===p.target&&p.target.value===A.value)&&B.value.select()}function Le(p){isKeyCode(p,27)===!0&&o.value===!0&&(stop(p),he(),be()),n("keyup",p)}function Fe(p){const{value:N}=p.target;if(p.keyCode!==void 0){Le(p);return}if(p.target.value="",d!==null&&(clearTimeout(d),d=null),f!==null&&(clearTimeout(f),f=null),be(),typeof N=="string"&&N.length!==0){const M=N.toLocaleLowerCase(),F=W=>{const ie=e.options.find(Z=>W.value(Z).toLocaleLowerCase()===M);return ie===void 0?!1:(E.value.indexOf(ie)===-1?de(ie):he(),!0)},Q=W=>{F(ue)!==!0&&(F(ae)===!0||W===!0||ve(N,!0,()=>Q(!0)))};Q()}else w.clearValue(p)}function qe(p){n("keypress",p)}function De(p){if(n("keydown",p),shouldIgnoreKey(p)===!0)return;const N=u.value.length!==0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),M=p.shiftKey!==!0&&e.multiple!==!0&&(l.value!==-1||N===!0);if(p.keyCode===27){prevent(p);return}if(p.keyCode===9&&M===!1){ye();return}if(p.target===void 0||p.target.id!==w.targetUid.value||w.editable.value!==!0)return;if(p.keyCode===40&&w.innerLoading.value!==!0&&o.value===!1){stopAndPrevent(p),_e();return}if(p.keyCode===8&&(e.useChips===!0||e.clearable===!0)&&e.hideSelected!==!0&&u.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?Pe(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&n("update:modelValue",null);return}(p.keyCode===35||p.keyCode===36)&&(typeof u.value!="string"||u.value.length===0)&&(stopAndPrevent(p),l.value=-1,Ae(p.keyCode===36?1:-1,e.multiple)),(p.keyCode===33||p.keyCode===34)&&te.value!==void 0&&(stopAndPrevent(p),l.value=Math.max(-1,Math.min(R.value,l.value+(p.keyCode===33?-1:1)*te.value.view)),Ae(p.keyCode===33?1:-1,e.multiple)),(p.keyCode===38||p.keyCode===40)&&(stopAndPrevent(p),Ae(p.keyCode===38?-1:1,e.multiple));const F=R.value;if((k===void 0||S<Date.now())&&(k=""),F>0&&e.useInput!==!0&&p.key!==void 0&&p.key.length===1&&p.altKey===!1&&p.ctrlKey===!1&&p.metaKey===!1&&(p.keyCode!==32||k.length!==0)){o.value!==!0&&_e(p);const Q=p.key.toLocaleLowerCase(),W=k.length===1&&k[0]===Q;S=Date.now()+1500,W===!1&&(stopAndPrevent(p),k+=Q);const ie=new RegExp("^"+k.split("").map(Te=>reEscapeList.indexOf(Te)!==-1?"\\"+Te:Te).join(".*"),"i");let Z=l.value;if(W===!0||Z<0||ie.test(ae.value(e.options[Z]))!==!0)do Z=normalizeToInterval(Z+1,-1,F-1);while(Z!==l.value&&(pe.value(e.options[Z])===!0||ie.test(ae.value(e.options[Z]))!==!0));l.value!==Z&&nextTick(()=>{ge(Z),Y(Z),Z>=0&&e.useInput===!0&&e.fillInput===!0&&Ee(ae.value(e.options[Z]),!0)});return}if(!(p.keyCode!==13&&(p.keyCode!==32||e.useInput===!0||k!=="")&&(p.keyCode!==9||M===!1))){if(p.keyCode!==9&&stopAndPrevent(p),l.value!==-1&&l.value<F){de(e.options[l.value]);return}if(N===!0){const Q=(W,ie)=>{if(ie){if(validateNewValueMode(ie)!==!0)return}else ie=e.newValueMode;if(Se("",e.multiple!==!0,!0),W==null)return;(ie==="toggle"?de:Oe)(W,ie==="add-unique"),e.multiple!==!0&&(B.value!==null&&B.value.focus(),he())};if(e.onNewValue!==void 0?n("newValue",u.value,Q):Q(u.value),e.multiple!==!0)return}o.value===!0?ye():w.innerLoading.value!==!0&&_e()}}function Ie(){return g===!0?j.value:T.value!==null&&T.value.contentEl!==null?T.value.contentEl:void 0}function Ze(){return Ie()}function Je(){return e.hideSelected===!0?[]:t["selected-item"]!==void 0?fe.value.map(p=>t["selected-item"](p)).slice():t.selected!==void 0?[].concat(t.selected()):e.useChips===!0?fe.value.map((p,N)=>h(QChip,{key:"option-"+N,removable:w.editable.value===!0&&pe.value(p.opt)!==!0,dense:!0,textColor:e.color,tabindex:se.value,onRemove(){p.removeAtIndex(N)}},()=>h("span",{class:"ellipsis",[p.html===!0?"innerHTML":"textContent"]:ae.value(p.opt)}))):[h("span",{[me.value===!0?"innerHTML":"textContent"]:ee.value})]}function He(){if(X.value===!0)return t["no-option"]!==void 0?t["no-option"]({inputValue:u.value}):void 0;const p=t.option!==void 0?t.option:M=>h(QItem,{key:M.index,...M.itemProps},()=>h(QItemSection,()=>h(QItemLabel,()=>h("span",{[M.html===!0?"innerHTML":"textContent"]:M.label}))));let N=ne("div",$e.value.map(p));return t["before-options"]!==void 0&&(N=t["before-options"]().concat(N)),hMergeSlot(t["after-options"],N)}function et(p,N){const M=N===!0?{...ke.value,...w.splitAttrs.attributes.value}:void 0,F={ref:N===!0?B:void 0,key:"i_t",class:q.value,style:e.inputStyle,value:u.value!==void 0?u.value:"",type:"search",...M,id:N===!0?w.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":p===!0||e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,...Ye.value};return p!==!0&&g===!0&&(Array.isArray(F.class)===!0?F.class=[...F.class,"no-pointer-events"]:F.class+=" no-pointer-events"),h("input",F)}function je(p){d!==null&&(clearTimeout(d),d=null),f!==null&&(clearTimeout(f),f=null),!(p&&p.target&&p.target.qComposing===!0)&&(Ee(p.target.value||""),b=!0,_=u.value,w.focused.value!==!0&&(g!==!0||s.value===!0)&&w.focus(),e.onFilter!==void 0&&(d=setTimeout(()=>{d=null,ve(u.value)},e.inputDebounce)))}function Ee(p,N){u.value!==p&&(u.value=p,N===!0||e.inputDebounce===0||e.inputDebounce==="0"?n("inputValue",p):f=setTimeout(()=>{f=null,n("inputValue",p)},e.inputDebounce))}function Se(p,N,M){b=M!==!0,e.useInput===!0&&(Ee(p,!0),(N===!0||M!==!0)&&(_=p),N!==!0&&ve(p))}function ve(p,N,M){if(e.onFilter===void 0||N!==!0&&w.focused.value!==!0)return;w.innerLoading.value===!0?n("filterAbort"):(w.innerLoading.value=!0,c.value=!0),p!==""&&e.multiple!==!0&&E.value.length!==0&&b!==!0&&p===ae.value(E.value[0])&&(p="");const F=setTimeout(()=>{o.value===!0&&(o.value=!1)},10);v!==null&&clearTimeout(v),v=F,n("filter",p,(Q,W)=>{(N===!0||w.focused.value===!0)&&v===F&&(clearTimeout(v),typeof Q=="function"&&Q(),c.value=!1,nextTick(()=>{w.innerLoading.value=!1,w.editable.value===!0&&(N===!0?o.value===!0&&he():o.value===!0?Ve(!0):o.value=!0),typeof W=="function"&&nextTick(()=>{W(r)}),typeof M=="function"&&nextTick(()=>{M(r)})}))},()=>{w.focused.value===!0&&v===F&&(clearTimeout(v),w.innerLoading.value=!1,c.value=!1),o.value===!0&&(o.value=!1)})}function tt(){return h(QMenu,{ref:T,class:O.value,style:e.popupContentStyle,modelValue:o.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&X.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:H.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,noRouteDismiss:e.popupNoRouteDismiss,square:Me.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...ce.value,onScrollPassive:J,onBeforeShow:Ue,onBeforeHide:nt,onShow:rt},He)}function nt(p){We(p),ye()}function rt(){le()}function it(p){stop(p),B.value!==null&&B.value.focus(),s.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function ot(p){stop(p),nextTick(()=>{s.value=!1})}function at(){const p=[h(QField,{class:`col-auto ${w.fieldClass.value}`,...L.value,for:w.targetUid.value,dark:H.value,square:!0,loading:c.value,itemAligned:!1,filled:!0,stackLabel:u.value.length!==0,...w.splitAttrs.listeners.value,onFocus:it,onBlur:ot},{...t,rawControl:()=>w.getControl(!0),before:void 0,after:void 0})];return o.value===!0&&p.push(h("div",{ref:j,class:O.value+" scroll",style:e.popupContentStyle,...ce.value,onClick:prevent,onScrollPassive:J},He())),h(QDialog,{ref:D,modelValue:a.value,position:e.useInput===!0?"top":void 0,transitionShow:$,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,noRouteDismiss:e.popupNoRouteDismiss,onBeforeShow:Ue,onBeforeHide:lt,onHide:st,onShow:ut},()=>h("div",{class:"q-select__dialog"+(H.value===!0?" q-select__dialog--dark q-dark":"")+(s.value===!0?" q-select__dialog--focused":"")},p))}function lt(p){We(p),D.value!==null&&D.value.__updateRefocusTarget(w.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),w.focused.value=!1}function st(p){he(),w.focused.value===!1&&n("blur",p),be()}function ut(){const p=document.activeElement;(p===null||p.id!==w.targetUid.value)&&B.value!==null&&B.value!==p&&B.value.focus(),le()}function ye(){a.value!==!0&&(l.value=-1,o.value===!0&&(o.value=!1),w.focused.value===!1&&(v!==null&&(clearTimeout(v),v=null),w.innerLoading.value===!0&&(n("filterAbort"),w.innerLoading.value=!1,c.value=!1)))}function _e(p){w.editable.value===!0&&(g===!0?(w.onControlFocusin(p),a.value=!0,nextTick(()=>{w.focus()})):w.focus(),e.onFilter!==void 0?ve(u.value):(X.value!==!0||t["no-option"]!==void 0)&&(o.value=!0))}function he(){a.value=!1,ye()}function be(){e.useInput===!0&&Se(e.multiple!==!0&&e.fillInput===!0&&E.value.length!==0&&ae.value(E.value[0])||"",!0,!0)}function Ve(p){let N=-1;if(p===!0){if(E.value.length!==0){const M=ue.value(E.value[0]);N=e.options.findIndex(F=>isDeepEqual(ue.value(F),M))}G(N)}ge(N)}function ct(p,N){o.value===!0&&w.innerLoading.value===!1&&(G(-1,!0),nextTick(()=>{o.value===!0&&w.innerLoading.value===!1&&(p>N?G():Ve(!0))}))}function Ke(){a.value===!1&&T.value!==null&&T.value.updatePosition()}function Ue(p){p!==void 0&&stop(p),n("popupShow",p),w.hasPopupOpen=!0,w.onControlFocusin(p)}function We(p){p!==void 0&&stop(p),n("popupHide",p),w.hasPopupOpen=!1,w.onControlFocusout(p)}function Qe(){g=i.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?t["no-option"]!==void 0||e.onFilter!==void 0||X.value===!1:!0),$=i.platform.is.ios===!0&&g===!0&&e.useInput===!0?"fade":e.transitionShow}return onBeforeUpdate(Qe),onUpdated(Ke),Qe(),onBeforeUnmount(()=>{d!==null&&clearTimeout(d),f!==null&&clearTimeout(f)}),Object.assign(r,{showPopup:_e,hidePopup:he,removeAtIndex:Pe,add:Oe,toggleOption:de,getOptionIndex:()=>l.value,setOptionIndex:ge,moveOptionSelection:Ae,filter:ve,updateMenuPosition:Ke,updateInputValue:Se,isOptionSelected:Be,getEmittingOptionValue:Re,isOptionDisabled:(...p)=>pe.value.apply(null,p)===!0,getOptionValue:(...p)=>ue.value.apply(null,p),getOptionLabel:(...p)=>ae.value.apply(null,p)}),Object.assign(w,{innerValue:E,fieldClass:computed(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:C,targetRef:B,hasValue:I,showPopup:_e,floatingLabel:computed(()=>e.hideSelected!==!0&&I.value===!0||typeof u.value=="number"||u.value.length!==0||fieldValueIsFilled(e.displayValue)),getControlChild:()=>{if(w.editable.value!==!1&&(a.value===!0||X.value!==!0||t["no-option"]!==void 0))return g===!0?at():tt();w.hasPopupOpen===!0&&(w.hasPopupOpen=!1)},controlEvents:{onFocusin(p){w.onControlFocusin(p)},onFocusout(p){w.onControlFocusout(p,()=>{be(),ye()})},onClick(p){if(prevent(p),g!==!0&&o.value===!0){ye(),B.value!==null&&B.value.focus();return}_e(p)}},getControl:p=>{const N=Je(),M=p===!0||a.value!==!0||g!==!0;if(e.useInput===!0)N.push(et(p,M));else if(w.editable.value===!0){const Q=M===!0?ke.value:void 0;N.push(h("input",{ref:M===!0?B:void 0,key:"d_t",class:"q-select__focus-target",id:M===!0?w.targetUid.value:void 0,value:ee.value,readonly:!0,"data-autofocus":p===!0||e.autofocus===!0||void 0,...Q,onKeydown:De,onKeyup:Le,onKeypress:qe})),M===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length!==0&&N.push(h("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:Fe}))}if(U.value!==void 0&&e.disable!==!0&&Ce.value.length!==0){const Q=Ce.value.map(W=>h("option",{value:W,selected:!0}));N.push(h("select",{class:"hidden",name:U.value,multiple:e.multiple},Q))}const F=e.useInput===!0||M!==!0?void 0:w.splitAttrs.attributes.value;return h("div",{class:"q-field__native row items-center",...F,...w.splitAttrs.listeners.value},N)},getInnerAppend:()=>e.loading!==!0&&c.value!==!0&&e.hideDropdownIcon!==!0?[h(QIcon,{class:"q-select__dropdown-icon"+(o.value===!0?" rotate-180":""),name:xe.value})]:null}),useField(w)}});function getPerformances(e,t){const n=Plugin.getItem(LOCALSTORAGE_DB_USER).workouts[e].exercises[t].performances;return n?Object.keys(n).map(r=>({...n[r],id:r})).sort((r,i)=>new Date(i.date)-new Date(r.date)):[]}function getPerformance(e,t,n){const r=Plugin.getItem(LOCALSTORAGE_DB_USER).workouts[e].exercises[t].performances[n];return r?{...r,id:n}:null}function getPerformanceAverage(e,t,n){const r=getPerformance(e,t,n);if(!r||r.series.length===0)return null;const i=r.series.every(l=>l.type===PERFORMANCE_TYPE_DEFAULT);if(!r.series.every(l=>l.type!==PERFORMANCE_TYPE_DEFAULT)&&!i)return null;let a;return i?a=r.series.reduce((l,u)=>Number(l)+Number(u.value),0)/r.series.length:a=r.series.reduce((l,u)=>Number(l)+(u.type===PERFORMANCE_TYPE_BAR?Number(u.value)/2:Number(u.value)),0)/r.series.length,Math.round(a*100)/100}async function addPerformance(e,t,n){const r=uid();n=checkPerformance(n);const i=getUser();return i&&i.uid===USER_GUEST_UID?Plugin.set(LOCALSTORAGE_DB_USER,{...i,workouts:{...i.workouts,[e]:{...i.workouts[e],exercises:{...i.workouts[e].exercises,[t]:{...i.workouts[e].exercises[t],performances:{...i.workouts[e].exercises[t].performances,[r]:{...n,id:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}}}}}}):await createData("users/"+auth.currentUser.uid+"/workouts/"+e+"/exercises/"+t+"/performances/"+r,{...n,id:null}),{...n,id:r}}async function updatePerformance(e,t,n,r){r=checkPerformance(r);const i=getUser();return i&&i.uid===USER_GUEST_UID?Plugin.set(LOCALSTORAGE_DB_USER,{...i,workouts:{...i.workouts,[e]:{...i.workouts[e],exercises:{...i.workouts[e].exercises,[t]:{...i.workouts[e].exercises[t],performances:{...i.workouts[e].exercises[t].performances,[n]:{...i.workouts[e].exercises[t].performances[n],...r,id:null,updatedAt:new Date().toISOString()}}}}}}}):await updateData("users/"+auth.currentUser.uid+"/workouts/"+e+"/exercises/"+t+"/performances/"+n,{...r,id:null}),r}async function deletePerformance(e,t,n){const r=getUser();r&&r.uid===USER_GUEST_UID?Plugin.set(LOCALSTORAGE_DB_USER,{...r,workouts:{...r.workouts,[e]:{...r.workouts[e],exercises:{...r.workouts[e].exercises,[t]:{...r.workouts[e].exercises[t],performances:Object.keys(r.workouts[e].exercises[t].performances).reduce((i,o)=>(o!==n&&(i[o]=r.workouts[e].exercises[t].performances[o]),i),{})}}}}}):await removeData("users/"+auth.currentUser.uid+"/workouts/"+e+"/exercises/"+t+"/performances/"+n)}function checkPerformance(e){if(e={...e,comment:e.comment&&e.comment.trim().length>0?e.comment.trim():null},e.series.length>0){e.series=e.series.filter(r=>r.value!==null&&r.value!==""&&r.value>=0),e.series=e.series.map(r=>({...r,value:Number(r.value)}));const t=e.series.every(r=>r.type===PERFORMANCE_TYPE_DEFAULT);if(!e.series.every(r=>r.type!==PERFORMANCE_TYPE_DEFAULT)&&!t)throw new Error("All series must be of the same type")}return e}var AddPerfExercise_vue_vue_type_style_index_0_scoped_true_lang="";const _sfc_main$4={name:"AddPerfExercise",emits:["reloadPerformances"],props:{workout:{type:Object,required:!0},exercise:{type:Object,required:!0}},data(){return{series:[],types:[{value:PERFORMANCE_TYPE_DEFAULT,label:"D\xE9faut"},{value:PERFORMANCE_TYPE_BAR,label:"Barre"},{value:PERFORMANCE_TYPE_ARM,label:"Bras"}],date:null,comment:null,defaultNumberOfSeries:null}},created(){this.defaultNumberOfSeries=getUser().defaultNumberOfSeries,this.initInputs()},computed:{inputsValid(){const e=this.series.filter(n=>n.value!==null&&n.value!=="").every(n=>n.type.value===PERFORMANCE_TYPE_DEFAULT),t=this.series.filter(n=>n.value!==null&&n.value!=="").every(n=>n.type.value!==PERFORMANCE_TYPE_DEFAULT);return this.series&&this.series.filter(n=>n.value!==null&&n.value!==""&&n.value>=0).length>=1&&(e&&!t||t&&!e)&&this.date}},methods:{initInputs(){this.series=[],this.date=new Date().toISOString().substr(0,10),this.comment=null;for(let e=0;e<this.defaultNumberOfSeries;e++)this.series.push({id:new Date().getTime()+e,value:null,type:this.types[0]})},addSerie(){this.series.push({id:new Date().getTime(),value:null,type:this.types[0]})},removeSerie(e){this.series.length>1&&(this.series=this.series.filter(t=>t.id!==e))},submit(){if(!this.inputsValid)return;const e={date:this.date,series:this.series.map(t=>({value:t.value,type:t.type.value})),comment:this.comment};addPerformance(this.workout.id,this.exercise.id,e).then(()=>{this.$emit("reloadPerformances"),successNotify("Performance ajout\xE9e"),this.initInputs()}).catch(t=>{errorNotify(translatting().translateError(t,"Erreur lors de l'ajout de la performance"))})}}},_hoisted_1$e={class:"flex flex-center column"},_hoisted_2$b={class:"text-h6 text-center"},_hoisted_3$8={key:0,class:"text-center"};function _sfc_render$4(e,t,n,r,i,o){return openBlock(),createElementBlock("div",_hoisted_1$e,[createVNode(QCard,{class:"q-mb-md flex-center column q-px-md"},{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_2$b,toDisplayString(n.workout.label)+" - "+toDisplayString(n.exercise.label),1),n.exercise.config?(openBlock(),createElementBlock("div",_hoisted_3$8," ("+toDisplayString(n.exercise.config)+") ",1)):createCommentVNode("",!0)]),_:1}),createVNode(QSeparator),(openBlock(!0),createElementBlock(Fragment,null,renderList(i.series,a=>(openBlock(),createBlock(QCardSection,{key:a.id,class:"flex justify-center q-py-sm no-wrap"},{default:withCtx(()=>[createVNode(QInput,{name:"value-"+a.id,outlined:"",class:"exercise-input w-40",type:"number",inputmode:"decimal",modelValue:a.value,"onUpdate:modelValue":l=>a.value=l,min:"0",rules:[l=>!l||l>=0||"Veuillez renseigner une valeur positive"],label:"Performance","lazy-rules":"","hide-bottom-space":""},null,8,["name","modelValue","onUpdate:modelValue","rules"]),createVNode(QSelect,{outlined:"",name:"type-"+a.id,modelValue:a.type,"onUpdate:modelValue":l=>a.type=l,options:i.types,label:"Type de performance",class:"w-40","lazy-rules":"",rules:[l=>typeof l=="object"||"Veuillez renseigner un type de performance"],"hide-bottom-space":""},null,8,["name","modelValue","onUpdate:modelValue","options","rules"]),createVNode(QBtn,{color:"negative",icon:"delete",class:"btn-delete q-ml-md",round:"",onClick:l=>o.removeSerie(a.id)},null,8,["onClick"])]),_:2},1024))),128)),createVNode(QCardSection,{class:"q-pt-none q-mb-sm"},{default:withCtx(()=>[createVNode(QBtn,{color:"primary",icon:"add",label:"Ajouter une s\xE9rie",onClick:o.addSerie},null,8,["onClick"])]),_:1}),createVNode(QSeparator),createVNode(QCardSection,{class:"q-pt-none q-mb-sm"},{default:withCtx(()=>[createVNode(QInput,{rounded:"",outlined:"",name:"date",modelValue:i.date,"onUpdate:modelValue":t[0]||(t[0]=a=>i.date=a),type:"date",mask:"date",class:"q-mb-sm","lazy-rules":"",label:"Date de la performance","hide-bottom-space":""},null,8,["modelValue"]),createVNode(QInput,{rounded:"",outlined:"",name:"comment",modelValue:i.comment,"onUpdate:modelValue":t[1]||(t[1]=a=>i.comment=a),type:"text","lazy-rules":"",label:"Commentaire (optionnel)","hide-bottom-space":""},null,8,["modelValue"])]),_:1}),createVNode(QSeparator),createVNode(QCardSection,{class:"q-pt-none q-mb-sm"},{default:withCtx(()=>[createVNode(QBtn,{color:"primary",label:"Ajouter",onClick:o.submit,disable:!o.inputsValid},null,8,["onClick","disable"])]),_:1})]),_:1})])}var AddPerfExercise=_export_sfc(_sfc_main$4,[["render",_sfc_render$4],["__scopeId","data-v-3bff583a"]]),PerformanceList_vue_vue_type_style_index_0_scoped_true_lang="";const _sfc_main$3={name:"PerformanceList",props:{workout:{type:Object,required:!0},exercise:{type:Object,required:!0}},setup(){return{PERFORMANCE_TYPE_DEFAULT,formatting}},data(){return{performances:[],types:[{value:PERFORMANCE_TYPE_DEFAULT,label:"D\xE9faut"},{value:PERFORMANCE_TYPE_BAR,label:"Barre"},{value:PERFORMANCE_TYPE_ARM,label:"Bras"}],editForm:!1,editLoading:!1,performanceToEdit:{},showMore:!1}},created(){this.loadPerformances()},computed:{inputsValid(){const e=this.performanceToEdit.series.filter(n=>n.value!==null&&n.value!=="").every(n=>n.type.value===PERFORMANCE_TYPE_DEFAULT),t=this.performanceToEdit.series.filter(n=>n.value!==null&&n.value!=="").every(n=>n.type.value!==PERFORMANCE_TYPE_DEFAULT);return this.performanceToEdit.series&&this.performanceToEdit.series.filter(n=>n.value!==null&&n.value!==""&&n.value>=0).length>=1&&this.performanceToEdit.date&&(e&&!t||t&&!e)},performancesToShow(){return this.performances.slice(0,this.showMore?this.performances.length:3)}},methods:{getPerfromanceType(e){switch(e){case PERFORMANCE_TYPE_BAR:return"Barre";case PERFORMANCE_TYPE_ARM:return"Bras";default:return"D\xE9faut"}},onEditSubmit(){this.editLoading=!0,updatePerformance(this.workout.id,this.exercise.id,this.performanceToEdit.id,{series:this.performanceToEdit.series.map(e=>({...e,value:e.value,type:e.type.value})),date:this.performanceToEdit.date,comment:this.performanceToEdit.comment}).then(()=>{this.$emit("reloadPerformances"),successNotify("Votre performance a bien \xE9t\xE9 modifi\xE9e"),this.editForm=!1,this.editLoading=!1}).catch(e=>{this.editLoading=!1,errorNotify(translatting().translateError(e,"Une erreur est survenue lors de l'\xE9dition de votre performance"))})},addSerie(){this.performanceToEdit.series.push({id:new Date().getTime(),value:null,type:this.types[0]})},removeSerie(e){this.performanceToEdit.series.length>1&&(this.performanceToEdit.series=this.performanceToEdit.series.filter(t=>t.id!==e))},edit(e){this.performanceToEdit={comment:null,...e,series:e.series.map(t=>({...t,type:this.types.find(n=>n.value===t.type)}))},this.editForm=!0},loadPerformances(){this.performances=getPerformances(this.workout.id,this.exercise.id)},showDeleteModal(e){let t=!1;Dialog.create({title:"Suppression de la performance",message:"\xCAtes-vous s\xFBr de vouloir supprimer votre performance du "+formatting().dateToDisplay(e.date)+" ?",ok:{label:"Supprimer",color:"negative",loading:t},cancel:{label:"Annuler",color:"primary"}}).onOk(()=>{t=!0,deletePerformance(this.workout.id,this.exercise.id,e.id).then(()=>{this.$emit("reloadPerformances"),successNotify("Votre performance a bien \xE9t\xE9 supprim\xE9e")}).catch(n=>{t=!1,errorNotify("Une erreur est survenue lors de la suppression de votre performance")})}).onCancel(()=>{})}}},_hoisted_1$d={class:"column flex-center"},_hoisted_2$a={class:"flex flex-center performance-list"},_hoisted_3$7={class:"text-h6"},_hoisted_4$4={key:0,class:"text-center"},_hoisted_5$4={class:"text-h6 text-center"};function _sfc_render$3(e,t,n,r,i,o){return openBlock(),createElementBlock("div",_hoisted_1$d,[createBaseVNode("div",_hoisted_2$a,[(openBlock(!0),createElementBlock(Fragment,null,renderList(o.performancesToShow,a=>(openBlock(),createBlock(QCard,{key:a.id,onClick:l=>e.$emit("selectWorkout",a),class:"flex-center column q-px-md"},{default:withCtx(()=>[createVNode(QCardSection,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_3$7,toDisplayString(r.formatting().dateToDisplay(a.date)),1)]),_:2},1024),createVNode(QCardSection,{class:"column flex-center"},{default:withCtx(()=>[createTextVNode(toDisplayString(a.series.map(l=>l.value+(l.type===r.PERFORMANCE_TYPE_DEFAULT?"":" ("+o.getPerfromanceType(l.type)+")")).join(" - "))+" ",1),a.comment?(openBlock(),createElementBlock("div",_hoisted_4$4,toDisplayString(a.comment),1)):createCommentVNode("",!0)]),_:2},1024),createVNode(QCardActions,{horizontal:"",class:"no-wrap q-pa-none"},{default:withCtx(()=>[createVNode(QBtn,{flat:"",round:"",color:"primary",icon:"edit",onClick:withModifiers(l=>o.edit(a),["stop"])},null,8,["onClick"]),createVNode(QBtn,{flat:"",round:"",color:"negative",icon:"delete",onClick:withModifiers(l=>o.showDeleteModal(a),["stop"])},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),i.performances.length>3?(openBlock(),createBlock(QBtn,{key:0,color:"primary",label:i.showMore?"Voir moins":"Voir plus",onClick:t[0]||(t[0]=a=>i.showMore=!i.showMore),class:"q-mt-xl"},null,8,["label"])):createCommentVNode("",!0),createVNode(QDialog,{modelValue:i.editForm,"onUpdate:modelValue":t[3]||(t[3]=a=>i.editForm=a)},{default:withCtx(()=>[createVNode(QCard,{class:"q-pa-md"},{default:withCtx(()=>[createVNode(QCardSection,{align:"center"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_5$4,"Modifier la performance du "+toDisplayString(r.formatting().dateToDisplay(i.performanceToEdit.date)),1)]),_:1}),(openBlock(!0),createElementBlock(Fragment,null,renderList(i.performanceToEdit.series,a=>(openBlock(),createBlock(QCardSection,{align:"center",key:a.id,class:"flex flex-center q-py-sm no-wrap"},{default:withCtx(()=>[createVNode(QInput,{name:"value-"+a.id,outlined:"",class:"exercise-input w-40",type:"number",inputmode:"decimal",modelValue:a.value,"onUpdate:modelValue":l=>a.value=l,min:"0",rules:[l=>!l||l>=0||"Veuillez renseigner une valeur positive"],label:"Performance","lazy-rules":"","hide-bottom-space":""},null,8,["name","modelValue","onUpdate:modelValue","rules"]),createVNode(QSelect,{outlined:"",name:"type-"+a.id,modelValue:a.type,"onUpdate:modelValue":l=>a.type=l,options:i.types,label:"Type de performance",class:"w-40","lazy-rules":"",rules:[l=>typeof l=="object"||"Veuillez renseigner un type de performance"],"hide-bottom-space":""},null,8,["name","modelValue","onUpdate:modelValue","options","rules"]),createVNode(QBtn,{color:"negative",icon:"delete",class:"btn-delete q-ml-md",round:"",onClick:l=>o.removeSerie(a.id)},null,8,["onClick"])]),_:2},1024))),128)),createVNode(QCardSection,{align:"center",class:"q-pt-none q-mb-sm"},{default:withCtx(()=>[createVNode(QBtn,{color:"primary",icon:"add",label:"Ajouter une s\xE9rie",onClick:o.addSerie},null,8,["onClick"])]),_:1}),createVNode(QCardSection,{align:"center",class:"q-pt-none q-mb-sm"},{default:withCtx(()=>[createVNode(QInput,{rounded:"",outlined:"",name:"date",modelValue:i.performanceToEdit.date,"onUpdate:modelValue":t[1]||(t[1]=a=>i.performanceToEdit.date=a),type:"date",mask:"date",class:"q-mb-sm","lazy-rules":"",label:"Date de la performance","hide-bottom-space":""},null,8,["modelValue"]),createVNode(QInput,{rounded:"",outlined:"",name:"comment",modelValue:i.performanceToEdit.comment,"onUpdate:modelValue":t[2]||(t[2]=a=>i.performanceToEdit.comment=a),type:"text","lazy-rules":"",label:"Commentaire (optionnel)","hide-bottom-space":""},null,8,["modelValue"])]),_:1}),createVNode(QCardSection,{align:"center",class:"q-pt-none q-mb-sm"},{default:withCtx(()=>[createVNode(QBtn,{color:"primary",label:"Confirmer",onClick:o.onEditSubmit,loading:i.editLoading,disable:!o.inputsValid},null,8,["onClick","loading","disable"])]),_:1}),createVNode(QCardActions,{align:"center"},{default:withCtx(()=>[withDirectives(createVNode(QBtn,{label:"Annuler",color:"negative"},null,512),[[ClosePopup]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var PerformanceList=_export_sfc(_sfc_main$3,[["render",_sfc_render$3],["__scopeId","data-v-939164c6"]]);function _isPlaceholder(e){return e!=null&&typeof e=="object"&&e["@@functional/placeholder"]===!0}function _curry1(e){return function t(n){return arguments.length===0||_isPlaceholder(n)?t:e.apply(this,arguments)}}function _curry2(e){return function t(n,r){switch(arguments.length){case 0:return t;case 1:return _isPlaceholder(n)?t:_curry1(function(i){return e(n,i)});default:return _isPlaceholder(n)&&_isPlaceholder(r)?t:_isPlaceholder(n)?_curry1(function(i){return e(i,r)}):_isPlaceholder(r)?_curry1(function(i){return e(n,i)}):e(n,r)}}}function _arity(e,t){switch(e){case 0:return function(){return t.apply(this,arguments)};case 1:return function(n){return t.apply(this,arguments)};case 2:return function(n,r){return t.apply(this,arguments)};case 3:return function(n,r,i){return t.apply(this,arguments)};case 4:return function(n,r,i,o){return t.apply(this,arguments)};case 5:return function(n,r,i,o,a){return t.apply(this,arguments)};case 6:return function(n,r,i,o,a,l){return t.apply(this,arguments)};case 7:return function(n,r,i,o,a,l,u){return t.apply(this,arguments)};case 8:return function(n,r,i,o,a,l,u,s){return t.apply(this,arguments)};case 9:return function(n,r,i,o,a,l,u,s,c){return t.apply(this,arguments)};case 10:return function(n,r,i,o,a,l,u,s,c,d){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function _curryN(e,t,n){return function(){for(var r=[],i=0,o=e,a=0;a<t.length||i<arguments.length;){var l;a<t.length&&(!_isPlaceholder(t[a])||i>=arguments.length)?l=t[a]:(l=arguments[i],i+=1),r[a]=l,_isPlaceholder(l)||(o-=1),a+=1}return o<=0?n.apply(this,r):_arity(o,_curryN(e,r,n))}}var curryN=_curry2(function(t,n){return t===1?_curry1(n):_arity(t,_curryN(t,[],n))});function _curry3(e){return function t(n,r,i){switch(arguments.length){case 0:return t;case 1:return _isPlaceholder(n)?t:_curry2(function(o,a){return e(n,o,a)});case 2:return _isPlaceholder(n)&&_isPlaceholder(r)?t:_isPlaceholder(n)?_curry2(function(o,a){return e(o,r,a)}):_isPlaceholder(r)?_curry2(function(o,a){return e(n,o,a)}):_curry1(function(o){return e(n,r,o)});default:return _isPlaceholder(n)&&_isPlaceholder(r)&&_isPlaceholder(i)?t:_isPlaceholder(n)&&_isPlaceholder(r)?_curry2(function(o,a){return e(o,a,i)}):_isPlaceholder(n)&&_isPlaceholder(i)?_curry2(function(o,a){return e(o,r,a)}):_isPlaceholder(r)&&_isPlaceholder(i)?_curry2(function(o,a){return e(n,o,a)}):_isPlaceholder(n)?_curry1(function(o){return e(o,r,i)}):_isPlaceholder(r)?_curry1(function(o){return e(n,o,i)}):_isPlaceholder(i)?_curry1(function(o){return e(n,r,o)}):e(n,r,i)}}}var _isArray=Array.isArray||function(t){return t!=null&&t.length>=0&&Object.prototype.toString.call(t)==="[object Array]"};function _isTransformer(e){return e!=null&&typeof e["@@transducer/step"]=="function"}function _dispatchable(e,t,n){return function(){if(arguments.length===0)return n();var r=arguments[arguments.length-1];if(!_isArray(r)){for(var i=0;i<e.length;){if(typeof r[e[i]]=="function")return r[e[i]].apply(r,Array.prototype.slice.call(arguments,0,-1));i+=1}if(_isTransformer(r)){var o=t.apply(null,Array.prototype.slice.call(arguments,0,-1));return o(r)}}return n.apply(this,arguments)}}var _xfBase={init:function(){return this.xf["@@transducer/init"]()},result:function(e){return this.xf["@@transducer/result"](e)}};function _map(e,t){for(var n=0,r=t.length,i=Array(r);n<r;)i[n]=e(t[n]),n+=1;return i}function _isString(e){return Object.prototype.toString.call(e)==="[object String]"}var _isArrayLike=_curry1(function(t){return _isArray(t)?!0:!t||typeof t!="object"||_isString(t)?!1:t.length===0?!0:t.length>0?t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1):!1}),XWrap=function(){function e(t){this.f=t}return e.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},e.prototype["@@transducer/result"]=function(t){return t},e.prototype["@@transducer/step"]=function(t,n){return this.f(t,n)},e}();function _xwrap(e){return new XWrap(e)}var bind=_curry2(function(t,n){return _arity(t.length,function(){return t.apply(n,arguments)})});function _arrayReduce(e,t,n){for(var r=0,i=n.length;r<i;){if(t=e["@@transducer/step"](t,n[r]),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r+=1}return e["@@transducer/result"](t)}function _iterableReduce(e,t,n){for(var r=n.next();!r.done;){if(t=e["@@transducer/step"](t,r.value),t&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r=n.next()}return e["@@transducer/result"](t)}function _methodReduce(e,t,n,r){return e["@@transducer/result"](n[r](bind(e["@@transducer/step"],e),t))}var symIterator=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator";function _reduce(e,t,n){if(typeof e=="function"&&(e=_xwrap(e)),_isArrayLike(n))return _arrayReduce(e,t,n);if(typeof n["fantasy-land/reduce"]=="function")return _methodReduce(e,t,n,"fantasy-land/reduce");if(n[symIterator]!=null)return _iterableReduce(e,t,n[symIterator]());if(typeof n.next=="function")return _iterableReduce(e,t,n);if(typeof n.reduce=="function")return _methodReduce(e,t,n,"reduce");throw new TypeError("reduce: list must be array or iterable")}var XMap=function(){function e(t,n){this.xf=n,this.f=t}return e.prototype["@@transducer/init"]=_xfBase.init,e.prototype["@@transducer/result"]=_xfBase.result,e.prototype["@@transducer/step"]=function(t,n){return this.xf["@@transducer/step"](t,this.f(n))},e}(),_xmap=_curry2(function(t,n){return new XMap(t,n)});function _has(e,t){return Object.prototype.hasOwnProperty.call(t,e)}var toString$1=Object.prototype.toString,_isArguments=function(){return toString$1.call(arguments)==="[object Arguments]"?function(t){return toString$1.call(t)==="[object Arguments]"}:function(t){return _has("callee",t)}}(),hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],hasArgsEnumBug=function(){return arguments.propertyIsEnumerable("length")}(),contains=function(t,n){for(var r=0;r<t.length;){if(t[r]===n)return!0;r+=1}return!1},keys=_curry1(typeof Object.keys=="function"&&!hasArgsEnumBug?function(t){return Object(t)!==t?[]:Object.keys(t)}:function(t){if(Object(t)!==t)return[];var n,r,i=[],o=hasArgsEnumBug&&_isArguments(t);for(n in t)_has(n,t)&&(!o||n!=="length")&&(i[i.length]=n);if(hasEnumBug)for(r=nonEnumerableProps.length-1;r>=0;)n=nonEnumerableProps[r],_has(n,t)&&!contains(i,n)&&(i[i.length]=n),r-=1;return i}),map$1=_curry2(_dispatchable(["fantasy-land/map","map"],_xmap,function(t,n){switch(Object.prototype.toString.call(n)){case"[object Function]":return curryN(n.length,function(){return t.call(this,n.apply(this,arguments))});case"[object Object]":return _reduce(function(r,i){return r[i]=t(n[i]),r},{},keys(n));default:return _map(t,n)}})),map$2=map$1,_isInteger=Number.isInteger||function(t){return t<<0===t},nth=_curry2(function(t,n){var r=t<0?n.length+t:t;return _isString(n)?n.charAt(r):n[r]}),nth$1=nth,prop=_curry2(function(t,n){if(n!=null)return _isInteger(t)?nth$1(t,n):n[t]}),prop$1=prop,reduce=_curry3(_reduce),reduce$1=reduce,values=_curry1(function(t){for(var n=keys(t),r=n.length,i=[],o=0;o<r;)i[o]=t[n[o]],o+=1;return i}),values$1=values;function _isFunction(e){var t=Object.prototype.toString.call(e);return t==="[object Function]"||t==="[object AsyncFunction]"||t==="[object GeneratorFunction]"||t==="[object AsyncGeneratorFunction]"}var type=_curry1(function(t){return t===null?"Null":t===void 0?"Undefined":Object.prototype.toString.call(t).slice(8,-1)});function _pipe(e,t){return function(){return t.call(this,e.apply(this,arguments))}}function _checkForMethod(e,t){return function(){var n=arguments.length;if(n===0)return t();var r=arguments[n-1];return _isArray(r)||typeof r[e]!="function"?t.apply(this,arguments):r[e].apply(r,Array.prototype.slice.call(arguments,0,n-1))}}var slice=_curry3(_checkForMethod("slice",function(t,n,r){return Array.prototype.slice.call(r,t,n)})),tail=_curry1(_checkForMethod("tail",slice(1,1/0))),tail$1=tail;function pipe(){if(arguments.length===0)throw new Error("pipe requires at least one argument");return _arity(arguments[0].length,reduce$1(_pipe,arguments[0],tail$1(arguments)))}function _arrayFromIterator(e){for(var t=[],n;!(n=e.next()).done;)t.push(n.value);return t}function _includesWith(e,t,n){for(var r=0,i=n.length;r<i;){if(e(t,n[r]))return!0;r+=1}return!1}function _functionName(e){var t=String(e).match(/^function (\w*)/);return t==null?"":t[1]}function _objectIs(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var _objectIs$1=typeof Object.is=="function"?Object.is:_objectIs;function _uniqContentEquals(e,t,n,r){var i=_arrayFromIterator(e),o=_arrayFromIterator(t);function a(l,u){return _equals(l,u,n.slice(),r.slice())}return!_includesWith(function(l,u){return!_includesWith(a,u,l)},o,i)}function _equals(e,t,n,r){if(_objectIs$1(e,t))return!0;var i=type(e);if(i!==type(t))return!1;if(typeof e["fantasy-land/equals"]=="function"||typeof t["fantasy-land/equals"]=="function")return typeof e["fantasy-land/equals"]=="function"&&e["fantasy-land/equals"](t)&&typeof t["fantasy-land/equals"]=="function"&&t["fantasy-land/equals"](e);if(typeof e.equals=="function"||typeof t.equals=="function")return typeof e.equals=="function"&&e.equals(t)&&typeof t.equals=="function"&&t.equals(e);switch(i){case"Arguments":case"Array":case"Object":if(typeof e.constructor=="function"&&_functionName(e.constructor)==="Promise")return e===t;break;case"Boolean":case"Number":case"String":if(!(typeof e==typeof t&&_objectIs$1(e.valueOf(),t.valueOf())))return!1;break;case"Date":if(!_objectIs$1(e.valueOf(),t.valueOf()))return!1;break;case"Error":return e.name===t.name&&e.message===t.message;case"RegExp":if(!(e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.sticky===t.sticky&&e.unicode===t.unicode))return!1;break}for(var o=n.length-1;o>=0;){if(n[o]===e)return r[o]===t;o-=1}switch(i){case"Map":return e.size!==t.size?!1:_uniqContentEquals(e.entries(),t.entries(),n.concat([e]),r.concat([t]));case"Set":return e.size!==t.size?!1:_uniqContentEquals(e.values(),t.values(),n.concat([e]),r.concat([t]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var a=keys(e);if(a.length!==keys(t).length)return!1;var l=n.concat([e]),u=r.concat([t]);for(o=a.length-1;o>=0;){var s=a[o];if(!(_has(s,t)&&_equals(t[s],e[s],l,u)))return!1;o-=1}return!0}var equals=_curry2(function(t,n){return _equals(t,n,[],[])});function _indexOf(e,t,n){var r,i;if(typeof e.indexOf=="function")switch(typeof t){case"number":if(t===0){for(r=1/t;n<e.length;){if(i=e[n],i===0&&1/i===r)return n;n+=1}return-1}else if(t!==t){for(;n<e.length;){if(i=e[n],typeof i=="number"&&i!==i)return n;n+=1}return-1}return e.indexOf(t,n);case"string":case"boolean":case"function":case"undefined":return e.indexOf(t,n);case"object":if(t===null)return e.indexOf(t,n)}for(;n<e.length;){if(equals(e[n],t))return n;n+=1}return-1}function _includes(e,t){return _indexOf(t,e,0)>=0}function _quote(e){var t=e.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0");return'"'+t.replace(/"/g,'\\"')+'"'}var pad=function(t){return(t<10?"0":"")+t},_toISOString=typeof Date.prototype.toISOString=="function"?function(t){return t.toISOString()}:function(t){return t.getUTCFullYear()+"-"+pad(t.getUTCMonth()+1)+"-"+pad(t.getUTCDate())+"T"+pad(t.getUTCHours())+":"+pad(t.getUTCMinutes())+":"+pad(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};function _complement(e){return function(){return!e.apply(this,arguments)}}function _filter(e,t){for(var n=0,r=t.length,i=[];n<r;)e(t[n])&&(i[i.length]=t[n]),n+=1;return i}function _isObject(e){return Object.prototype.toString.call(e)==="[object Object]"}var XFilter=function(){function e(t,n){this.xf=n,this.f=t}return e.prototype["@@transducer/init"]=_xfBase.init,e.prototype["@@transducer/result"]=_xfBase.result,e.prototype["@@transducer/step"]=function(t,n){return this.f(n)?this.xf["@@transducer/step"](t,n):t},e}(),_xfilter=_curry2(function(t,n){return new XFilter(t,n)}),filter$1=_curry2(_dispatchable(["fantasy-land/filter","filter"],_xfilter,function(e,t){return _isObject(t)?_reduce(function(n,r){return e(t[r])&&(n[r]=t[r]),n},{},keys(t)):_filter(e,t)})),reject=_curry2(function(t,n){return filter$1(_complement(t),n)});function _toString(e,t){var n=function(a){var l=t.concat([e]);return _includes(a,l)?"<Circular>":_toString(a,l)},r=function(o,a){return _map(function(l){return _quote(l)+": "+n(o[l])},a.slice().sort())};switch(Object.prototype.toString.call(e)){case"[object Arguments]":return"(function() { return arguments; }("+_map(n,e).join(", ")+"))";case"[object Array]":return"["+_map(n,e).concat(r(e,reject(function(o){return/^\d+$/.test(o)},keys(e)))).join(", ")+"]";case"[object Boolean]":return typeof e=="object"?"new Boolean("+n(e.valueOf())+")":e.toString();case"[object Date]":return"new Date("+(isNaN(e.valueOf())?n(NaN):_quote(_toISOString(e)))+")";case"[object Null]":return"null";case"[object Number]":return typeof e=="object"?"new Number("+n(e.valueOf())+")":1/e===-1/0?"-0":e.toString(10);case"[object String]":return typeof e=="object"?"new String("+n(e.valueOf())+")":_quote(e);case"[object Undefined]":return"undefined";default:if(typeof e.toString=="function"){var i=e.toString();if(i!=="[object Object]")return i}return"{"+r(e,keys(e)).join(", ")+"}"}}var toString=_curry1(function(t){return _toString(t,[])}),curry=_curry1(function(t){return curryN(t.length,t)}),curry$1=curry,invoker=_curry2(function(t,n){return curryN(t+1,function(){var r=arguments[t];if(r!=null&&_isFunction(r[n]))return r[n].apply(r,Array.prototype.slice.call(arguments,0,t));throw new TypeError(toString(r)+' does not have a method named "'+n+'"')})}),invoker$1=invoker,is=_curry2(function(t,n){return n instanceof t||n!=null&&(n.constructor===t||t.name==="Object"&&typeof n=="object")}),is$1=is,join=invoker$1(1,"join"),join$1=join,mergeWithKey=_curry3(function(t,n,r){var i={},o;for(o in n)_has(o,n)&&(i[o]=_has(o,r)?t(o,n[o],r[o]):n[o]);for(o in r)_has(o,r)&&!_has(o,i)&&(i[o]=r[o]);return i}),mergeDeepWithKey=_curry3(function e(t,n,r){return mergeWithKey(function(i,o,a){return _isObject(o)&&_isObject(a)?e(t,o,a):t(i,o,a)},n,r)}),mergeDeepLeft=_curry2(function(t,n){return mergeDeepWithKey(function(r,i,o){return i},t,n)}),mergeDeepLeft$1=mergeDeepLeft,omit=_curry2(function(t,n){for(var r={},i={},o=0,a=t.length;o<a;)i[t[o]]=1,o+=1;for(var l in n)i.hasOwnProperty(l)||(r[l]=n[l]);return r}),omit$1=omit,pickBy=_curry2(function(t,n){var r={};for(var i in n)t(n[i],i,n)&&(r[i]=n[i]);return r}),pickBy$1=pickBy,split=invoker$1(1,"split"),split$1=split,toLower=invoker$1(0,"toLowerCase"),toLower$1=toLower,zipObj=_curry2(function(t,n){for(var r=0,i=Math.min(t.length,n.length),o={};r<i;)o[t[r]]=n[r],r+=1;return o}),zipObj$1=zipObj;pipe(toLower$1,split$1(" "),join$1("-"));const getCol=curry$1((e,t)=>is$1(Number)?map$2(n=>nth$1(e,n)||"",t).filter(n=>n!==""):map$2(prop$1(e),t)),mapKeys=(e,t)=>zipObj$1(map$2(e,keys(t)),values$1(t)),kebabize=e=>e.split("").map((t,n)=>t.toUpperCase()===t?`${n!==0?"-":""}${t.toLowerCase()}`:t).join("");function ascending$1(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function descending$1(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function bisector(e){let t,n,r;e.length!==2?(t=ascending$1,n=(l,u)=>ascending$1(e(l),u),r=(l,u)=>e(l)-u):(t=e===ascending$1||e===descending$1?e:zero$1,n=e,r=e);function i(l,u,s=0,c=l.length){if(s<c){if(t(u,u)!==0)return c;do{const d=s+c>>>1;n(l[d],u)<0?s=d+1:c=d}while(s<c)}return s}function o(l,u,s=0,c=l.length){if(s<c){if(t(u,u)!==0)return c;do{const d=s+c>>>1;n(l[d],u)<=0?s=d+1:c=d}while(s<c)}return s}function a(l,u,s=0,c=l.length){const d=i(l,u,s,c-1);return d>s&&r(l[d-1],u)>-r(l[d],u)?d-1:d}return{left:i,center:a,right:o}}function zero$1(){return 0}function number$2(e){return e===null?NaN:+e}const ascendingBisect=bisector(ascending$1),bisectRight=ascendingBisect.right,bisectCenter=bisector(number$2).center;function extent(e,t){let n,r;if(t===void 0)for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of e)(o=t(o,++i,e))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class InternMap extends Map{constructor(t,n=keyof){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(intern_get(this,t))}has(t){return super.has(intern_get(this,t))}set(t,n){return super.set(intern_set(this,t),n)}delete(t){return super.delete(intern_delete(this,t))}}function intern_get({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function intern_set({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function intern_delete({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function keyof(e){return e!==null&&typeof e=="object"?e.valueOf():e}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=e10?10:o>=e5?5:o>=e2?2:1;let l,u,s;return i<0?(s=Math.pow(10,-i)/a,l=Math.round(e*s),u=Math.round(t*s),l/s<e&&++l,u/s>t&&--u,s=-s):(s=Math.pow(10,i)*a,l=Math.round(e/s),u=Math.round(t/s),l*s<e&&++l,u*s>t&&--u),u<l&&.5<=n&&n<2?tickSpec(e,t,n*2):[l,u,s]}function ticks(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,o,a]=r?tickSpec(t,e,n):tickSpec(e,t,n);if(!(o>=i))return[];const l=o-i+1,u=new Array(l);if(r)if(a<0)for(let s=0;s<l;++s)u[s]=(o-s)/-a;else for(let s=0;s<l;++s)u[s]=(o-s)*a;else if(a<0)for(let s=0;s<l;++s)u[s]=(i+s)/-a;else for(let s=0;s<l;++s)u[s]=(i+s)*a;return u}function tickIncrement(e,t,n){return t=+t,e=+e,n=+n,tickSpec(e,t,n)[2]}function tickStep(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?tickIncrement(t,e,n):tickIncrement(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function max$1(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function min$1(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function range(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,o=new Array(i);++r<i;)o[r]=e+r*n;return o}function initRange(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function initInterpolator(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const implicit=Symbol("implicit");function ordinal(){var e=new InternMap,t=[],n=[],r=implicit;function i(o){let a=e.get(o);if(a===void 0){if(r!==implicit)return r;e.set(o,a=t.push(o)-1)}return n[a%n.length]}return i.domain=function(o){if(!arguments.length)return t.slice();t=[],e=new InternMap;for(const a of o)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return ordinal(t,n).unknown(r)},initRange.apply(i,arguments),i}function band(){var e=ordinal().unknown(void 0),t=e.domain,n=e.range,r=0,i=1,o,a,l=!1,u=0,s=0,c=.5;delete e.unknown;function d(){var f=t().length,m=i<r,g=m?i:r,b=m?r:i;o=(b-g)/Math.max(1,f-u+s*2),l&&(o=Math.floor(o)),g+=(b-g-o*(f-u))*c,a=o*(1-u),l&&(g=Math.round(g),a=Math.round(a));var v=range(f).map(function(_){return g+o*_});return n(m?v.reverse():v)}return e.domain=function(f){return arguments.length?(t(f),d()):t()},e.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,d()):[r,i]},e.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,l=!0,d()},e.bandwidth=function(){return a},e.step=function(){return o},e.round=function(f){return arguments.length?(l=!!f,d()):l},e.padding=function(f){return arguments.length?(u=Math.min(1,s=+f),d()):u},e.paddingInner=function(f){return arguments.length?(u=Math.min(1,f),d()):u},e.paddingOuter=function(f){return arguments.length?(s=+f,d()):s},e.align=function(f){return arguments.length?(c=Math.max(0,Math.min(1,f)),d()):c},e.copy=function(){return band(t(),[r,i]).round(l).paddingInner(u).paddingOuter(s).align(c)},initRange.apply(d(),arguments)}function define(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function extend(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=reHex.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?rgbn(t):n===3?new Rgb(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?rgba(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?rgba(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=reRgbInteger.exec(e))?new Rgb(t[1],t[2],t[3],1):(t=reRgbPercent.exec(e))?new Rgb(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=reRgbaInteger.exec(e))?rgba(t[1],t[2],t[3],t[4]):(t=reRgbaPercent.exec(e))?rgba(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=reHslPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,1):(t=reHslaPercent.exec(e))?hsla(t[1],t[2]/100,t[3]/100,t[4]):named.hasOwnProperty(e)?rgbn(named[e]):e==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,e&255,1)}function rgba(e,t,n,r){return r<=0&&(e=t=n=NaN),new Rgb(e,t,n,r)}function rgbConvert(e){return e instanceof Color||(e=color(e)),e?(e=e.rgb(),new Rgb(e.r,e.g,e.b,e.opacity)):new Rgb}function rgb$1(e,t,n,r){return arguments.length===1?rgbConvert(e):new Rgb(e,t,n,r==null?1:r)}function Rgb(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}define(Rgb,rgb$1,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const e=clampa(this.opacity);return`${e===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${e===1?")":`, ${e})`}`}function clampa(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function clampi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function hex(e){return e=clampi(e),(e<16?"0":"")+e.toString(16)}function hsla(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Hsl(e,t,n,r)}function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),a=NaN,l=o-i,u=(o+i)/2;return l?(t===o?a=(n-r)/l+(n<r)*6:n===o?a=(r-t)/l+2:a=(t-n)/l+4,l/=u<.5?o+i:2-o-i,a*=60):l=u>0&&u<1?0:a,new Hsl(a,l,u,e.opacity)}function hsl(e,t,n,r){return arguments.length===1?hslConvert(e):new Hsl(e,t,n,r==null?1:r)}function Hsl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}define(Hsl,hsl,extend(Color,{brighter(e){return e=e==null?brighter:Math.pow(brighter,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?darker:Math.pow(darker,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Rgb(hsl2rgb(e>=240?e-240:e+120,i,r),hsl2rgb(e,i,r),hsl2rgb(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=clampa(this.opacity);return`${e===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function clamph(e){return e=(e||0)%360,e<0?e+360:e}function clampt(e){return Math.max(0,Math.min(1,e||0))}function hsl2rgb(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const radians=Math.PI/180,degrees=180/Math.PI,K=18,Xn=.96422,Yn=1,Zn=.82521,t0=4/29,t1=6/29,t2=3*t1*t1,t3=t1*t1*t1;function labConvert(e){if(e instanceof Lab)return new Lab(e.l,e.a,e.b,e.opacity);if(e instanceof Hcl)return hcl2lab(e);e instanceof Rgb||(e=rgbConvert(e));var t=rgb2lrgb(e.r),n=rgb2lrgb(e.g),r=rgb2lrgb(e.b),i=xyz2lab((.2225045*t+.7168786*n+.0606169*r)/Yn),o,a;return t===n&&n===r?o=a=i:(o=xyz2lab((.4360747*t+.3850649*n+.1430804*r)/Xn),a=xyz2lab((.0139322*t+.0971045*n+.7141733*r)/Zn)),new Lab(116*i-16,500*(o-i),200*(i-a),e.opacity)}function lab(e,t,n,r){return arguments.length===1?labConvert(e):new Lab(e,t,n,r==null?1:r)}function Lab(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}define(Lab,lab,extend(Color,{brighter(e){return new Lab(this.l+K*(e==null?1:e),this.a,this.b,this.opacity)},darker(e){return new Lab(this.l-K*(e==null?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Xn*lab2xyz(t),e=Yn*lab2xyz(e),n=Zn*lab2xyz(n),new Rgb(lrgb2rgb(3.1338561*t-1.6168667*e-.4906146*n),lrgb2rgb(-.9787684*t+1.9161415*e+.033454*n),lrgb2rgb(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function xyz2lab(e){return e>t3?Math.pow(e,1/3):e/t2+t0}function lab2xyz(e){return e>t1?e*e*e:t2*(e-t0)}function lrgb2rgb(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function rgb2lrgb(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function hclConvert(e){if(e instanceof Hcl)return new Hcl(e.h,e.c,e.l,e.opacity);if(e instanceof Lab||(e=labConvert(e)),e.a===0&&e.b===0)return new Hcl(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*degrees;return new Hcl(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function hcl$1(e,t,n,r){return arguments.length===1?hclConvert(e):new Hcl(e,t,n,r==null?1:r)}function Hcl(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function hcl2lab(e){if(isNaN(e.h))return new Lab(e.l,0,0,e.opacity);var t=e.h*radians;return new Lab(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}define(Hcl,hcl$1,extend(Color,{brighter(e){return new Hcl(this.h,this.c,this.l+K*(e==null?1:e),this.opacity)},darker(e){return new Hcl(this.h,this.c,this.l-K*(e==null?1:e),this.opacity)},rgb(){return hcl2lab(this).rgb()}}));var constant$3=e=>()=>e;function linear$1(e,t){return function(n){return e+n*t}}function exponential(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function hue(e,t){var n=t-e;return n?linear$1(e,n>180||n<-180?n-360*Math.round(n/360):n):constant$3(isNaN(e)?t:e)}function gamma(e){return(e=+e)==1?nogamma:function(t,n){return n-t?exponential(t,n,e):constant$3(isNaN(t)?n:t)}}function nogamma(e,t){var n=t-e;return n?linear$1(e,n):constant$3(isNaN(e)?t:e)}var rgb=function e(t){var n=gamma(t);function r(i,o){var a=n((i=rgb$1(i)).r,(o=rgb$1(o)).r),l=n(i.g,o.g),u=n(i.b,o.b),s=nogamma(i.opacity,o.opacity);return function(c){return i.r=a(c),i.g=l(c),i.b=u(c),i.opacity=s(c),i+""}}return r.gamma=e,r}(1);function numberArray(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=e[i]*(1-o)+t[i]*o;return r}}function isNumberArray(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function genericArray(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=interpolate(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(l){for(a=0;a<r;++a)o[a]=i[a](l);return o}}function date(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function interpolateNumber(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function object(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=interpolate(e[i],t[i]):r[i]=t[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero(e){return function(){return e}}function one(e){return function(t){return e(t)+""}}function string(e,t){var n=reA.lastIndex=reB.lastIndex=0,r,i,o,a=-1,l=[],u=[];for(e=e+"",t=t+"";(r=reA.exec(e))&&(i=reB.exec(t));)(o=i.index)>n&&(o=t.slice(n,o),l[a]?l[a]+=o:l[++a]=o),(r=r[0])===(i=i[0])?l[a]?l[a]+=i:l[++a]=i:(l[++a]=null,u.push({i:a,x:interpolateNumber(r,i)})),n=reB.lastIndex;return n<t.length&&(o=t.slice(n),l[a]?l[a]+=o:l[++a]=o),l.length<2?u[0]?one(u[0].x):zero(t):(t=u.length,function(s){for(var c=0,d;c<t;++c)l[(d=u[c]).i]=d.x(s);return l.join("")})}function interpolate(e,t){var n=typeof t,r;return t==null||n==="boolean"?constant$3(t):(n==="number"?interpolateNumber:n==="string"?(r=color(t))?(t=r,rgb):string:t instanceof color?rgb:t instanceof Date?date:isNumberArray(t)?numberArray:Array.isArray(t)?genericArray:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?object:interpolateNumber)(e,t)}function interpolateRound(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function hcl(e){return function(t,n){var r=e((t=hcl$1(t)).h,(n=hcl$1(n)).h),i=nogamma(t.c,n.c),o=nogamma(t.l,n.l),a=nogamma(t.opacity,n.opacity);return function(l){return t.h=r(l),t.c=i(l),t.l=o(l),t.opacity=a(l),t+""}}}var interpolateHcl=hcl(hue);function constants(e){return function(){return e}}function number$1(e){return+e}var unit=[0,1];function identity$3(e){return e}function normalize$1(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:constants(isNaN(t)?NaN:.5)}function clamper(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function bimap(e,t,n){var r=e[0],i=e[1],o=t[0],a=t[1];return i<r?(r=normalize$1(i,r),o=n(a,o)):(r=normalize$1(r,i),o=n(o,a)),function(l){return o(r(l))}}function polymap(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),o=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=normalize$1(e[a],e[a+1]),o[a]=n(t[a],t[a+1]);return function(l){var u=bisectRight(e,l,1,r)-1;return o[u](i[u](l))}}function copy$1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function transformer$1(){var e=unit,t=unit,n=interpolate,r,i,o,a=identity$3,l,u,s;function c(){var f=Math.min(e.length,t.length);return a!==identity$3&&(a=clamper(e[0],e[f-1])),l=f>2?polymap:bimap,u=s=null,d}function d(f){return f==null||isNaN(f=+f)?o:(u||(u=l(e.map(r),t,n)))(r(a(f)))}return d.invert=function(f){return a(i((s||(s=l(t,e.map(r),interpolateNumber)))(f)))},d.domain=function(f){return arguments.length?(e=Array.from(f,number$1),c()):e.slice()},d.range=function(f){return arguments.length?(t=Array.from(f),c()):t.slice()},d.rangeRound=function(f){return t=Array.from(f),n=interpolateRound,c()},d.clamp=function(f){return arguments.length?(a=f?!0:identity$3,c()):a!==identity$3},d.interpolate=function(f){return arguments.length?(n=f,c()):n},d.unknown=function(f){return arguments.length?(o=f,d):o},function(f,m){return r=f,i=m,c()}}function continuous(){return transformer$1()(identity$3,identity$3)}function formatDecimal(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function formatDecimalParts(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function exponent(e){return e=formatDecimalParts(Math.abs(e)),e?e[1]:NaN}function formatGroup(e,t){return function(n,r){for(var i=n.length,o=[],a=0,l=e[0],u=0;i>0&&l>0&&(u+l+1>r&&(l=Math.max(1,r-u)),o.push(n.substring(i-=l,i+l)),!((u+=l+1)>r));)l=e[a=(a+1)%e.length];return o.reverse().join(t)}}function formatNumerals(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(e){if(!(t=re.exec(e)))throw new Error("invalid format: "+e);var t;return new FormatSpecifier({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(e){e:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var prefixExponent;function formatPrefixAuto(e,t){var n=formatDecimalParts(e,t);if(!n)return e+"";var r=n[0],i=n[1],o=i-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+formatDecimalParts(e,Math.max(0,t+o-1))[0]}function formatRounded(e,t){var n=formatDecimalParts(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}var formatTypes={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:formatDecimal,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>formatRounded(e*100,t),r:formatRounded,s:formatPrefixAuto,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function identity$2(e){return e}var map=Array.prototype.map,prefixes=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function formatLocale(e){var t=e.grouping===void 0||e.thousands===void 0?identity$2:formatGroup(map.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?identity$2:formatNumerals(map.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"\u2212":e.minus+"",u=e.nan===void 0?"NaN":e.nan+"";function s(d){d=formatSpecifier(d);var f=d.fill,m=d.align,g=d.sign,b=d.symbol,v=d.zero,_=d.width,$=d.comma,k=d.precision,S=d.trim,C=d.type;C==="n"?($=!0,C="g"):formatTypes[C]||(k===void 0&&(k=12),S=!0,C="g"),(v||f==="0"&&m==="=")&&(v=!0,f="0",m="=");var B=b==="$"?n:b==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",T=b==="$"?r:/[%p]/.test(C)?a:"",D=formatTypes[C],j=/[defgprs%]/.test(C);k=k===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function U(V){var R=B,P=T,z,te,G;if(C==="c")P=D(V)+P,V="";else{V=+V;var ne=V<0||1/V<0;if(V=isNaN(V)?u:D(Math.abs(V),k),S&&(V=formatTrim(V)),ne&&+V==0&&g!=="+"&&(ne=!1),R=(ne?g==="("?g:l:g==="-"||g==="("?"":g)+R,P=(C==="s"?prefixes[8+prefixExponent/3]:"")+P+(ne&&g==="("?")":""),j){for(z=-1,te=V.length;++z<te;)if(G=V.charCodeAt(z),48>G||G>57){P=(G===46?i+V.slice(z+1):V.slice(z))+P,V=V.slice(0,z);break}}}$&&!v&&(V=t(V,1/0));var J=R.length+V.length+P.length,Y=J<_?new Array(_-J+1).join(f):"";switch($&&v&&(V=t(Y+V,Y.length?_-P.length:1/0),Y=""),m){case"<":V=R+V+P+Y;break;case"=":V=R+Y+V+P;break;case"^":V=Y.slice(0,J=Y.length>>1)+R+V+P+Y.slice(J);break;default:V=Y+R+V+P;break}return o(V)}return U.toString=function(){return d+""},U}function c(d,f){var m=s((d=formatSpecifier(d),d.type="f",d)),g=Math.max(-8,Math.min(8,Math.floor(exponent(f)/3)))*3,b=Math.pow(10,-g),v=prefixes[8+g/3];return function(_){return m(b*_)+v}}return{format:s,formatPrefix:c}}var locale,format,formatPrefix;defaultLocale({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale(e){return locale=formatLocale(e),format=locale.format,formatPrefix=locale.formatPrefix,locale}function precisionFixed(e){return Math.max(0,-exponent(Math.abs(e)))}function precisionPrefix(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent(t)/3)))*3-exponent(Math.abs(e)))}function precisionRound(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,exponent(t)-exponent(e))+1}function tickFormat(e,t,n,r){var i=tickStep(e,t,n),o;switch(r=formatSpecifier(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(o=precisionPrefix(i,a))&&(r.precision=o),formatPrefix(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=precisionRound(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=precisionFixed(i))&&(r.precision=o-(r.type==="%")*2);break}}return format(r)}function linearish(e){var t=e.domain;return e.ticks=function(n){var r=t();return ticks(r[0],r[r.length-1],n==null?10:n)},e.tickFormat=function(n,r){var i=t();return tickFormat(i[0],i[i.length-1],n==null?10:n,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,o=r.length-1,a=r[i],l=r[o],u,s,c=10;for(l<a&&(s=a,a=l,l=s,s=i,i=o,o=s);c-- >0;){if(s=tickIncrement(a,l,n),s===u)return r[i]=a,r[o]=l,t(r);if(s>0)a=Math.floor(a/s)*s,l=Math.ceil(l/s)*s;else if(s<0)a=Math.ceil(a*s)/s,l=Math.floor(l*s)/s;else break;u=s}return e},e}function linear(){var e=continuous();return e.copy=function(){return copy$1(e,linear())},initRange.apply(e,arguments),linearish(e)}function transformer(){var e=0,t=1,n,r,i,o,a=identity$3,l=!1,u;function s(d){return d==null||isNaN(d=+d)?u:a(i===0?.5:(d=(o(d)-n)*i,l?Math.max(0,Math.min(1,d)):d))}s.domain=function(d){return arguments.length?([e,t]=d,n=o(e=+e),r=o(t=+t),i=n===r?0:1/(r-n),s):[e,t]},s.clamp=function(d){return arguments.length?(l=!!d,s):l},s.interpolator=function(d){return arguments.length?(a=d,s):a};function c(d){return function(f){var m,g;return arguments.length?([m,g]=f,a=d(m,g),s):[a(0),a(1)]}}return s.range=c(interpolate),s.rangeRound=c(interpolateRound),s.unknown=function(d){return arguments.length?(u=d,s):u},function(d){return o=d,n=d(e),r=d(t),i=n===r?0:1/(r-n),s}}function copy(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function sequential(){var e=linearish(transformer()(identity$3));return e.copy=function(){return copy(e,sequential())},initInterpolator.apply(e,arguments)}class Scale{constructor(e){this.config=e,this.createScale(e.type)}createScale(e){switch(e){case"band":this.scale=band();break;case"linear":this.scale=linear();break}}changeConfig(e){this.createScale(e.type),this.config=e}get type(){return this.config.type}bandwidth(){return this.type==="band"?this.scale.bandwidth():0}updateRange(e){this.scale=this.scale.copy().range(e)}updateDomain(e,t,n){const r=this.config.type==="band"?this.categoryDomain(e,n):this.numericDomain(e,t,n);this.scale=this.scale.copy().domain(r)}map(e){return e.map(t=>this.mapOne(t))}mapOne(e){const{type:t}=this.config;return t==="band"?this.scale(e)+this.scale.bandwidth()/2:this.scale(e)}ticks(){const{type:e}=this.config;return this.config.tickValues!==void 0?this.config.tickValues:e==="band"?this.scale.domain():this.scale.ticks(this.config.ticks||5)}categoryDomain(e,t){const n=t.reduce((r,i)=>r.concat(getCol(i,e)),[]);return Array.from(new Set(n))}numericDomain(data,stackedData,keys){const{domain}=this.config,values=keys.reduce((e,t)=>e.concat(getCol(t,data)),[]),valueMax=max$1(stackedData,e=>max$1(e,t=>max$1(t)))||0,valueMin=min$1(stackedData,e=>min$1(e,t=>min$1(t)))||0,[dataMin,dataMax]=extent(Array.from(new Set(values.concat([valueMin,valueMax])))),yMin=eval(`
      let dataMin = ${dataMin||0}
      ${domain[0]}
    `),yMax=eval(`
      let dataMax = ${dataMax||0}
      ${domain[1]}
    `);return[yMin,yMax]}}class Scales{constructor(t){this.config=t,this.primary=new Scale(t.primary),this.secondary=new Scale(t.secondary)}changeConfig(t){this.config=t,this.primary.changeConfig(t.primary),this.secondary.changeConfig(t.secondary)}updateRange(t,n){n==="horizontal"?(this.primary.updateRange([t.x,t.width]),this.secondary.updateRange([t.height,t.y])):n==="vertical"&&(this.primary.updateRange([t.y,t.height]),this.secondary.updateRange([t.x,t.width]))}updateDomain(t,n,r){this.primary.updateDomain(t,n,getCol(0,r)),this.secondary.updateDomain(t,n,getCol(1,r))}}function constant$2(e){return function(){return e}}const abs=Math.abs,atan2=Math.atan2,cos=Math.cos,max=Math.max,min=Math.min,sin=Math.sin,sqrt=Math.sqrt,epsilon$2=1e-12,pi$1=Math.PI,halfPi=pi$1/2,tau$1=2*pi$1;function acos(e){return e>1?0:e<-1?pi$1:Math.acos(e)}function asin(e){return e>=1?halfPi:e<=-1?-halfPi:Math.asin(e)}const pi=Math.PI,tau=2*pi,epsilon$1=1e-6,tauEpsilon=tau-epsilon$1;function append(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function appendRound(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return append;const n=10**t;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Path{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?append:appendRound(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,o,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(t,n,r,i,o){if(t=+t,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,l=this._y1,u=r-t,s=i-n,c=a-t,d=l-n,f=c*c+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>epsilon$1)if(!(Math.abs(d*u-s*c)>epsilon$1)||!o)this._append`L${this._x1=t},${this._y1=n}`;else{let m=r-a,g=i-l,b=u*u+s*s,v=m*m+g*g,_=Math.sqrt(b),$=Math.sqrt(f),k=o*Math.tan((pi-Math.acos((b+f-v)/(2*_*$)))/2),S=k/$,C=k/_;Math.abs(S-1)>epsilon$1&&this._append`L${t+S*c},${n+S*d}`,this._append`A${o},${o},0,0,${+(d*m>c*g)},${this._x1=t+C*u},${this._y1=n+C*s}`}}arc(t,n,r,i,o,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let l=r*Math.cos(i),u=r*Math.sin(i),s=t+l,c=n+u,d=1^a,f=a?i-o:o-i;this._x1===null?this._append`M${s},${c}`:(Math.abs(this._x1-s)>epsilon$1||Math.abs(this._y1-c)>epsilon$1)&&this._append`L${s},${c}`,r&&(f<0&&(f=f%tau+tau),f>tauEpsilon?this._append`A${r},${r},0,1,${d},${t-l},${n-u}A${r},${r},0,1,${d},${this._x1=s},${this._y1=c}`:f>epsilon$1&&this._append`A${r},${r},0,${+(f>=pi)},${d},${this._x1=t+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function withPath(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new Path(t)}function arcInnerRadius(e){return e.innerRadius}function arcOuterRadius(e){return e.outerRadius}function arcStartAngle(e){return e.startAngle}function arcEndAngle(e){return e.endAngle}function arcPadAngle(e){return e&&e.padAngle}function intersect(e,t,n,r,i,o,a,l){var u=n-e,s=r-t,c=a-i,d=l-o,f=d*u-c*s;if(!(f*f<epsilon$2))return f=(c*(t-o)-d*(e-i))/f,[e+f*u,t+f*s]}function cornerTangents(e,t,n,r,i,o,a){var l=e-n,u=t-r,s=(a?o:-o)/sqrt(l*l+u*u),c=s*u,d=-s*l,f=e+c,m=t+d,g=n+c,b=r+d,v=(f+g)/2,_=(m+b)/2,$=g-f,k=b-m,S=$*$+k*k,C=i-o,B=f*b-g*m,T=(k<0?-1:1)*sqrt(max(0,C*C*S-B*B)),D=(B*k-$*T)/S,j=(-B*$-k*T)/S,U=(B*k+$*T)/S,V=(-B*$+k*T)/S,R=D-v,P=j-_,z=U-v,te=V-_;return R*R+P*P>z*z+te*te&&(D=U,j=V),{cx:D,cy:j,x01:-c,y01:-d,x11:D*(i/C-1),y11:j*(i/C-1)}}function arc(){var e=arcInnerRadius,t=arcOuterRadius,n=constant$2(0),r=null,i=arcStartAngle,o=arcEndAngle,a=arcPadAngle,l=null,u=withPath(s);function s(){var c,d,f=+e.apply(this,arguments),m=+t.apply(this,arguments),g=i.apply(this,arguments)-halfPi,b=o.apply(this,arguments)-halfPi,v=abs(b-g),_=b>g;if(l||(l=c=u()),m<f&&(d=m,m=f,f=d),!(m>epsilon$2))l.moveTo(0,0);else if(v>tau$1-epsilon$2)l.moveTo(m*cos(g),m*sin(g)),l.arc(0,0,m,g,b,!_),f>epsilon$2&&(l.moveTo(f*cos(b),f*sin(b)),l.arc(0,0,f,b,g,_));else{var $=g,k=b,S=g,C=b,B=v,T=v,D=a.apply(this,arguments)/2,j=D>epsilon$2&&(r?+r.apply(this,arguments):sqrt(f*f+m*m)),U=min(abs(m-f)/2,+n.apply(this,arguments)),V=U,R=U,P,z;if(j>epsilon$2){var te=asin(j/f*sin(D)),G=asin(j/m*sin(D));(B-=te*2)>epsilon$2?(te*=_?1:-1,S+=te,C-=te):(B=0,S=C=(g+b)/2),(T-=G*2)>epsilon$2?(G*=_?1:-1,$+=G,k-=G):(T=0,$=k=(g+b)/2)}var ne=m*cos($),J=m*sin($),Y=f*cos(C),le=f*sin(C);if(U>epsilon$2){var w=m*cos(k),E=m*sin(k),L=f*cos(S),H=f*sin(S),I;if(v<pi$1)if(I=intersect(ne,J,L,H,w,E,Y,le)){var q=ne-I[0],O=J-I[1],X=w-I[0],A=E-I[1],ee=1/sin(acos((q*X+O*A)/(sqrt(q*q+O*O)*sqrt(X*X+A*A)))/2),oe=sqrt(I[0]*I[0]+I[1]*I[1]);V=min(U,(f-oe)/(ee-1)),R=min(U,(m-oe)/(ee+1))}else V=R=0}T>epsilon$2?R>epsilon$2?(P=cornerTangents(L,H,ne,J,m,R,_),z=cornerTangents(w,E,Y,le,m,R,_),l.moveTo(P.cx+P.x01,P.cy+P.y01),R<U?l.arc(P.cx,P.cy,R,atan2(P.y01,P.x01),atan2(z.y01,z.x01),!_):(l.arc(P.cx,P.cy,R,atan2(P.y01,P.x01),atan2(P.y11,P.x11),!_),l.arc(0,0,m,atan2(P.cy+P.y11,P.cx+P.x11),atan2(z.cy+z.y11,z.cx+z.x11),!_),l.arc(z.cx,z.cy,R,atan2(z.y11,z.x11),atan2(z.y01,z.x01),!_))):(l.moveTo(ne,J),l.arc(0,0,m,$,k,!_)):l.moveTo(ne,J),!(f>epsilon$2)||!(B>epsilon$2)?l.lineTo(Y,le):V>epsilon$2?(P=cornerTangents(Y,le,w,E,f,-V,_),z=cornerTangents(ne,J,L,H,f,-V,_),l.lineTo(P.cx+P.x01,P.cy+P.y01),V<U?l.arc(P.cx,P.cy,V,atan2(P.y01,P.x01),atan2(z.y01,z.x01),!_):(l.arc(P.cx,P.cy,V,atan2(P.y01,P.x01),atan2(P.y11,P.x11),!_),l.arc(0,0,f,atan2(P.cy+P.y11,P.cx+P.x11),atan2(z.cy+z.y11,z.cx+z.x11),_),l.arc(z.cx,z.cy,V,atan2(z.y11,z.x11),atan2(z.y01,z.x01),!_))):l.arc(0,0,f,C,S,_)}if(l.closePath(),c)return l=null,c+""||null}return s.centroid=function(){var c=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,d=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-pi$1/2;return[cos(d)*c,sin(d)*c]},s.innerRadius=function(c){return arguments.length?(e=typeof c=="function"?c:constant$2(+c),s):e},s.outerRadius=function(c){return arguments.length?(t=typeof c=="function"?c:constant$2(+c),s):t},s.cornerRadius=function(c){return arguments.length?(n=typeof c=="function"?c:constant$2(+c),s):n},s.padRadius=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:constant$2(+c),s):r},s.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:constant$2(+c),s):i},s.endAngle=function(c){return arguments.length?(o=typeof c=="function"?c:constant$2(+c),s):o},s.padAngle=function(c){return arguments.length?(a=typeof c=="function"?c:constant$2(+c),s):a},s.context=function(c){return arguments.length?(l=c==null?null:c,s):l},s}function array$1(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Linear(e){this._context=e}Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function curveLinear(e){return new Linear(e)}function x(e){return e[0]}function y(e){return e[1]}function line(e,t){var n=constant$2(!0),r=null,i=curveLinear,o=null,a=withPath(l);e=typeof e=="function"?e:e===void 0?x:constant$2(e),t=typeof t=="function"?t:t===void 0?y:constant$2(t);function l(u){var s,c=(u=array$1(u)).length,d,f=!1,m;for(r==null&&(o=i(m=a())),s=0;s<=c;++s)!(s<c&&n(d=u[s],s,u))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+e(d,s,u),+t(d,s,u));if(m)return o=null,m+""||null}return l.x=function(u){return arguments.length?(e=typeof u=="function"?u:constant$2(+u),l):e},l.y=function(u){return arguments.length?(t=typeof u=="function"?u:constant$2(+u),l):t},l.defined=function(u){return arguments.length?(n=typeof u=="function"?u:constant$2(!!u),l):n},l.curve=function(u){return arguments.length?(i=u,r!=null&&(o=i(r)),l):i},l.context=function(u){return arguments.length?(u==null?r=o=null:o=i(r=u),l):r},l}function area(e,t,n){var r=null,i=constant$2(!0),o=null,a=curveLinear,l=null,u=withPath(s);e=typeof e=="function"?e:e===void 0?x:constant$2(+e),t=typeof t=="function"?t:constant$2(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?y:constant$2(+n);function s(d){var f,m,g,b=(d=array$1(d)).length,v,_=!1,$,k=new Array(b),S=new Array(b);for(o==null&&(l=a($=u())),f=0;f<=b;++f){if(!(f<b&&i(v=d[f],f,d))===_)if(_=!_)m=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),g=f-1;g>=m;--g)l.point(k[g],S[g]);l.lineEnd(),l.areaEnd()}_&&(k[f]=+e(v,f,d),S[f]=+t(v,f,d),l.point(r?+r(v,f,d):k[f],n?+n(v,f,d):S[f]))}if($)return l=null,$+""||null}function c(){return line().defined(i).curve(a).context(o)}return s.x=function(d){return arguments.length?(e=typeof d=="function"?d:constant$2(+d),r=null,s):e},s.x0=function(d){return arguments.length?(e=typeof d=="function"?d:constant$2(+d),s):e},s.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:constant$2(+d),s):r},s.y=function(d){return arguments.length?(t=typeof d=="function"?d:constant$2(+d),n=null,s):t},s.y0=function(d){return arguments.length?(t=typeof d=="function"?d:constant$2(+d),s):t},s.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:constant$2(+d),s):n},s.lineX0=s.lineY0=function(){return c().x(e).y(t)},s.lineY1=function(){return c().x(e).y(n)},s.lineX1=function(){return c().x(r).y(t)},s.defined=function(d){return arguments.length?(i=typeof d=="function"?d:constant$2(!!d),s):i},s.curve=function(d){return arguments.length?(a=d,o!=null&&(l=a(o)),s):a},s.context=function(d){return arguments.length?(d==null?o=l=null:l=a(o=d),s):o},s}function descending(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function identity$1(e){return e}function pie(){var e=identity$1,t=descending,n=null,r=constant$2(0),i=constant$2(tau$1),o=constant$2(0);function a(l){var u,s=(l=array$1(l)).length,c,d,f=0,m=new Array(s),g=new Array(s),b=+r.apply(this,arguments),v=Math.min(tau$1,Math.max(-tau$1,i.apply(this,arguments)-b)),_,$=Math.min(Math.abs(v)/s,o.apply(this,arguments)),k=$*(v<0?-1:1),S;for(u=0;u<s;++u)(S=g[m[u]=u]=+e(l[u],u,l))>0&&(f+=S);for(t!=null?m.sort(function(C,B){return t(g[C],g[B])}):n!=null&&m.sort(function(C,B){return n(l[C],l[B])}),u=0,d=f?(v-s*k)/f:0;u<s;++u,b=_)c=m[u],S=g[c],_=b+(S>0?S*d:0)+k,g[c]={data:l[c],index:u,value:S,startAngle:b,endAngle:_,padAngle:$};return g}return a.value=function(l){return arguments.length?(e=typeof l=="function"?l:constant$2(+l),a):e},a.sortValues=function(l){return arguments.length?(t=l,n=null,a):t},a.sort=function(l){return arguments.length?(n=l,t=null,a):n},a.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:constant$2(+l),a):r},a.endAngle=function(l){return arguments.length?(i=typeof l=="function"?l:constant$2(+l),a):i},a.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:constant$2(+l),a):o},a}function sign(e){return e<0?-1:1}function slope3(e,t,n){var r=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),l=(o*i+a*r)/(r+i);return(sign(o)+sign(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(l))||0}function slope2(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function point(e,t,n){var r=e._x0,i=e._y0,o=e._x1,a=e._y1,l=(o-r)/3;e._context.bezierCurveTo(r+l,i+l*t,o-l,a-l*n,o,a)}function MonotoneX(e){this._context=e}MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point(this,this._t0,slope2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,point(this,slope2(this,n=slope3(this,e,t)),n);break;default:point(this,this._t0,n=slope3(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function MonotoneY(e){this._context=new ReflectContext(e)}(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(e,t){MonotoneX.prototype.point.call(this,t,e)};function ReflectContext(e){this._context=e}ReflectContext.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,o){this._context.bezierCurveTo(t,e,r,n,o,i)}};function monotoneX(e){return new MonotoneX(e)}function monotoneY(e){return new MonotoneY(e)}function Natural(e){this._context=e}Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=controlPoints(e),i=controlPoints(t),o=0,a=1;a<n;++o,++a)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function controlPoints(e){var t,n=e.length-1,r,i=new Array(n),o=new Array(n),a=new Array(n);for(i[0]=0,o[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,o[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,o[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/o[t-1],o[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/o[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/o[t];for(o[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)o[t]=2*e[t+1]-i[t+1];return[i,o]}function curveNatural(e){return new Natural(e)}function Step(e,t){this._context=e,this._t=t}Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function curveStep(e){return new Step(e,.5)}function stepAfter(e){return new Step(e,1)}function none$1(e,t){if((a=e.length)>1)for(var n=1,r,i,o=e[t[0]],a,l=o.length;n<a;++n)for(i=o,o=e[t[n]],r=0;r<l;++r)o[r][1]+=o[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function stackOrderNone(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function stackValue(e,t){return e[t]}function stackSeries(e){const t=[];return t.key=e,t}function stack(){var e=constant$2([]),t=stackOrderNone,n=none$1,r=stackValue;function i(o){var a=Array.from(e.apply(this,arguments),stackSeries),l,u=a.length,s=-1,c;for(const d of o)for(l=0,++s;l<u;++l)(a[l][s]=[0,+r(d,a[l].key,s,o)]).data=d;for(l=0,c=array$1(t(a));l<u;++l)a[c[l]].index=l;return n(a,c),a}return i.keys=function(o){return arguments.length?(e=typeof o=="function"?o:constant$2(Array.from(o)),i):e},i.value=function(o){return arguments.length?(r=typeof o=="function"?o:constant$2(+o),i):r},i.order=function(o){return arguments.length?(t=o==null?stackOrderNone:typeof o=="function"?o:constant$2(Array.from(o)),i):t},i.offset=function(o){return arguments.length?(n=o==null?none$1:o,i):n},i}const defaultConfig={size:{width:500,height:400},margin:{top:0,right:0,bottom:0,left:0},direction:"horizontal",axis:{primary:{domain:["dataMin","dataMax"],type:"band"},secondary:{domain:["dataMin","dataMax"],type:"linear"}},axisSpace:{x:40,y:20}};class Chart{constructor(t,n){this.data=t,this.layers=[],this.config=mergeDeepLeft$1(pickBy$1(r=>r!==void 0,n),defaultConfig),this.scales=new Scales(this.config.axis),this.updates=ref(0)}get bandScale(){return this.scales.primary.type==="band"?this.scales.primary:this.scales.secondary.type==="band"?this.scales.secondary:null}get canvas(){const{margin:t,size:n}=this.config,r=this.config.axisSpace;return this.config.axis.primary.hide&&(r.y=0),this.config.axis.secondary.hide&&(r.x=0),{x:t.left+r.x,y:t.top,width:n.width-t.right,height:n.height-t.bottom-r.y}}getStackedData(t){return stack().keys(t).order(stackOrderNone)(this.data)}changeData(t){this.data=t,this.update("data")}changeConfig(t){this.config=mergeDeepLeft$1(pickBy$1(n=>n!==void 0,t),this.config),this.scales.changeConfig(this.config.axis),this.update("config")}addLayer(t){this.layers.push(t),this.update("layers")}removeLayer(t){this.layers=this.layers.filter(n=>n.id!==t),this.update("layers")}getLayers(t){return t?this.layers.filter(n=>n.type===t):this.layers}getData(t){return t.reduce((n,r)=>n.concat(getCol(r,this.data)),[])}getKeys(t=-1,n=null){const r=this.layers.filter(i=>n?i.type===n:!0).map(i=>i.dataKeys);return t===-1?r:getCol(t,r)}getStackedKeys(t=-1,n=null){const r=this.layers.filter(i=>n?i.type===n&&i.props.stacked:i.props.stacked).map(i=>i.dataKeys);return t===-1?r:getCol(t,r)}update(t){const n=this.getStackedData(this.getStackedKeys(1));this.scales.updateRange(this.canvas,this.config.direction),this.scales.updateDomain(this.data,n,this.getKeys()),this.updates.value+=1}}var xhtml="http://www.w3.org/1999/xhtml",namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),namespaces.hasOwnProperty(t)?{space:namespaces[t],local:e}:e}function creatorInherit(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===xhtml&&t.documentElement.namespaceURI===xhtml?t.createElement(e):t.createElementNS(n,e)}}function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function creator(e){var t=namespace(e);return(t.local?creatorFixed:creatorInherit)(t)}function none(){}function selector(e){return e==null?none:function(){return this.querySelector(e)}}function selection_select(e){typeof e!="function"&&(e=selector(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,l=r[i]=new Array(a),u,s,c=0;c<a;++c)(u=o[c])&&(s=e.call(u,u.__data__,c,o))&&("__data__"in u&&(s.__data__=u.__data__),l[c]=s);return new Selection(r,this._parents)}function array(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function empty(){return[]}function selectorAll(e){return e==null?empty:function(){return this.querySelectorAll(e)}}function arrayAll(e){return function(){return array(e.apply(this,arguments))}}function selection_selectAll(e){typeof e=="function"?e=arrayAll(e):e=selectorAll(e);for(var t=this._groups,n=t.length,r=[],i=[],o=0;o<n;++o)for(var a=t[o],l=a.length,u,s=0;s<l;++s)(u=a[s])&&(r.push(e.call(u,u.__data__,s,a)),i.push(u));return new Selection(r,i)}function matcher(e){return function(){return this.matches(e)}}function childMatcher(e){return function(t){return t.matches(e)}}var find=Array.prototype.find;function childFind(e){return function(){return find.call(this.children,e)}}function childFirst(){return this.firstElementChild}function selection_selectChild(e){return this.select(e==null?childFirst:childFind(typeof e=="function"?e:childMatcher(e)))}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(e){return function(){return filter.call(this.children,e)}}function selection_selectChildren(e){return this.selectAll(e==null?children:childrenFilter(typeof e=="function"?e:childMatcher(e)))}function selection_filter(e){typeof e!="function"&&(e=matcher(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var o=t[i],a=o.length,l=r[i]=[],u,s=0;s<a;++s)(u=o[s])&&e.call(u,u.__data__,s,o)&&l.push(u);return new Selection(r,this._parents)}function sparse(e){return new Array(e.length)}function selection_enter(){return new Selection(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}EnterNode.prototype={constructor:EnterNode,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function constant$1(e){return function(){return e}}function bindIndex(e,t,n,r,i,o){for(var a=0,l,u=t.length,s=o.length;a<s;++a)(l=t[a])?(l.__data__=o[a],r[a]=l):n[a]=new EnterNode(e,o[a]);for(;a<u;++a)(l=t[a])&&(i[a]=l)}function bindKey(e,t,n,r,i,o,a){var l,u,s=new Map,c=t.length,d=o.length,f=new Array(c),m;for(l=0;l<c;++l)(u=t[l])&&(f[l]=m=a.call(u,u.__data__,l,t)+"",s.has(m)?i[l]=u:s.set(m,u));for(l=0;l<d;++l)m=a.call(e,o[l],l,o)+"",(u=s.get(m))?(r[l]=u,u.__data__=o[l],s.delete(m)):n[l]=new EnterNode(e,o[l]);for(l=0;l<c;++l)(u=t[l])&&s.get(f[l])===u&&(i[l]=u)}function datum(e){return e.__data__}function selection_data(e,t){if(!arguments.length)return Array.from(this,datum);var n=t?bindKey:bindIndex,r=this._parents,i=this._groups;typeof e!="function"&&(e=constant$1(e));for(var o=i.length,a=new Array(o),l=new Array(o),u=new Array(o),s=0;s<o;++s){var c=r[s],d=i[s],f=d.length,m=arraylike(e.call(c,c&&c.__data__,s,r)),g=m.length,b=l[s]=new Array(g),v=a[s]=new Array(g),_=u[s]=new Array(f);n(c,d,b,v,_,m,t);for(var $=0,k=0,S,C;$<g;++$)if(S=b[$]){for($>=k&&(k=$+1);!(C=v[k])&&++k<g;);S._next=C||null}}return a=new Selection(a,r),a._enter=l,a._exit=u,a}function arraylike(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function selection_exit(){return new Selection(this._exit||this._groups.map(sparse),this._parents)}function selection_join(e,t,n){var r=this.enter(),i=this,o=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function selection_merge(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,o=r.length,a=Math.min(i,o),l=new Array(i),u=0;u<a;++u)for(var s=n[u],c=r[u],d=s.length,f=l[u]=new Array(d),m,g=0;g<d;++g)(m=s[g]||c[g])&&(f[g]=m);for(;u<i;++u)l[u]=n[u];return new Selection(l,this._parents)}function selection_order(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function selection_sort(e){e||(e=ascending);function t(d,f){return d&&f?e(d.__data__,f.__data__):!d-!f}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],l=a.length,u=i[o]=new Array(l),s,c=0;c<l;++c)(s=a[c])&&(u[c]=s);u.sort(t)}return new Selection(i,this._parents).order()}function ascending(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function selection_call(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function selection_size(){let e=0;for(const t of this)++e;return e}function selection_empty(){return!this.node()}function selection_each(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],o=0,a=i.length,l;o<a;++o)(l=i[o])&&e.call(l,l.__data__,o,i);return this}function attrRemove(e){return function(){this.removeAttribute(e)}}function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function attrConstant(e,t){return function(){this.setAttribute(e,t)}}function attrConstantNS(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function attrFunction(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function attrFunctionNS(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function selection_attr(e,t){var n=namespace(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?attrRemoveNS:attrRemove:typeof t=="function"?n.local?attrFunctionNS:attrFunction:n.local?attrConstantNS:attrConstant)(n,t))}function defaultView(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function styleRemove(e){return function(){this.style.removeProperty(e)}}function styleConstant(e,t,n){return function(){this.style.setProperty(e,t,n)}}function styleFunction(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function selection_style(e,t,n){return arguments.length>1?this.each((t==null?styleRemove:typeof t=="function"?styleFunction:styleConstant)(e,t,n==null?"":n)):styleValue(this.node(),e)}function styleValue(e,t){return e.style.getPropertyValue(t)||defaultView(e).getComputedStyle(e,null).getPropertyValue(t)}function propertyRemove(e){return function(){delete this[e]}}function propertyConstant(e,t){return function(){this[e]=t}}function propertyFunction(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function selection_property(e,t){return arguments.length>1?this.each((t==null?propertyRemove:typeof t=="function"?propertyFunction:propertyConstant)(e,t)):this.node()[e]}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList(e)}function ClassList(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}ClassList.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function classedAdd(e,t){for(var n=classList(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function classedRemove(e,t){for(var n=classList(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function classedTrue(e){return function(){classedAdd(this,e)}}function classedFalse(e){return function(){classedRemove(this,e)}}function classedFunction(e,t){return function(){(t.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}function selection_classed(e,t){var n=classArray(e+"");if(arguments.length<2){for(var r=classList(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?classedFunction:t?classedTrue:classedFalse)(n,t))}function textRemove(){this.textContent=""}function textConstant(e){return function(){this.textContent=e}}function textFunction(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function selection_text(e){return arguments.length?this.each(e==null?textRemove:(typeof e=="function"?textFunction:textConstant)(e)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(e){return function(){this.innerHTML=e}}function htmlFunction(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function selection_html(e){return arguments.length?this.each(e==null?htmlRemove:(typeof e=="function"?htmlFunction:htmlConstant)(e)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(e){var t=typeof e=="function"?e:creator(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function constantNull(){return null}function selection_insert(e,t){var n=typeof e=="function"?e:creator(e),r=t==null?constantNull:typeof t=="function"?t:selector(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function remove(){var e=this.parentNode;e&&e.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function selection_cloneDeep(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function selection_clone(e){return this.select(e?selection_cloneDeep:selection_cloneShallow)}function selection_datum(e){return arguments.length?this.property("__data__",e):this.node().__data__}function contextListener(e){return function(t){e.call(this,t,this.__data__)}}function parseTypenames(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function onRemove(e){return function(){var t=this.__on;if(!!t){for(var n=0,r=-1,i=t.length,o;n<i;++n)o=t[n],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):t[++r]=o;++r?t.length=r:delete this.__on}}}function onAdd(e,t,n){return function(){var r=this.__on,i,o=contextListener(t);if(r){for(var a=0,l=r.length;a<l;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=t;return}}this.addEventListener(e.type,o,n),i={type:e.type,name:e.name,value:t,listener:o,options:n},r?r.push(i):this.__on=[i]}}function selection_on(e,t,n){var r=parseTypenames(e+""),i,o=r.length,a;if(arguments.length<2){var l=this.node().__on;if(l){for(var u=0,s=l.length,c;u<s;++u)for(i=0,c=l[u];i<o;++i)if((a=r[i]).type===c.type&&a.name===c.name)return c.value}return}for(l=t?onAdd:onRemove,i=0;i<o;++i)this.each(l(r[i],t,n));return this}function dispatchEvent(e,t,n){var r=defaultView(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function dispatchConstant(e,t){return function(){return dispatchEvent(this,e,t)}}function dispatchFunction(e,t){return function(){return dispatchEvent(this,e,t.apply(this,arguments))}}function selection_dispatch(e,t){return this.each((typeof t=="function"?dispatchFunction:dispatchConstant)(e,t))}function*selection_iterator(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var root=[null];function Selection(e,t){this._groups=e,this._parents=t}function selection_selection(){return this}Selection.prototype={constructor:Selection,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select(e){return typeof e=="string"?new Selection([[document.querySelector(e)]],[document.documentElement]):new Selection([[e]],root)}function sourceEvent(e){let t;for(;t=e.sourceEvent;)e=t;return e}function pointer(e,t){if(e=sourceEvent(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}function identity(e){return e}var top=1,right=2,bottom=3,left=4,epsilon=1e-6;function translateX(e){return"translate("+e+",0)"}function translateY(e){return"translate(0,"+e+")"}function number(e){return t=>+e(t)}function center(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function entering(){return!this.__axis}function axis(e,t){var n=[],r=null,i=null,o=6,a=6,l=3,u=typeof window!="undefined"&&window.devicePixelRatio>1?0:.5,s=e===top||e===left?-1:1,c=e===left||e===right?"x":"y",d=e===top||e===bottom?translateX:translateY;function f(m){var g=r==null?t.ticks?t.ticks.apply(t,n):t.domain():r,b=i==null?t.tickFormat?t.tickFormat.apply(t,n):identity:i,v=Math.max(o,0)+l,_=t.range(),$=+_[0]+u,k=+_[_.length-1]+u,S=(t.bandwidth?center:number)(t.copy(),u),C=m.selection?m.selection():m,B=C.selectAll(".domain").data([null]),T=C.selectAll(".tick").data(g,t).order(),D=T.exit(),j=T.enter().append("g").attr("class","tick"),U=T.select("line"),V=T.select("text");B=B.merge(B.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),T=T.merge(j),U=U.merge(j.append("line").attr("stroke","currentColor").attr(c+"2",s*o)),V=V.merge(j.append("text").attr("fill","currentColor").attr(c,s*v).attr("dy",e===top?"0em":e===bottom?"0.71em":"0.32em")),m!==C&&(B=B.transition(m),T=T.transition(m),U=U.transition(m),V=V.transition(m),D=D.transition(m).attr("opacity",epsilon).attr("transform",function(R){return isFinite(R=S(R))?d(R+u):this.getAttribute("transform")}),j.attr("opacity",epsilon).attr("transform",function(R){var P=this.parentNode.__axis;return d((P&&isFinite(P=P(R))?P:S(R))+u)})),D.remove(),B.attr("d",e===left||e===right?a?"M"+s*a+","+$+"H"+u+"V"+k+"H"+s*a:"M"+u+","+$+"V"+k:a?"M"+$+","+s*a+"V"+u+"H"+k+"V"+s*a:"M"+$+","+u+"H"+k),T.attr("opacity",1).attr("transform",function(R){return d(S(R)+u)}),U.attr(c+"2",s*o),V.attr(c,s*v).text(b),C.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===right?"start":e===left?"end":"middle"),C.each(function(){this.__axis=S})}return f.scale=function(m){return arguments.length?(t=m,f):t},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(m){return arguments.length?(n=m==null?[]:Array.from(m),f):n.slice()},f.tickValues=function(m){return arguments.length?(r=m==null?null:Array.from(m),f):r&&r.slice()},f.tickFormat=function(m){return arguments.length?(i=m,f):i},f.tickSize=function(m){return arguments.length?(o=a=+m,f):o},f.tickSizeInner=function(m){return arguments.length?(o=+m,f):o},f.tickSizeOuter=function(m){return arguments.length?(a=+m,f):a},f.tickPadding=function(m){return arguments.length?(l=+m,f):l},f.offset=function(m){return arguments.length?(u=+m,f):u},f}function axisBottom(e){return axis(bottom,e)}function axisLeft(e){return axis(left,e)}var useChart=()=>inject("chart"),usePoints=(e,t={stacked:!1,type:"line"})=>{const n=ref([]),r=useChart(),{stacked:i,type:o}=t;function a(u,s){const{primary:c,secondary:d}=r.scales;return r.config.direction==="horizontal"?s.map(m=>({x:c.mapOne(m.data[u]),y:d.mapOne(m[1]),props:{values:[...m],data:m.data}})).filter(m=>!isNaN(m.x)&&!isNaN(m.y)):r.config.direction==="vertical"?s.map(f=>({x:d.mapOne(f[1]),y:c.mapOne(f.data[u]),props:{values:[...f],data:f.data}})).filter(f=>!isNaN(f.x)&&!isNaN(f.y)):[]}function l(){const u=r.getStackedKeys(1,o),[s,c]=e,f=r.getStackedData(i?u:[e[1]]).find(m=>m.key===c);f&&(n.value=a(s,f))}return watch(r.updates,()=>{l()},{immediate:!0}),{points:n}},useMouse=()=>inject("chartMouse",{index:-1,position:{x:0,y:0},hover:!1}),useBars=(e,t={maxWidth:-1,gap:5,stacked:!1,type:"bar"})=>{const n=ref([]),r=useChart(),{stacked:i,type:o,gap:a}=t;function l(){const{primary:m,secondary:g}=r.scales,b=m.type==="band"?m:g,v=m.type==="band"?g:m;return{bandScale:b,linearScale:v}}function u(){if(i)return 0;const g=r.getLayers(o).findIndex(b=>b.dataKeys.join(",")===e.join(","));return g>-1?g:0}function s(){const{bandScale:m}=l(),g=t.maxWidth>-1?Math.min(m.bandwidth()-a,t.maxWidth):m.bandwidth()-a,b=r.getLayers(o);return b.length>0&&!i?g/b.length:g}function c(){if(i)return 0;const{bandScale:m}=l(),g=m.bandwidth()-a,b=r.getLayers(o).length*s();return(g-b)/2}function d(m,g){const{bandScale:b,linearScale:v}=l(),_=u(),$=s(),k=c();return g.map(S=>{const C={x:0,y:0,width:0,height:0,props:{values:[...S],data:S.data}},B=b.scale(S.data[m]),[T,D]=v.map(S);return r.config.direction==="horizontal"?(C.y=Math.min(T,D),C.height=Math.abs(T-D),C.x=k+B+_*$+a/2,C.width=$):r.config.direction==="vertical"&&(C.x=Math.min(T,D),C.width=Math.abs(T-D),C.y=k+B+_*$+a/2,C.height=$),C})}function f(){const m=i?r.getStackedKeys(1,o):[e[1]],[g,b]=e,_=r.getStackedData(m).find($=>$.key===b);_&&(n.value=d(g,_))}return watch(r.updates,()=>{f()}),{bars:n}},useTooltip=()=>{const e=useMouse(),t=useChart(),n=computed(()=>e.hover),r=ref({x:0,y:0}),i=ref({});return watch(e,()=>{const{primary:o}=t.scales,a=t.getKeys(0),l=t.getData(a),[u]=o.map([l[e.index]]);u&&(t.config.direction==="horizontal"?r.value={x:u,y:e.position.y}:t.config.direction==="vertical"?r.value={x:e.position.x,y:u}:r.value={x:e.position.x,y:e.position.y});const s=t.data[e.index];s&&(i.value=Object.assign(Object.assign({},s),{idx:e.index}))}),{position:r,payload:i,show:n}},useResize=e=>{const t=ref(0),n=ref(0);let r=null,i=null;function o(l,u){t.value=l,n.value=u,i&&i()}function a(l){i=l}return onMounted(()=>{r=new window.ResizeObserver(l=>{const u=l[0].contentRect.width,s=l[0].contentRect.height;o(u,s)}),r.observe(e.value)}),onUnmounted(()=>{r.disconnect()}),{width:t,height:n,onResize:a}},script$d=defineComponent({name:"Axis",props:{position:{type:String,default:"bottom"},rotate:{type:Boolean,default:!1},isPrimary:{type:Boolean,default:!1}},setup(e){const t=ref(),n=useChart(),r=computed(()=>e.position==="bottom"?axisBottom:axisLeft),i=ref(n.canvas),o={ticks:5};function a(){if(n.data.length>0){const{primary:l,secondary:u}=n.scales,s=e.isPrimary?l:u,c=Object.assign({},e.isPrimary?l.config:u.config,o),d=r.value(s.scale);c.format&&d.tickFormat(c.format),c.ticks!==void 0&&d.ticks(c.ticks),c.tickValues!==void 0&&d.tickValues(c.tickValues),c.useConfig&&c.useConfig(d);const f=select(t.value).call(d);return e.position==="bottom"&&e.rotate&&f.selectAll("text").attr("y",0).attr("x",9).attr("dy",".35em").attr("transform","rotate(90)").style("text-anchor","start"),d}return null}return watch(()=>e.isPrimary,()=>{a()}),watch(n.updates,()=>{i.value=n.canvas,a()}),{el:t,canvas:i}}});const _hoisted_1$b=["transform"],_hoisted_2$8=["transform"];function render$d(e,t,n,r,i,o){return e.position==="bottom"?(openBlock(),createElementBlock("g",{key:0,class:normalizeClass("layer-axis-x"),ref:"el",transform:`translate(0, ${e.canvas.height})`},null,8,_hoisted_1$b)):(openBlock(),createElementBlock("g",{key:1,class:normalizeClass("layer-axis-y"),ref:"el",transform:`translate(${e.canvas.x}, 0)`},null,8,_hoisted_2$8))}script$d.render=render$d;script$d.__file="src/components/Axis/index.vue";var script$c=defineComponent({name:"Chart",components:{Axis:script$d},props:{data:{type:Array,default:()=>[]},margin:{type:Object,default:()=>({top:0,right:0,bottom:0,left:0}),required:!1},size:{type:Object,default:()=>({width:500,height:400}),required:!1},direction:{type:String,default:"horizontal",required:!1},axis:{type:Object,required:!1},config:{type:Object,default:()=>({})}},setup(e){const t=ref(null),n=ref(),r=ref(),i=reactive({x:40,y:20}),o=new Chart(e.data,e.config),a=computed(()=>e.axis&&e.axis.primary&&e.axis.primary.rotate),l=computed(()=>e.axis&&e.axis.primary&&e.axis.primary.hide),u=computed(()=>e.axis&&e.axis.secondary&&e.axis.secondary.hide),s=reactive({index:-1,position:{x:0,y:0},hover:!1});provide("chart",o),provide("chartMouse",s),watch(()=>e.data,()=>{o&&o.changeData(e.data)},{immediate:!0}),watch(()=>e.config,()=>{o&&o.changeConfig(e.config)}),watch(()=>[Object.assign({},i),e.direction,e.size,e.margin,e.axis],()=>{o&&o.changeConfig({axisSpace:Object.assign({},i),direction:e.direction,size:e.size,margin:e.margin,axis:e.axis})},{immediate:!0});const c=new ResizeObserver(m=>{for(const g of m)r.value&&g.target===r.value.$el?i.y=g.contentRect.height:n.value&&g.target===n.value.$el&&(i.x=g.contentRect.width)});onMounted(()=>{r.value&&c.observe(r.value.$el),n.value&&c.observe(n.value.$el)}),onUnmounted(()=>{c.disconnect()});function d(){e.config.controlHover!==!1&&(s.index=-1,s.hover=!1)}function f(m){if(e.config.controlHover===!1)return;s.hover=!0,s.position={x:pointer(m)[0],y:pointer(m)[1]};const{primary:g}=o.scales,b=o.getKeys(0),v=o.getData(b);if(o.config.direction==="horizontal")if(g.type==="band"){const _=g.bandwidth(),$=s.position.x-o.canvas.x;s.index=Math.round(($+_/2)/_)-1}else s.index=bisectCenter(v,g.scale.invert(s.position.x));else if(o.config.direction==="vertical")if(g.type==="band"){const _=g.bandwidth(),$=s.position.y-o.canvas.y;s.index=Math.round(($+_/2)/_)-1}else s.index=bisectCenter(v,g.scale.invert(s.position.y))}return{axBottomEl:r,axLeftEl:n,chartEl:t,hideX:l,hideY:u,rotateX:a,onMouseMove:f,onMouseOut:d}}});const _hoisted_1$a={class:"chart",ref:"chartEl"},_hoisted_2$7=["width","height","viewBox"],_hoisted_3$6={class:"layers"},_hoisted_4$3={class:"axis"},_hoisted_5$3={class:"widgets"};function render$c(e,t,n,r,i,o){const a=resolveComponent("axis");return openBlock(),createElementBlock("div",_hoisted_1$a,[(openBlock(),createElementBlock("svg",{width:e.size.width,height:e.size.height,viewBox:`0 0 ${e.size.width} ${e.size.height}`,onPointermove:t[0]||(t[0]=(...l)=>e.onMouseMove&&e.onMouseMove(...l)),onPointerleave:t[1]||(t[1]=(...l)=>e.onMouseOut&&e.onMouseOut(...l))},[createBaseVNode("g",_hoisted_3$6,[renderSlot(e.$slots,"layers")]),createBaseVNode("g",_hoisted_4$3,[e.hideX?createCommentVNode("v-if",!0):(openBlock(),createBlock(a,{key:0,position:"bottom",ref:"axBottomEl",rotate:e.rotateX,isPrimary:e.direction==="horizontal"},null,8,["rotate","isPrimary"])),e.hideY?createCommentVNode("v-if",!0):(openBlock(),createBlock(a,{key:1,position:"left",ref:"axLeftEl",isPrimary:e.direction==="vertical"},null,8,["isPrimary"]))])],40,_hoisted_2$7)),createBaseVNode("div",_hoisted_5$3,[renderSlot(e.$slots,"widgets")])],512)}function styleInject(e,t){t===void 0&&(t={});var n=t.insertAt;if(!(!e||typeof document=="undefined")){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",n==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}var css_248z$1=`
.chart {
  position: relative;
}
`;styleInject(css_248z$1);script$c.render=render$c;script$c.__file="src/components/Chart/index.vue";var script$b=defineComponent({name:"Layer",props:{type:{type:String,default:"custom"},dataKeys:{type:Object,required:!0}},setup(e){const t=useChart(),n=new Date().getTime().toString(),r=inject("layerProps",{});return onMounted(()=>{t.addLayer({id:n,type:e.type,dataKeys:e.dataKeys,props:r})}),onUnmounted(()=>{t.removeLayer(n)}),{}}});function render$b(e,t,n,r,i,o){return openBlock(),createElementBlock("g",{class:normalizeClass(`layer-${e.type}`)},[renderSlot(e.$slots,"default")],2)}script$b.render=render$b;script$b.__file="src/components/Layer/index.vue";var script$a=defineComponent({name:"AreaComponent",components:{Layer:script$b},props:{areaStyle:{type:Object,required:!1},dataKeys:{type:Object,required:!0},type:{type:String,default:()=>"normal"},gap:{type:Number,default:0}},setup(e){const t=useChart(),{stacked:n}=inject("layerProps",{stacked:!1}),{points:r}=usePoints(e.dataKeys,{stacked:!1,type:"area"}),{bars:i}=useBars(e.dataKeys,{stacked:n,type:"area",gap:e.gap,maxWidth:-1}),o=ref(""),a=c=>({normal:curveLinear,natural:curveNatural,step:curveStep,monotone:t.config.direction==="horizontal"?monotoneX:monotoneY})[c],l=()=>{console.log(r.value);const{secondary:c}=t.scales;return n?area().curve(a(e.type)).x0(d=>d.x+d.width/2).y0(d=>d.y).x1(d=>d.x+d.width/2).y1(d=>d.y+d.height):t.config.direction==="vertical"?area().curve(a(e.type)).y0(d=>d.y).y1(d=>d.y).x0(d=>d.x).x1(()=>c.scale(0)):area().curve(a(e.type)).x0(d=>d.x).x1(d=>d.x).y0(d=>d.y).y1(()=>c.scale(0))},u=computed(()=>()=>Object.assign({fill:"blue",fillOpacity:.25,stroke:"none"},e.areaStyle)),s=c=>mapKeys(kebabize,c);return watch(r,()=>{o.value=n?l()(i.value):l()(r.value)}),{d:o,getStyle:u,toKebabCase:s}}});const _hoisted_1$9=["d"];function render$a(e,t,n,r,i,o){const a=resolveComponent("Layer");return openBlock(),createBlock(a,{type:"area",dataKeys:e.dataKeys},{default:withCtx(()=>[createBaseVNode("path",mergeProps(e.toKebabCase(e.getStyle()),{d:e.d}),null,16,_hoisted_1$9)]),_:1},8,["dataKeys"])}script$a.render=render$a;script$a.__file="src/components/Area/index.vue";var script$9=defineComponent({name:"LineComponent",components:{Layer:script$b},props:{lineStyle:{type:Object,required:!1},dotStyle:{type:Object,required:!1},hideDot:{type:Boolean,default:!1},dataKeys:{type:Object,required:!0},type:{type:String,default:()=>"normal"}},setup(e){const{stacked:t}=inject("layerProps",{stacked:!1}),n=useMouse(),r=useChart(),i=ref(""),{points:o}=usePoints(e.dataKeys,{stacked:t,type:"line"}),a={normal:curveLinear,natural:curveNatural,step:stepAfter,monotone:monotoneX};function l(){let f=a[e.type];e.type==="monotone"&&r.config.direction==="vertical"&&(f=monotoneY),i.value=line().x(m=>m.x).y(m=>m.y).curve(f)(o.value)}function u(f){const m=e.dotStyle,g=s.value();return Object.assign({r:f?5:3,stroke:g.stroke,strokeWidth:g.strokeWidth,fill:"white"},m)}const s=computed(()=>is$1(Function,e.lineStyle)?e.lineStyle:()=>Object.assign({stroke:"#8884d8",strokeWidth:2},e.lineStyle)),c=computed(()=>is$1(Function,e.dotStyle)?e.dotStyle:({active:f})=>u(f));return watch(o,()=>l()),watch(r.updates,()=>l()),{d:i,mouse:n,points:o,toKebabCase:f=>mapKeys(kebabize,f),getStyle:s,getDotStyle:c}}});const _hoisted_1$8=["d"],_hoisted_2$6={key:0},_hoisted_3$5=["cx","cy"];function render$9(e,t,n,r,i,o){const a=resolveComponent("Layer");return openBlock(),createBlock(a,{dataKeys:e.dataKeys,type:"line"},{default:withCtx(()=>[createBaseVNode("path",mergeProps({class:"chart-line"},e.toKebabCase(e.getStyle()),{d:e.d,fill:"none"}),null,16,_hoisted_1$8),createCommentVNode(` :stroke="stroke"
      :stroke-width="strokeWidth"
      stroke-linejoin="round"
      stroke-linecap="round" `),e.hideDot?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("g",_hoisted_2$6,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.points,(l,u)=>(openBlock(),createElementBlock("circle",mergeProps(e.toKebabCase(e.getDotStyle({active:u===e.mouse.index,index:u})),{key:u,cx:l.x,cy:l.y}),null,16,_hoisted_3$5))),128))]))]),_:1},8,["dataKeys"])}script$9.render=render$9;script$9.__file="src/components/Line/index.vue";var script$8=defineComponent({name:"Bar",components:{Layer:script$b},props:{selectedBar:{type:Object,default:()=>null},barStyle:{type:[Function,Object],default:()=>({fill:"blue"})},barStyleSelected:{type:[Function,Object],default:()=>({fill:"darkblue"})},maxWidth:{type:Number,default:-1},dataKeys:{type:Object,required:!0},gap:{type:Number,default:5}},setup(e,{emit:t}){const n=useMouse(),{stacked:r,maxWidth:i}=inject("layerProps",{stacked:!1,maxWidth:-1}),{bars:o}=useBars(e.dataKeys,{maxWidth:Math.max(e.maxWidth,i),stacked:r,gap:e.gap,type:"bar"}),a=computed(()=>is$1(Function,e.barStyle)?e.barStyle:()=>e.barStyle),l=computed(()=>is$1(Function,e.barStyleSelected)?e.barStyleSelected:()=>e.barStyleSelected),u=c=>mapKeys(kebabize,c);function s(c,d){t("barClick",Object.assign(Object.assign({},c),{idx:d}))}return{getStyle:a,getStyleSelected:l,toKebabCase:u,bars:o,mouse:n,onBarClick:s}}});const _hoisted_1$7={key:0},_hoisted_2$5=["x","y","width","height","onClick"],_hoisted_3$4=["x","y","width","height"];function render$8(e,t,n,r,i,o){const a=resolveComponent("Layer");return openBlock(),createBlock(a,{dataKeys:e.dataKeys,type:"bar"},{default:withCtx(()=>[e.bars.length===0?(openBlock(),createElementBlock("text",_hoisted_1$7,"No Data")):createCommentVNode("v-if",!0),(openBlock(!0),createElementBlock(Fragment,null,renderList(e.bars,(l,u)=>(openBlock(),createElementBlock("rect",mergeProps({class:"chart-bar"},e.toKebabCase(e.getStyle({...l.props,active:u===e.mouse.index})),{key:u,x:l.x,y:l.y,width:l.width>0?l.width:0,height:l.height>0?l.height:0,onClick:()=>e.onBarClick(l,u)}),null,16,_hoisted_2$5))),128)),e.selectedBar?(openBlock(),createElementBlock("rect",mergeProps({key:1,class:"chart-bar"},e.toKebabCase(e.getStyleSelected({...e.selectedBar.props})),{x:e.selectedBar.x,y:e.selectedBar.y,width:e.selectedBar.width>0?e.selectedBar.width:0,height:e.selectedBar.height>0?e.selectedBar.height:0}),null,16,_hoisted_3$4)):createCommentVNode("v-if",!0)]),_:1},8,["dataKeys"])}script$8.render=render$8;script$8.__file="src/components/Bar/index.vue";const PieSort=String;var script$7=defineComponent({name:"PieLayer",components:{Layer:script$b},props:{pieStyle:{type:Object,required:!1},dataKeys:{type:Object,required:!0},sort:{type:PieSort,default:"desc",required:!1},sortFunc:{type:Function,required:!1}},setup(e){var t;const n=useChart(),r=useMouse(),i=ref(Math.min(n.canvas.width-n.canvas.x,n.canvas.height-n.canvas.y)/2),o=computed(()=>()=>Object.assign({colors:["#4daf4a","#377eb8","#ff7f00","#984ea3","#e41a1c"],innerRadius:2,cornerRadius:0,padAngle:.01},e.pieStyle)),a=o.value(),l=ref([]),u=ordinal(o.value().colors),s=()=>arc().outerRadius(i.value).innerRadius(a.innerRadius).cornerRadius(a.cornerRadius).padAngle(a.padAngle),c=ref(`translate(${i.value+n.canvas.x}, ${i.value+n.canvas.y})`);let d;switch(e.sort){case"desc":d=descending$1;break;case"asc":d=ascending$1;break;case"none":d=null;break;case"custom":d=(t=e.sortFunc)!==null&&t!==void 0?t:null;break;default:d=null}function f(){const _=n.getData([e.dataKeys[1]]);l.value=pie().sort(d)(_)}function m(_){return u(_.toString())}function g(_,$){r.hover=!0,r.index=$;const[k,S]=pointer(_);r.position={x:k+i.value,y:S+i.value}}function b(){r.hover=!1,r.index=-1}function v(_){mapKeys(kebabize,_)}return watch(n.updates,()=>{i.value=Math.min(n.canvas.width-n.canvas.x,(n.canvas.height-n.canvas.y)/2),c.value=`translate(${i.value+n.canvas.x}, ${i.value+n.canvas.y})`,f()}),{arcs:l,arcGen:s,getStyle:o,transform:c,getColor:m,hideTooltip:b,toKebabCase:v,showTooltip:g}}});const _hoisted_1$6={key:0},_hoisted_2$4=["transform"],_hoisted_3$3=["id","fill","d","onMousemove"];function render$7(e,t,n,r,i,o){const a=resolveComponent("Layer");return openBlock(),createBlock(a,{dataKeys:e.dataKeys,type:"pie"},{default:withCtx(()=>[e.arcs.length===0?(openBlock(),createElementBlock("text",_hoisted_1$6,"No Data")):createCommentVNode("v-if",!0),createBaseVNode("g",{transform:e.transform},[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.arcs,(l,u)=>(openBlock(),createElementBlock("path",mergeProps({key:u,id:`arc-${u}`,class:"chart-pie"},e.toKebabCase(e.getStyle()),{fill:e.getColor(u),d:e.arcGen()(l),onMousemove:s=>e.showTooltip(s,u),onMouseleave:t[0]||(t[0]=s=>e.hideTooltip())}),null,16,_hoisted_3$3))),128))],8,_hoisted_2$4)]),_:1},8,["dataKeys"])}script$7.render=render$7;script$7.__file="src/components/Pie/index.vue";var script$6=defineComponent({name:"Responsive",setup(){const e=ref(null),{width:t,height:n}=useResize(e);return{el:e,width:t,height:n}}});const _hoisted_1$5={ref:"el"};function render$6(e,t,n,r,i,o){return openBlock(),createElementBlock("div",_hoisted_1$5,[renderSlot(e.$slots,"main",{width:e.width,height:e.height})],512)}script$6.render=render$6;script$6.__file="src/components/Responsive/index.vue";var script$5=defineComponent({name:"Grid",props:{strokeDasharray:{type:String,default:()=>"3 3"},hideX:{type:Boolean,default:!1},hideY:{type:Boolean,default:!1},center:{type:Boolean,default:!0}},setup(e){const t=useChart(),n=ref([]),r=ref(null),i=ref([]),o=ref([]);function a(){const{primary:u,secondary:s}=t.scales,c=t.config.direction==="horizontal"?s:u;if(c.type==="band"&&!e.center){const d=c.map(t.getData(t.getKeys(0))).map(f=>f+c.bandwidth()/2);d.pop(),i.value=d}else{const d=c.ticks();i.value=c.map(d)}}function l(){const{primary:u,secondary:s}=t.scales,c=t.config.direction==="horizontal"?u:s;if(c.type==="band"&&!e.center){const d=c.map(t.getData(t.getKeys(0))).map(f=>f+c.bandwidth()/2);d.pop(),o.value=d}else{const d=c.ticks();o.value=c.map(d)}}return watch(t.updates,()=>{n.value=t.data,r.value=t.canvas,a(),l()}),{data:n,canvas:r,xLines:i,yLines:o}}});const _hoisted_1$4=["stroke-dasharray"],_hoisted_2$3={key:0,class:"grid-x"},_hoisted_3$2=["x1","y1","x2","y2"],_hoisted_4$2={key:1,class:"grid-y"},_hoisted_5$2=["x1","y1","x2","y2"],_hoisted_6$2=["x1","y1","x2","y2"],_hoisted_7=["x1","y1","x2","y2"];function render$5(e,t,n,r,i,o){return e.data.length?(openBlock(),createElementBlock("g",{key:0,class:"layer-grid",stroke:"black","stroke-opacity":"0.15","stroke-width":"1","stroke-dasharray":e.strokeDasharray},[e.hideX?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("g",_hoisted_2$3,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.xLines,(a,l)=>(openBlock(),createElementBlock("line",{key:l,x1:e.canvas.x,y1:a,x2:e.canvas.width,y2:a},null,8,_hoisted_3$2))),128))])),e.hideY?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("g",_hoisted_4$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.yLines,(a,l)=>(openBlock(),createElementBlock("line",{key:l,x1:a,y1:e.canvas.y,x2:a,y2:e.canvas.height},null,8,_hoisted_5$2))),128))])),createBaseVNode("g",null,[createBaseVNode("line",{x1:e.canvas.x,y1:e.canvas.y,x2:e.canvas.width,y2:e.canvas.y},null,8,_hoisted_6$2),createBaseVNode("line",{x1:e.canvas.width-1,y1:e.canvas.y,x2:e.canvas.width-1,y2:e.canvas.height},null,8,_hoisted_7)])],8,_hoisted_1$4)):createCommentVNode("v-if",!0)}script$5.render=render$5;script$5.__file="src/components/Grid/index.vue";var script$4=defineComponent({name:"Tooltip",components:{},props:{format:{type:String,default:",.0f"},color:{type:String,default:"#7876ec"},hideLine:{type:Boolean,default:!1},config:{type:Object,default:()=>({})}},setup(e){const t=ref(null),n=useChart(),r=ref(n.canvas),i=ref(n.config.direction),{position:o,payload:a,show:l}=useTooltip(),u=computed(()=>o.value.x>=r.value.width/4*3),s=computed(()=>i.value==="vertical"?{top:o.value.y-.5+"px",left:r.value.x+"px"}:i.value==="horizontal"?{top:r.value.y+"px",left:o.value.x-.5+"px"}:{top:r.value.y+"px",left:r.value.x+"px"}),c=computed(()=>i.value==="vertical"?{top:5+"px",left:o.value.x-30+"px"}:i.value==="horizontal"?{top:o.value.y+"px",transform:`translateX(${u.value?"-100%":0})`}:{top:o.value.y+"px",left:o.value.x+"px"}),d=(m,g)=>is$1(Function,g)?g(m):is$1(Number,m)?format(g)(m):m,f=computed(()=>Object.keys(omit$1(["idx"],a.value)).map(m=>{const g=Object.assign({label:m,format:e.format,color:e.color,hide:!1},e.config[m]);return{key:m,label:g.label,value:a.value[m],valueFormatted:d(a.value[m],g.format),color:is$1(Function,g.color)?g.color(a.value):g.color,hide:g.hide}}).filter(m=>!m.hide));return watch(n.updates,()=>{i.value=n.config.direction,r.value=n.canvas}),{el:t,show:l,canvas:r,direction:i,style:s,styleContent:c,position:o,items:f,isRight:u}}});const _hoisted_1$3={key:0};function render$4(e,t,n,r,i,o){return e.show?(openBlock(),createElementBlock("div",{key:0,class:"v-tooltip",style:normalizeStyle(e.style)},[createBaseVNode("div",{class:"v-tooltip-content",style:normalizeStyle(e.styleContent),ref:"el"},[renderSlot(e.$slots,"default",{payload:e.items},()=>[createBaseVNode("div",{style:normalizeStyle({borderColor:e.color})},[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.items,(a,l)=>(openBlock(),createElementBlock("div",{key:l,style:normalizeStyle({color:a.color})},[createBaseVNode("b",null,toDisplayString(a.label),1),createTextVNode(": "+toDisplayString(a.valueFormatted),1)],4))),128))],4)])],4),e.hideLine?createCommentVNode("v-if",!0):(openBlock(),createElementBlock("div",_hoisted_1$3,[e.direction==="horizontal"?(openBlock(),createElementBlock("div",{key:0,class:"v-tooltip-line-vertical",style:normalizeStyle({height:e.canvas.height+"px"})},null,4)):(openBlock(),createElementBlock("div",{key:1,class:"v-tooltip-line-horizontal",style:normalizeStyle({width:e.canvas.width-40+"px"})},null,4))]))],4)):createCommentVNode("v-if",!0)}var css_248z=`
.v-tooltip[data-v-43da20c6] {
  position: absolute;
  pointer-events: none;
}
.v-tooltip-content[data-v-43da20c6] {
  position: absolute;
  white-space: nowrap;
  pointer-events: none;
}
.v-tooltip-content > div[data-v-43da20c6] {
  margin-left: 5px;
  margin-right: 5px;
  border: 2px solid;
  background-color: white;
  padding: 8px;
  text-align: left;
  border-radius: 4px;
  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
}
.v-tooltip-right[data-v-43da20c6] {
  transform: translateX(-100%);
  margin-left: 0;
}
.v-tooltip-line-vertical[data-v-43da20c6] {
  top: 0px;
  position: absolute;
  width: 1px;
  background-color: black;
  pointer-events: none;
  opacity: 0.3;
}
.v-tooltip-line-horizontal[data-v-43da20c6] {
  left: 0px;
  position: absolute;
  height: 1px;
  background-color: black;
  pointer-events: none;
  opacity: 0.3;
}
`;styleInject(css_248z);script$4.render=render$4;script$4.__scopeId="data-v-43da20c6";script$4.__file="src/components/Tooltip/index.vue";var script$3=defineComponent({props:{stacked:{type:Boolean,default:!1},maxWidth:{type:Number,default:-1}},setup(e){provide("layerProps",e)}});function render$3(e,t,n,r,i,o){return openBlock(),createElementBlock("div",null,[renderSlot(e.$slots,"default")])}script$3.render=render$3;script$3.__file="src/components/Group/index.vue";var script$2=defineComponent({name:"Grid",props:{value:{type:Number},label:{type:String,default:""},color:{type:String,default:"red"},strokeDasharray:{type:String,default:()=>"3"},strokeWidth:{type:Number,default:1},strokeOpacity:{type:Number,default:.5}},setup(e){const t=useChart(),n=ref(0),r=ref("horizontal"),i=ref({});return watch(t.updates,()=>{e.value!==void 0&&(n.value=t.scales.secondary.scale(e.value)),i.value=t.canvas,r.value=t.config.direction},{immediate:!0}),watch(()=>e.value,()=>{n.value=t.scales.secondary.scale(e.value)},{immediate:!0}),{y:n,canvas:i,direction:r}}});const _hoisted_1$2={key:0,class:"layer-marker"},_hoisted_2$2=["x","y","fill"],_hoisted_3$1=["x1","y1","x2","y2","stroke","stroke-opacity","stroke-width","stroke-dasharray"],_hoisted_4$1={key:1,class:"layer-marker"},_hoisted_5$1=["x","y","fill"],_hoisted_6$1=["x1","y1","x2","y2","stroke","stroke-opacity","stroke-width","stroke-dasharray"];function render$2(e,t,n,r,i,o){return e.direction==="horizontal"?(openBlock(),createElementBlock("g",_hoisted_1$2,[createBaseVNode("text",{x:e.canvas.x+5,y:e.y-5,"text-anchor":"start",fill:e.color},toDisplayString(e.label),9,_hoisted_2$2),createBaseVNode("line",{x1:e.canvas.x,y1:e.y,x2:e.canvas.width,y2:e.y,stroke:e.color,"stroke-opacity":e.strokeOpacity,"stroke-width":e.strokeWidth,"stroke-dasharray":e.strokeDasharray},null,8,_hoisted_3$1)])):(openBlock(),createElementBlock("g",_hoisted_4$1,[createBaseVNode("text",{x:e.y+10,y:e.canvas.y+5,"text-anchor":"start",fill:e.color,style:{"writing-mode":"tb"}},toDisplayString(e.label),9,_hoisted_5$1),createBaseVNode("line",{x1:e.y,y1:e.canvas.y,x2:e.y,y2:e.canvas.height,stroke:e.color,"stroke-opacity":e.strokeOpacity,"stroke-width":e.strokeWidth,"stroke-dasharray":e.strokeDasharray},null,8,_hoisted_6$1)]))}script$2.render=render$2;script$2.__file="src/components/Marker/index.vue";function count(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function node_count(){return this.eachAfter(count)}function node_each(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function node_eachBefore(e,t){for(var n=this,r=[n],i,o,a=-1;n=r.pop();)if(e.call(t,n,++a,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function node_eachAfter(e,t){for(var n=this,r=[n],i=[],o,a,l,u=-1;n=r.pop();)if(i.push(n),o=n.children)for(a=0,l=o.length;a<l;++a)r.push(o[a]);for(;n=i.pop();)e.call(t,n,++u,this);return this}function node_find(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function node_sum(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,i=r&&r.length;--i>=0;)n+=r[i].value;t.value=n})}function node_sort(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function node_path(e){for(var t=this,n=leastCommonAncestor(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var i=r.length;e!==n;)r.splice(i,0,e),e=e.parent;return r}function leastCommonAncestor(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;for(e=n.pop(),t=r.pop();e===t;)i=e,e=n.pop(),t=r.pop();return i}function node_ancestors(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function node_descendants(){return Array.from(this)}function node_leaves(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function node_links(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*node_iterator(){var e=this,t,n=[e],r,i,o;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function hierarchy(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=mapChildren)):t===void 0&&(t=objectChildren);for(var n=new Node(e),r,i=[n],o,a,l,u;r=i.pop();)if((a=t(r.data))&&(u=(a=Array.from(a)).length))for(r.children=a,l=u-1;l>=0;--l)i.push(o=a[l]=new Node(a[l])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(computeHeight)}function node_copy(){return hierarchy(this).eachBefore(copyData)}function objectChildren(e){return e.children}function mapChildren(e){return Array.isArray(e)?e[1]:null}function copyData(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function computeHeight(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Node(e){this.data=e,this.depth=this.height=0,this.parent=null}Node.prototype=hierarchy.prototype={constructor:Node,count:node_count,each:node_each,eachAfter:node_eachAfter,eachBefore:node_eachBefore,find:node_find,sum:node_sum,sort:node_sort,path:node_path,ancestors:node_ancestors,descendants:node_descendants,leaves:node_leaves,links:node_links,copy:node_copy,[Symbol.iterator]:node_iterator};function optional(e){return e==null?null:required(e)}function required(e){if(typeof e!="function")throw new Error;return e}function constantZero(){return 0}function constant(e){return function(){return e}}function roundNode(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function treemapDice(e,t,n,r,i){for(var o=e.children,a,l=-1,u=o.length,s=e.value&&(r-t)/e.value;++l<u;)a=o[l],a.y0=n,a.y1=i,a.x0=t,a.x1=t+=a.value*s}var preroot={depth:-1},ambiguous={},imputed={};function defaultId(e){return e.id}function defaultParentId(e){return e.parentId}function stratify(){var e=defaultId,t=defaultParentId,n;function r(i){var o=Array.from(i),a=e,l=t,u,s,c,d,f,m,g,b,v=new Map;if(n!=null){const _=o.map((S,C)=>normalize(n(S,C,i))),$=_.map(parentof),k=new Set(_).add("");for(const S of $)k.has(S)||(k.add(S),_.push(S),$.push(parentof(S)),o.push(imputed));a=(S,C)=>_[C],l=(S,C)=>$[C]}for(c=0,u=o.length;c<u;++c)s=o[c],m=o[c]=new Node(s),(g=a(s,c,i))!=null&&(g+="")&&(b=m.id=g,v.set(b,v.has(b)?ambiguous:m)),(g=l(s,c,i))!=null&&(g+="")&&(m.parent=g);for(c=0;c<u;++c)if(m=o[c],g=m.parent){if(f=v.get(g),!f)throw new Error("missing: "+g);if(f===ambiguous)throw new Error("ambiguous: "+g);f.children?f.children.push(m):f.children=[m],m.parent=f}else{if(d)throw new Error("multiple roots");d=m}if(!d)throw new Error("no root");if(n!=null){for(;d.data===imputed&&d.children.length===1;)d=d.children[0],--u;for(let _=o.length-1;_>=0&&(m=o[_],m.data===imputed);--_)m.data=null}if(d.parent=preroot,d.eachBefore(function(_){_.depth=_.parent.depth+1,--u}).eachBefore(computeHeight),d.parent=null,u>0)throw new Error("cycle");return d}return r.id=function(i){return arguments.length?(e=optional(i),r):e},r.parentId=function(i){return arguments.length?(t=optional(i),r):t},r.path=function(i){return arguments.length?(n=optional(i),r):n},r}function normalize(e){e=`${e}`;let t=e.length;return slash(e,t-1)&&!slash(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function parentof(e){let t=e.length;if(t<2)return"";for(;--t>1&&!slash(e,t););return e.slice(0,t)}function slash(e,t){if(e[t]==="/"){let n=0;for(;t>0&&e[--t]==="\\";)++n;if((n&1)===0)return!0}return!1}function treemapSlice(e,t,n,r,i){for(var o=e.children,a,l=-1,u=o.length,s=e.value&&(i-n)/e.value;++l<u;)a=o[l],a.x0=t,a.x1=r,a.y0=n,a.y1=n+=a.value*s}var phi=(1+Math.sqrt(5))/2;function squarifyRatio(e,t,n,r,i,o){for(var a=[],l=t.children,u,s,c=0,d=0,f=l.length,m,g,b=t.value,v,_,$,k,S,C,B;c<f;){m=i-n,g=o-r;do v=l[d++].value;while(!v&&d<f);for(_=$=v,C=Math.max(g/m,m/g)/(b*e),B=v*v*C,S=Math.max($/B,B/_);d<f;++d){if(v+=s=l[d].value,s<_&&(_=s),s>$&&($=s),B=v*v*C,k=Math.max($/B,B/_),k>S){v-=s;break}S=k}a.push(u={value:v,dice:m<g,children:l.slice(c,d)}),u.dice?treemapDice(u,n,r,i,b?r+=g*v/b:o):treemapSlice(u,n,r,b?n+=m*v/b:i,o),b-=v,c=d}return a}var squarify=function e(t){function n(r,i,o,a,l){squarifyRatio(t,r,i,o,a,l)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(phi);function treemap(){var e=squarify,t=!1,n=1,r=1,i=[0],o=constantZero,a=constantZero,l=constantZero,u=constantZero,s=constantZero;function c(f){return f.x0=f.y0=0,f.x1=n,f.y1=r,f.eachBefore(d),i=[0],t&&f.eachBefore(roundNode),f}function d(f){var m=i[f.depth],g=f.x0+m,b=f.y0+m,v=f.x1-m,_=f.y1-m;v<g&&(g=v=(g+v)/2),_<b&&(b=_=(b+_)/2),f.x0=g,f.y0=b,f.x1=v,f.y1=_,f.children&&(m=i[f.depth+1]=o(f)/2,g+=s(f)-m,b+=a(f)-m,v-=l(f)-m,_-=u(f)-m,v<g&&(g=v=(g+v)/2),_<b&&(b=_=(b+_)/2),e(f,g,b,v,_))}return c.round=function(f){return arguments.length?(t=!!f,c):t},c.size=function(f){return arguments.length?(n=+f[0],r=+f[1],c):[n,r]},c.tile=function(f){return arguments.length?(e=required(f),c):e},c.padding=function(f){return arguments.length?c.paddingInner(f).paddingOuter(f):c.paddingInner()},c.paddingInner=function(f){return arguments.length?(o=typeof f=="function"?f:constant(+f),c):o},c.paddingOuter=function(f){return arguments.length?c.paddingTop(f).paddingRight(f).paddingBottom(f).paddingLeft(f):c.paddingTop()},c.paddingTop=function(f){return arguments.length?(a=typeof f=="function"?f:constant(+f),c):a},c.paddingRight=function(f){return arguments.length?(l=typeof f=="function"?f:constant(+f),c):l},c.paddingBottom=function(f){return arguments.length?(u=typeof f=="function"?f:constant(+f),c):u},c.paddingLeft=function(f){return arguments.length?(s=typeof f=="function"?f:constant(+f),c):s},c}var script$1=defineComponent({name:"Treemap",props:{size:{type:Object,default:()=>({width:500,height:400}),required:!1},margin:{type:Object,default:()=>({top:0,right:0,bottom:0,left:0})},padding:{type:Number,default:8},data:{type:Array,default:()=>[]},dataKeys:{type:Object,required:!0},colorFn:{type:Function,default:()=>interpolateHcl("#60c96e","#6b46c1")},rcStyle:{type:Function,required:!1}},setup(e){const t=ref(null),n=ref(e.data),r=ref(null),i=ref({x:e.margin.left,y:e.margin.top,width:e.size.width-e.margin.right,height:e.size.height-e.margin.bottom}),o=ref([]);function a(){const m=extent(n.value.map(v=>v[e.dataKeys[1]])),g=linear().domain(m).range([0,100]).nice(),b=sequential().domain(m).interpolator(e.colorFn());return{x:g,y:b}}function l(){const{y:m}=a();return u(n.value).leaves().map((b,v)=>({idx:v,x0:i.value.x+b.x0,x1:i.value.x+b.x1,y0:i.value.y+b.y0,y1:i.value.y+b.y1,width:b.x1-b.x0,height:b.y1-b.y0,data:b.data,color:m(b.value)}))}function u(m){const{x:g}=a(),b=treemap().size([i.value.width-i.value.x,i.value.height-i.value.y]).padding(e.padding),_=stratify().id($=>$.name).parentId($=>$.parent)([{name:"root"}].concat(m.map($=>({name:$[e.dataKeys[0]],value:$[e.dataKeys[1]],parent:"root"}))));return _.sum($=>g($.value)),b(_),_}const s=m=>mapKeys(kebabize,m),c=m=>{const g={stroke:m.color,strokeWidth:5,fill:m.color,fillOpacity:.9};return e.rcStyle&&typeof e.rcStyle=="function"?Object.assign(Object.assign({},g),e.rcStyle(m)):g};function d(m){r.value=m}function f(){r.value=null}return watch(e,()=>{n.value=e.data,i.value={x:e.margin.left,y:e.margin.top,width:e.size.width-e.margin.right,height:e.size.height-e.margin.bottom},o.value=l()},{immediate:!0}),{el:t,rectangles:o,selected:r,getStyle:c,toKebabCase:s,onMouseOver:d,onMouseOut:f}}});const _hoisted_1$1$1={class:"treemap",style:{display:"flex",position:"relative"}},_hoisted_2$1=["width","height","viewBox"],_hoisted_3={class:"layer-rectangles"},_hoisted_4=["transform","onMouseover"],_hoisted_5=["width","height"],_hoisted_6={x:0+10,y:0+20,"font-size":"15px",fill:"white","font-weight":"bold"};function render$1(e,t,n,r,i,o){return openBlock(),createElementBlock("div",_hoisted_1$1$1,[(openBlock(),createElementBlock("svg",{width:e.size.width,height:e.size.height,viewBox:`0 0 ${e.size.width} ${e.size.height}`,ref:"el"},[createBaseVNode("g",_hoisted_3,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.rectangles,(a,l)=>(openBlock(),createElementBlock("g",{class:normalizeClass(["rectangle",{selected:e.selected===l}]),key:l,transform:`translate(${a.x0}, ${a.y0})`,onMouseover:()=>e.onMouseOver(l),onMouseleave:t[0]||(t[0]=(...u)=>e.onMouseOut&&e.onMouseOut(...u))},[renderSlot(e.$slots,"default",{r:a,selected:e.selected===l},()=>[createBaseVNode("rect",mergeProps(e.toKebabCase(e.getStyle(a)),{x:0,y:0,width:a.width,height:a.height}),null,16,_hoisted_5),renderSlot(e.$slots,"text",{r:a,selected:e.selected===l},()=>[createBaseVNode("text",_hoisted_6,toDisplayString(a.data.name),1)])])],42,_hoisted_4))),128))])],8,_hoisted_2$1)),renderSlot(e.$slots,"widgets")])}script$1.render=render$1;script$1.__file="src/components/Treemap/index.vue";var script=defineComponent({name:"HoverBar",props:{barStyle:{type:Object,default:()=>({"fill-opacity":.05})}},setup(){const e=useChart(),t=useMouse(),n=ref({x:0,y:0,width:0,height:0}),r=ref("horizontal"),i=ref({x:0,y:0,width:0,height:0});return watch(e.updates,()=>{i.value=e.canvas,r.value=e.config.direction},{immediate:!0}),watch(t,()=>{if(e.bandScale){const o=e.getData(e.getKeys(0)),[a]=e.bandScale.map([o[t.index]]),l=e.bandScale.bandwidth();a&&(e.config.direction==="horizontal"?n.value={x:a-l/2,y:0,width:l,height:i.value.height}:n.value={x:40,y:a-l/2,width:i.value.width-40,height:l})}}),{bar:n,canvas:i,direction:r,mouse:t}}});const _hoisted_1$c={key:0,class:"layer-hover-bar"},_hoisted_2$9=["x","y","width","height"];function render(e,t,n,r,i,o){return e.mouse.hover?(openBlock(),createElementBlock("g",_hoisted_1$c,[createBaseVNode("rect",mergeProps({class:"hover-bar"},e.barStyle,{x:e.bar.x,y:e.bar.y,width:e.bar.width>0?e.bar.width:0,height:e.bar.height>0?e.bar.height:0}),null,16,_hoisted_2$9)])):createCommentVNode("v-if",!0)}script.render=render;script.__file="src/components/HoverBar/index.vue";const _sfc_main$2={name:"LabelsLayer",props:{dataKeys:{type:Object,required:!0},reversed:{type:Boolean,default:!1}},setup(e){const{points:t}=usePoints(e.dataKeys);return{points:t}}},_hoisted_1$1={class:"layer-labels"},_hoisted_2=["x","y"];function _sfc_render$2(e,t,n,r,i,o){return openBlock(),createElementBlock("g",_hoisted_1$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.points,(a,l)=>(openBlock(),createElementBlock("text",{key:l,x:a.x,y:a.y-10,"text-anchor":"middle","font-size":"12",fill:"#8884d8"},toDisplayString(a.props.data[n.dataKeys[1]]*(n.reversed?-1:1)),9,_hoisted_2))),128))])}var LabelsLayer=_export_sfc(_sfc_main$2,[["render",_sfc_render$2]]),PerformancesGraph_vue_vue_type_style_index_0_scoped_true_lang="";const _sfc_main$1={name:"PerformancesGraph",components:{Responsive:script$6,Chart:script$c,Grid:script$5,LineComp:script$9,LabelsLayer,Tooltip:script$4},props:{workoutId:{type:String,required:!0},exerciseId:{type:String,required:!0},reversed:{type:Boolean,default:!1}},data(){return{data:[],axis:{secondary:{domain:["dataMin","dataMax + 2"],type:"linear"}},margin:{top:50,right:20,bottom:50,left:20},showChart:!1}},created(){this.loadPerformances(),this.reversed&&(this.axis.secondary.domain=["dataMin -2","0"],this.axis.secondary.format=e=>e*-1)},methods:{loadPerformances(){this.showChart=!1;let e=getPerformances(this.workoutId,this.exerciseId);e=e.sort((t,n)=>new Date(t.date)-new Date(n.date)),this.data=[],e.forEach(t=>{const n=getPerformanceAverage(this.workoutId,this.exerciseId,t.id);this.data.push({date:formatting().dateToDisplay(t.date),value:n*(this.reversed?-1:1),comment:t.comment})}),this.showChart=this.data.length>0}}},_hoisted_1={class:"chart-container"};function _sfc_render$1(e,t,n,r,i,o){const a=resolveComponent("Grid"),l=resolveComponent("LineComp"),u=resolveComponent("LabelsLayer"),s=resolveComponent("Tooltip"),c=resolveComponent("Chart"),d=resolveComponent("Responsive");return i.showChart?(openBlock(),createBlock(d,{key:0},{main:withCtx(({width:f})=>[createBaseVNode("div",_hoisted_1,[createVNode(c,{data:i.data,direction:"horizontal",size:{width:f,height:420},axis:i.axis,class:"flex",margin:i.margin},{layers:withCtx(()=>[createVNode(a,{strokeDasharray:"2,2"}),createVNode(l,{dataKeys:["date","value"],type:"step"}),createVNode(u,{dataKeys:["date","value"],reversed:n.reversed},null,8,["reversed"])]),widgets:withCtx(()=>[createVNode(s,{config:{value:{hide:!0,label:"poids/temps"},date:{label:"date"},comment:{label:"commentaire"}},canvas:{width:100}})]),_:2},1032,["data","size","axis","margin"])])]),_:1})):createCommentVNode("",!0)}var PerformancesGraph=_export_sfc(_sfc_main$1,[["render",_sfc_render$1],["__scopeId","data-v-a2a8f552"]]);const _sfc_main={name:"PerformancesPage",components:{AddPerfExercise,PerformanceList,PerformancesGraph},data(){return{workout:null,exercise:null}},created(){this.loadWorkout(),this.loadExercise()},methods:{loadWorkout(){this.workout=getWorkout(this.$route.params.workoutId),this.workout||(errorNotify("Impossible de charger l'entra\xEEnement"),this.$router.push({name:"workouts"}))},loadExercise(){this.exercise=getExercise(this.$route.params.workoutId,this.$route.params.exerciseId),this.exercise||(errorNotify("Impossible de charger l'exercice"),this.$router.push({name:"exercises",params:{workoutId:this.$route.params.workoutId}}))},reloadPerformances(){this.$refs.performanceList.loadPerformances(),this.$refs.performanceGraph.loadPerformances()}}};function _sfc_render(e,t,n,r,i,o){const a=resolveComponent("AddPerfExercise"),l=resolveComponent("PerformanceList"),u=resolveComponent("PerformancesGraph");return openBlock(),createElementBlock(Fragment,null,[createVNode(a,{class:"q-mb-lg",workout:i.workout,exercise:i.exercise,onReloadPerformances:o.reloadPerformances},null,8,["workout","exercise","onReloadPerformances"]),createVNode(l,{workout:i.workout,exercise:i.exercise,onReloadPerformances:o.reloadPerformances,ref:"performanceList"},null,8,["workout","exercise","onReloadPerformances"]),createVNode(u,{workoutId:i.workout.id,exerciseId:i.exercise.id,ref:"performanceGraph",reversed:i.exercise.isReverse},null,8,["workoutId","exerciseId","reversed"])],64)}var PerformancesPage=_export_sfc(_sfc_main,[["render",_sfc_render]]);export{PerformancesPage as default};
